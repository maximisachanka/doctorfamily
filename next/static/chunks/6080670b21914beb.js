(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,12519,76971,1370,e=>{"use strict";var t=e.i(43476),s=e.i(46932),a=e.i(84614),r=e.i(87316),l=e.i(78583),i=e.i(75254);let n=(0,i.default)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),c=(0,i.default)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);var o=e.i(43432),d=e.i(63488),m=e.i(3116),x=e.i(69638),h=e.i(73884),u=e.i(26299),g=e.i(9861),p=e.i(9331),f=e.i(55048),j=e.i(71645),v=e.i(17255),y=e.i(18566);function b(){let{data:e,status:i}=(0,v.useSession)(),b=(0,y.useRouter)(),[w,N]=(0,j.useState)(null),[C,S]=(0,j.useState)(!0),[A,E]=(0,j.useState)(!1);(0,j.useEffect)(()=>{"unauthenticated"===i?b.push("/"):"authenticated"===i&&e&&k()},[i,e,b]);let k=async()=>{try{let e=await fetch("/api/auth/me");if(e.ok){let t=await e.json();N(t.user)}}catch(e){}finally{S(!1)}},P=async()=>{E(!1),await (0,v.signOut)({callbackUrl:"/",redirect:!0})};return C||!w?(0,t.jsx)("div",{className:"container mx-auto px-4 py-8 lg:py-12 max-w-7xl",children:(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#18A36C] mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Загрузка данных..."})]})})}):(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8 lg:py-12 max-w-7xl",children:[(0,t.jsxs)(s.motion.div,{className:"bg-[#18A36C] rounded-lg p-8 lg:p-12 mb-10 lg:mb-12 text-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[(0,t.jsx)("div",{className:"w-20 h-20 bg-white/20 rounded-lg flex items-center justify-center mx-auto mb-6",children:(0,t.jsx)(a.User,{className:"w-10 h-10 text-white"})}),(0,t.jsx)("h1",{className:"text-3xl lg:text-4xl text-white mb-4",children:"Личный кабинет"}),(0,t.jsx)("p",{className:"text-white/90 leading-relaxed text-base lg:text-lg max-w-3xl mx-auto",children:"Управляйте своими записями, просматривайте документы и историю посещений"})]}),(0,t.jsxs)(g.Tabs,{defaultValue:"profile",className:"space-y-8",children:[(0,t.jsxs)(g.TabsList,{className:"grid w-full grid-cols-2 lg:grid-cols-4 h-auto p-2 bg-white rounded-lg gap-2",children:[(0,t.jsxs)(g.TabsTrigger,{value:"profile",className:"data-[state=active]:bg-[#18A36C] data-[state=active]:text-white data-[state=active]:border-[#18A36C] data-[state=inactive]:text-[#2E2E2E] data-[state=inactive]:hover:text-[#18A36C] data-[state=inactive]:hover:bg-[#18A36C]/5 data-[state=inactive]:hover:border-[#18A36C] data-[state=inactive]:border-2 data-[state=inactive]:border-gray-300 transition-all duration-300 rounded-lg py-3 px-4",children:["Профиль",(0,t.jsx)(a.User,{className:"w-5 h-5 ml-[2.5px]"})]}),(0,t.jsxs)(g.TabsTrigger,{value:"appointments",className:"data-[state=active]:bg-[#18A36C] data-[state=active]:text-white data-[state=active]:border-[#18A36C] data-[state=inactive]:text-[#2E2E2E] data-[state=inactive]:hover:text-[#18A36C] data-[state=inactive]:hover:bg-[#18A36C]/5 data-[state=inactive]:hover:border-[#18A36C] data-[state=inactive]:border-2 data-[state=inactive]:border-gray-300 transition-all duration-300 rounded-lg py-3 px-4",children:["Записи",(0,t.jsx)(r.Calendar,{className:"w-5 h-5 ml-[2.5px]"})]}),(0,t.jsxs)(g.TabsTrigger,{value:"documents",className:"data-[state=active]:bg-[#18A36C] data-[state=active]:text-white data-[state=active]:border-[#18A36C] data-[state=inactive]:text-[#2E2E2E] data-[state=inactive]:hover:text-[#18A36C] data-[state=inactive]:hover:bg-[#18A36C]/5 data-[state=inactive]:hover:border-[#18A36C] data-[state=inactive]:border-2 data-[state=inactive]:border-gray-300 transition-all duration-300 rounded-lg py-3 px-4",children:["Документы",(0,t.jsx)(l.FileText,{className:"w-5 h-5 ml-[2.5px]"})]}),(0,t.jsxs)(g.TabsTrigger,{value:"settings",className:"data-[state=active]:bg-[#18A36C] data-[state=active]:text-white data-[state=active]:border-[#18A36C] data-[state=inactive]:text-[#2E2E2E] data-[state=inactive]:hover:text-[#18A36C] data-[state=inactive]:hover:bg-[#18A36C]/5 data-[state=inactive]:hover:border-[#18A36C] data-[state=inactive]:border-2 data-[state=inactive]:border-gray-300 transition-all duration-300 rounded-lg py-3 px-4",children:["Настройки",(0,t.jsx)(n,{className:"w-5 h-5 ml-[2.5px]"})]})]}),(0,t.jsx)(g.TabsContent,{value:"profile",className:"space-y-8",children:(0,t.jsx)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:(0,t.jsxs)(p.Card,{className:"border border-gray-200 rounded-lg",children:[(0,t.jsxs)(p.CardHeader,{children:[(0,t.jsxs)(p.CardTitle,{className:"flex items-center gap-3 text-[#2E2E2E] text-2xl",children:[(0,t.jsx)(a.User,{className:"w-6 h-6 text-[#18A36C]"}),"Личная информация"]}),(0,t.jsx)(p.CardDescription,{className:"text-gray-600 text-base",children:"Ваши персональные данные"})]}),(0,t.jsxs)(p.CardContent,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,t.jsx)(a.User,{className:"w-4 h-4 text-[#18A36C]"}),(0,t.jsx)("span",{className:"text-sm",children:"ФИО"})]}),(0,t.jsx)("p",{className:"text-[#2E2E2E] text-lg",children:w.name||"Не указано"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,t.jsx)(r.Calendar,{className:"w-4 h-4 text-[#18A36C]"}),(0,t.jsx)("span",{className:"text-sm",children:"Дата регистрации"})]}),(0,t.jsx)("p",{className:"text-[#2E2E2E] text-lg",children:w.registration_date?new Date(w.registration_date).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric"}):"Не указано"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,t.jsx)(o.Phone,{className:"w-4 h-4 text-[#18A36C]"}),(0,t.jsx)("span",{className:"text-sm",children:"Телефон"})]}),(0,t.jsx)("p",{className:"text-[#2E2E2E] text-lg",children:w.phone||"Не указано"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,t.jsx)(d.Mail,{className:"w-4 h-4 text-[#18A36C]"}),(0,t.jsx)("span",{className:"text-sm",children:"Email"})]}),(0,t.jsx)("p",{className:"text-[#2E2E2E] text-lg",children:w.email||"Не указано"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,t.jsx)(a.User,{className:"w-4 h-4 text-[#18A36C]"}),(0,t.jsx)("span",{className:"text-sm",children:"Логин"})]}),(0,t.jsx)("p",{className:"text-[#2E2E2E] text-lg",children:w.login||"Не указано"})]})]}),(0,t.jsx)(u.Button,{className:"bg-[#18A36C] hover:bg-[#18A36C]/90 text-white cursor-pointer",children:"Редактировать профиль"})]})]})})}),(0,t.jsx)(g.TabsContent,{value:"appointments",className:"space-y-8",children:(0,t.jsxs)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"space-y-6",children:[[{id:1,doctor:"Петрова Анна Сергеевна",specialty:"Терапевт",date:"2025-11-05",time:"10:00",status:"confirmed"},{id:2,doctor:"Сидоров Петр Иванович",specialty:"Кардиолог",date:"2025-10-25",time:"14:30",status:"completed"}].map(e=>(0,t.jsx)(p.Card,{className:"border border-gray-200 rounded-lg",children:(0,t.jsx)(p.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h3",{className:"text-xl text-[#2E2E2E] font-medium",children:e.doctor}),(0,t.jsx)("p",{className:"text-gray-600",children:e.specialty}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(r.Calendar,{className:"w-4 h-4 text-[#18A36C]"}),(0,t.jsx)("span",{children:e.date})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(m.Clock,{className:"w-4 h-4 text-[#18A36C]"}),(0,t.jsx)("span",{children:e.time})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:["confirmed"===e.status?(0,t.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-green-50 text-green-700 rounded-lg",children:[(0,t.jsx)(x.CheckCircle,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Подтверждено"})]}):(0,t.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-50 text-gray-700 rounded-lg",children:[(0,t.jsx)(x.CheckCircle,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Завершено"})]}),"confirmed"===e.status&&(0,t.jsxs)(u.Button,{variant:"outline",className:"border-red-500 text-red-500 hover:bg-red-500 hover:text-white cursor-pointer",children:[(0,t.jsx)(h.XCircle,{className:"w-4 h-4 mr-2"}),"Отменить"]})]})]})})},e.id)),(0,t.jsx)(u.Button,{onClick:()=>b.push("/contacts"),className:"w-full bg-[#18A36C] hover:bg-[#18A36C]/90 text-white cursor-pointer",children:"Связаться с нами"})]})}),(0,t.jsx)(g.TabsContent,{value:"documents",className:"space-y-8",children:(0,t.jsx)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"space-y-6",children:[{id:1,name:"Результаты анализа крови",date:"2025-10-20",type:"Анализ"},{id:2,name:"Заключение терапевта",date:"2025-10-15",type:"Заключение"}].map(e=>(0,t.jsx)(p.Card,{className:"border border-gray-200 rounded-lg",children:(0,t.jsx)(p.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-[#18A36C]/10 rounded-lg flex items-center justify-center",children:(0,t.jsx)(l.FileText,{className:"w-6 h-6 text-[#18A36C]"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg text-[#2E2E2E] font-medium",children:e.name}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[e.type," • ",e.date]})]})]}),(0,t.jsx)(u.Button,{variant:"outline",className:"border-[#18A36C] text-[#18A36C] cursor-pointer",children:"Скачать"})]})})},e.id))})}),(0,t.jsx)(g.TabsContent,{value:"settings",className:"space-y-8",children:(0,t.jsx)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:(0,t.jsxs)(p.Card,{className:"border border-gray-200 rounded-lg",children:[(0,t.jsx)(p.CardHeader,{children:(0,t.jsxs)(p.CardTitle,{className:"flex items-center gap-3 text-[#2E2E2E] text-2xl",children:[(0,t.jsx)(n,{className:"w-6 h-6 text-[#18A36C]"}),"Настройки аккаунта"]})}),(0,t.jsx)(p.CardContent,{className:"space-y-6",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(u.Button,{variant:"outline",className:"w-full justify-start border-gray-300 text-[#2E2E2E] hover:border-[#18A36C] hover:text-[#18A36C] cursor-pointer",children:"Изменить пароль"}),(0,t.jsx)(u.Button,{variant:"outline",className:"w-full justify-start border-gray-300 text-[#2E2E2E] hover:border-[#18A36C] hover:text-[#18A36C] cursor-pointer",children:"Настройки уведомлений"}),(0,t.jsxs)(u.Button,{onClick:()=>{E(!0)},variant:"outline",className:"w-full justify-start border-red-300 text-red-600 hover:bg-red-50 hover:border-red-500 cursor-pointer",children:[(0,t.jsx)(c,{className:"w-4 h-4 mr-2"}),"Выйти из аккаунта"]})]})})]})})})]}),(0,t.jsx)(f.Dialog,{open:A,onOpenChange:E,children:(0,t.jsxs)(f.DialogContent,{className:"sm:max-w-md border-0",children:[(0,t.jsxs)(f.DialogHeader,{children:[(0,t.jsx)(f.DialogTitle,{className:"text-xl text-[#2E2E2E]",children:"Подтверждение выхода"}),(0,t.jsxs)(f.DialogDescription,{className:"text-gray-600 pt-2",children:["Вы уверены, что хотите выйти из аккаунта?",(0,t.jsx)("br",{}),"Вам потребуется войти снова для доступа к личному кабинету."]})]}),(0,t.jsxs)(f.DialogFooter,{className:"flex flex-col sm:flex-row gap-3 sm:gap-2 pt-4",children:[(0,t.jsx)(u.Button,{variant:"outline",onClick:()=>E(!1),className:"w-full sm:w-auto border-gray-300 text-[#2E2E2E] hover:bg-gray-50",children:"Отмена"}),(0,t.jsxs)(u.Button,{onClick:P,className:"w-full sm:w-auto bg-red-600 hover:bg-red-700 text-white",children:[(0,t.jsx)(c,{className:"w-4 h-4 mr-2"}),"Выйти"]})]})]})})]})}e.s(["SMAccountPage",()=>b],12519);var w=e.i(19964),N=e.i(91880),C=e.i(41627);e.i(34828);var S=e.i(74080);function A(e,[t,s]){return Math.min(s,Math.max(t,e))}var E=e.i(81140),k=e.i(75830),P=e.i(20783),D=e.i(30030),R=e.i(86318),T=e.i(26330),M=e.i(3536),L=e.i(65491),I=e.i(10772),_=e.i(53660),H=(e.i(74606),e.i(48425)),B=e.i(91918),F=e.i(30207),U=e.i(69340),O=e.i(34620),z=e.i(99682),$=e.i(59411),K=e.i(86312),V=e.i(85369),W=[" ","Enter","ArrowUp","ArrowDown"],X=[" ","Enter"],q="Select",[Y,G,J]=(0,k.createCollection)(q),[Z,Q]=(0,D.createContextScope)(q,[J,_.createPopperScope]),ee=(0,_.createPopperScope)(),[et,es]=Z(q),[ea,er]=Z(q),el="SelectTrigger";j.forwardRef((e,s)=>{let{__scopeSelect:a,disabled:r=!1,...l}=e,i=ee(a),n=es(el,a),c=n.disabled||r,o=(0,P.useComposedRefs)(s,n.onTriggerChange),d=G(a),m=j.useRef("touch"),[x,h,u]=eR(e=>{let t=d().filter(e=>!e.disabled),s=t.find(e=>e.value===n.value),a=eT(t,e,s);void 0!==a&&n.onValueChange(a.value)}),g=e=>{c||(n.onOpenChange(!0),u()),e&&(n.triggerPointerDownPosRef.current={x:Math.round(e.pageX),y:Math.round(e.pageY)})};return(0,t.jsx)(_.Anchor,{asChild:!0,...i,children:(0,t.jsx)(H.Primitive.button,{type:"button",role:"combobox","aria-controls":n.contentId,"aria-expanded":n.open,"aria-required":n.required,"aria-autocomplete":"none",dir:n.dir,"data-state":n.open?"open":"closed",disabled:c,"data-disabled":c?"":void 0,"data-placeholder":eD(n.value)?"":void 0,...l,ref:o,onClick:(0,E.composeEventHandlers)(l.onClick,e=>{e.currentTarget.focus(),"mouse"!==m.current&&g(e)}),onPointerDown:(0,E.composeEventHandlers)(l.onPointerDown,e=>{m.current=e.pointerType;let t=e.target;t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),0===e.button&&!1===e.ctrlKey&&"mouse"===e.pointerType&&(g(e),e.preventDefault())}),onKeyDown:(0,E.composeEventHandlers)(l.onKeyDown,e=>{let t=""!==x.current;e.ctrlKey||e.altKey||e.metaKey||1!==e.key.length||h(e.key),(!t||" "!==e.key)&&W.includes(e.key)&&(g(),e.preventDefault())})})})}).displayName=el;var ei="SelectValue";j.forwardRef((e,s)=>{let{__scopeSelect:a,className:r,style:l,children:i,placeholder:n="",...c}=e,o=es(ei,a),{onValueNodeHasChildrenChange:d}=o,m=void 0!==i,x=(0,P.useComposedRefs)(s,o.onValueNodeChange);return(0,O.useLayoutEffect)(()=>{d(m)},[d,m]),(0,t.jsx)(H.Primitive.span,{...c,ref:x,style:{pointerEvents:"none"},children:eD(o.value)?(0,t.jsx)(t.Fragment,{children:n}):i})}).displayName=ei,j.forwardRef((e,s)=>{let{__scopeSelect:a,children:r,...l}=e;return(0,t.jsx)(H.Primitive.span,{"aria-hidden":!0,...l,ref:s,children:r||"▼"})}).displayName="SelectIcon";var en="SelectContent";j.forwardRef((e,s)=>{let a=es(en,e.__scopeSelect),[r,l]=j.useState();return((0,O.useLayoutEffect)(()=>{l(new DocumentFragment)},[]),a.open)?(0,t.jsx)(em,{...e,ref:s}):r?S.createPortal((0,t.jsx)(ec,{scope:e.__scopeSelect,children:(0,t.jsx)(Y.Slot,{scope:e.__scopeSelect,children:(0,t.jsx)("div",{children:e.children})})}),r):null}).displayName=en;var[ec,eo]=Z(en),ed=(0,B.createSlot)("SelectContent.RemoveScroll"),em=j.forwardRef((e,s)=>{let{__scopeSelect:a,position:r="item-aligned",onCloseAutoFocus:l,onEscapeKeyDown:i,onPointerDownOutside:n,side:c,sideOffset:o,align:d,alignOffset:m,arrowPadding:x,collisionBoundary:h,collisionPadding:u,sticky:g,hideWhenDetached:p,avoidCollisions:f,...v}=e,y=es(en,a),[b,w]=j.useState(null),[N,C]=j.useState(null),S=(0,P.useComposedRefs)(s,e=>w(e)),[A,k]=j.useState(null),[D,R]=j.useState(null),I=G(a),[_,H]=j.useState(!1),B=j.useRef(!1);j.useEffect(()=>{if(b)return(0,K.hideOthers)(b)},[b]),(0,M.useFocusGuards)();let F=j.useCallback(e=>{let[t,...s]=I().map(e=>e.ref.current),[a]=s.slice(-1),r=document.activeElement;for(let s of e)if(s===r||(s?.scrollIntoView({block:"nearest"}),s===t&&N&&(N.scrollTop=0),s===a&&N&&(N.scrollTop=N.scrollHeight),s?.focus(),document.activeElement!==r))return},[I,N]),U=j.useCallback(()=>F([A,b]),[F,A,b]);j.useEffect(()=>{_&&U()},[_,U]);let{onOpenChange:O,triggerPointerDownPosRef:z}=y;j.useEffect(()=>{if(b){let e={x:0,y:0},t=t=>{e={x:Math.abs(Math.round(t.pageX)-(z.current?.x??0)),y:Math.abs(Math.round(t.pageY)-(z.current?.y??0))}},s=s=>{e.x<=10&&e.y<=10?s.preventDefault():b.contains(s.target)||O(!1),document.removeEventListener("pointermove",t),z.current=null};return null!==z.current&&(document.addEventListener("pointermove",t),document.addEventListener("pointerup",s,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",t),document.removeEventListener("pointerup",s,{capture:!0})}}},[b,O,z]),j.useEffect(()=>{let e=()=>O(!1);return window.addEventListener("blur",e),window.addEventListener("resize",e),()=>{window.removeEventListener("blur",e),window.removeEventListener("resize",e)}},[O]);let[$,W]=eR(e=>{let t=I().filter(e=>!e.disabled),s=t.find(e=>e.ref.current===document.activeElement),a=eT(t,e,s);a&&setTimeout(()=>a.ref.current.focus())}),X=j.useCallback((e,t,s)=>{let a=!B.current&&!s;(void 0!==y.value&&y.value===t||a)&&(k(e),a&&(B.current=!0))},[y.value]),q=j.useCallback(()=>b?.focus(),[b]),Y=j.useCallback((e,t,s)=>{let a=!B.current&&!s;(void 0!==y.value&&y.value===t||a)&&R(e)},[y.value]),J="popper"===r?eh:ex,Z=J===eh?{side:c,sideOffset:o,align:d,alignOffset:m,arrowPadding:x,collisionBoundary:h,collisionPadding:u,sticky:g,hideWhenDetached:p,avoidCollisions:f}:{};return(0,t.jsx)(ec,{scope:a,content:b,viewport:N,onViewportChange:C,itemRefCallback:X,selectedItem:A,onItemLeave:q,itemTextRefCallback:Y,focusSelectedItem:U,selectedItemText:D,position:r,isPositioned:_,searchRef:$,children:(0,t.jsx)(V.RemoveScroll,{as:ed,allowPinchZoom:!0,children:(0,t.jsx)(L.FocusScope,{asChild:!0,trapped:y.open,onMountAutoFocus:e=>{e.preventDefault()},onUnmountAutoFocus:(0,E.composeEventHandlers)(l,e=>{y.trigger?.focus({preventScroll:!0}),e.preventDefault()}),children:(0,t.jsx)(T.DismissableLayer,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:n,onFocusOutside:e=>e.preventDefault(),onDismiss:()=>y.onOpenChange(!1),children:(0,t.jsx)(J,{role:"listbox",id:y.contentId,"data-state":y.open?"open":"closed",dir:y.dir,onContextMenu:e=>e.preventDefault(),...v,...Z,onPlaced:()=>H(!0),ref:S,style:{display:"flex",flexDirection:"column",outline:"none",...v.style},onKeyDown:(0,E.composeEventHandlers)(v.onKeyDown,e=>{let t=e.ctrlKey||e.altKey||e.metaKey;if("Tab"===e.key&&e.preventDefault(),t||1!==e.key.length||W(e.key),["ArrowUp","ArrowDown","Home","End"].includes(e.key)){let t=I().filter(e=>!e.disabled).map(e=>e.ref.current);if(["ArrowUp","End"].includes(e.key)&&(t=t.slice().reverse()),["ArrowUp","ArrowDown"].includes(e.key)){let s=e.target,a=t.indexOf(s);t=t.slice(a+1)}setTimeout(()=>F(t)),e.preventDefault()}})})})})})})});em.displayName="SelectContentImpl";var ex=j.forwardRef((e,s)=>{let{__scopeSelect:a,onPlaced:r,...l}=e,i=es(en,a),n=eo(en,a),[c,o]=j.useState(null),[d,m]=j.useState(null),x=(0,P.useComposedRefs)(s,e=>m(e)),h=G(a),u=j.useRef(!1),g=j.useRef(!0),{viewport:p,selectedItem:f,selectedItemText:v,focusSelectedItem:y}=n,b=j.useCallback(()=>{if(i.trigger&&i.valueNode&&c&&d&&p&&f&&v){let e=i.trigger.getBoundingClientRect(),t=d.getBoundingClientRect(),s=i.valueNode.getBoundingClientRect(),a=v.getBoundingClientRect();if("rtl"!==i.dir){let r=a.left-t.left,l=s.left-r,i=e.left-l,n=e.width+i,o=Math.max(n,t.width),d=A(l,[10,Math.max(10,window.innerWidth-10-o)]);c.style.minWidth=n+"px",c.style.left=d+"px"}else{let r=t.right-a.right,l=window.innerWidth-s.right-r,i=window.innerWidth-e.right-l,n=e.width+i,o=Math.max(n,t.width),d=A(l,[10,Math.max(10,window.innerWidth-10-o)]);c.style.minWidth=n+"px",c.style.right=d+"px"}let l=h(),n=window.innerHeight-20,o=p.scrollHeight,m=window.getComputedStyle(d),x=parseInt(m.borderTopWidth,10),g=parseInt(m.paddingTop,10),j=parseInt(m.borderBottomWidth,10),y=x+g+o+parseInt(m.paddingBottom,10)+j,b=Math.min(5*f.offsetHeight,y),w=window.getComputedStyle(p),N=parseInt(w.paddingTop,10),C=parseInt(w.paddingBottom,10),S=e.top+e.height/2-10,E=f.offsetHeight/2,k=x+g+(f.offsetTop+E);if(k<=S){let e=l.length>0&&f===l[l.length-1].ref.current;c.style.bottom="0px";let t=Math.max(n-S,E+(e?C:0)+(d.clientHeight-p.offsetTop-p.offsetHeight)+j);c.style.height=k+t+"px"}else{let e=l.length>0&&f===l[0].ref.current;c.style.top="0px";let t=Math.max(S,x+p.offsetTop+(e?N:0)+E);c.style.height=t+(y-k)+"px",p.scrollTop=k-S+p.offsetTop}c.style.margin="10px 0",c.style.minHeight=b+"px",c.style.maxHeight=n+"px",r?.(),requestAnimationFrame(()=>u.current=!0)}},[h,i.trigger,i.valueNode,c,d,p,f,v,i.dir,r]);(0,O.useLayoutEffect)(()=>b(),[b]);let[w,N]=j.useState();(0,O.useLayoutEffect)(()=>{d&&N(window.getComputedStyle(d).zIndex)},[d]);let C=j.useCallback(e=>{e&&!0===g.current&&(b(),y?.(),g.current=!1)},[b,y]);return(0,t.jsx)(eu,{scope:a,contentWrapper:c,shouldExpandOnScrollRef:u,onScrollButtonChange:C,children:(0,t.jsx)("div",{ref:o,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:w},children:(0,t.jsx)(H.Primitive.div,{...l,ref:x,style:{boxSizing:"border-box",maxHeight:"100%",...l.style}})})})});ex.displayName="SelectItemAlignedPosition";var eh=j.forwardRef((e,s)=>{let{__scopeSelect:a,align:r="start",collisionPadding:l=10,...i}=e,n=ee(a);return(0,t.jsx)(_.Content,{...n,...i,ref:s,align:r,collisionPadding:l,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});eh.displayName="SelectPopperPosition";var[eu,eg]=Z(en,{}),ep="SelectViewport";j.forwardRef((e,s)=>{let{__scopeSelect:a,nonce:r,...l}=e,i=eo(ep,a),n=eg(ep,a),c=(0,P.useComposedRefs)(s,i.onViewportChange),o=j.useRef(0);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),(0,t.jsx)(Y.Slot,{scope:a,children:(0,t.jsx)(H.Primitive.div,{"data-radix-select-viewport":"",role:"presentation",...l,ref:c,style:{position:"relative",flex:1,overflow:"hidden auto",...l.style},onScroll:(0,E.composeEventHandlers)(l.onScroll,e=>{let t=e.currentTarget,{contentWrapper:s,shouldExpandOnScrollRef:a}=n;if(a?.current&&s){let e=Math.abs(o.current-t.scrollTop);if(e>0){let a=window.innerHeight-20,r=Math.max(parseFloat(s.style.minHeight),parseFloat(s.style.height));if(r<a){let l=r+e,i=Math.min(a,l),n=l-i;s.style.height=i+"px","0px"===s.style.bottom&&(t.scrollTop=n>0?n:0,s.style.justifyContent="flex-end")}}}o.current=t.scrollTop})})})]})}).displayName=ep;var ef="SelectGroup",[ej,ev]=Z(ef);j.forwardRef((e,s)=>{let{__scopeSelect:a,...r}=e,l=(0,I.useId)();return(0,t.jsx)(ej,{scope:a,id:l,children:(0,t.jsx)(H.Primitive.div,{role:"group","aria-labelledby":l,...r,ref:s})})}).displayName=ef;var ey="SelectLabel";j.forwardRef((e,s)=>{let{__scopeSelect:a,...r}=e,l=ev(ey,a);return(0,t.jsx)(H.Primitive.div,{id:l.id,...r,ref:s})}).displayName=ey;var eb="SelectItem",[ew,eN]=Z(eb);j.forwardRef((e,s)=>{let{__scopeSelect:a,value:r,disabled:l=!1,textValue:i,...n}=e,c=es(eb,a),o=eo(eb,a),d=c.value===r,[m,x]=j.useState(i??""),[h,u]=j.useState(!1),g=(0,P.useComposedRefs)(s,e=>o.itemRefCallback?.(e,r,l)),p=(0,I.useId)(),f=j.useRef("touch"),v=()=>{l||(c.onValueChange(r),c.onOpenChange(!1))};if(""===r)throw Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return(0,t.jsx)(ew,{scope:a,value:r,disabled:l,textId:p,isSelected:d,onItemTextChange:j.useCallback(e=>{x(t=>t||(e?.textContent??"").trim())},[]),children:(0,t.jsx)(Y.ItemSlot,{scope:a,value:r,disabled:l,textValue:m,children:(0,t.jsx)(H.Primitive.div,{role:"option","aria-labelledby":p,"data-highlighted":h?"":void 0,"aria-selected":d&&h,"data-state":d?"checked":"unchecked","aria-disabled":l||void 0,"data-disabled":l?"":void 0,tabIndex:l?void 0:-1,...n,ref:g,onFocus:(0,E.composeEventHandlers)(n.onFocus,()=>u(!0)),onBlur:(0,E.composeEventHandlers)(n.onBlur,()=>u(!1)),onClick:(0,E.composeEventHandlers)(n.onClick,()=>{"mouse"!==f.current&&v()}),onPointerUp:(0,E.composeEventHandlers)(n.onPointerUp,()=>{"mouse"===f.current&&v()}),onPointerDown:(0,E.composeEventHandlers)(n.onPointerDown,e=>{f.current=e.pointerType}),onPointerMove:(0,E.composeEventHandlers)(n.onPointerMove,e=>{f.current=e.pointerType,l?o.onItemLeave?.():"mouse"===f.current&&e.currentTarget.focus({preventScroll:!0})}),onPointerLeave:(0,E.composeEventHandlers)(n.onPointerLeave,e=>{e.currentTarget===document.activeElement&&o.onItemLeave?.()}),onKeyDown:(0,E.composeEventHandlers)(n.onKeyDown,e=>{(o.searchRef?.current===""||" "!==e.key)&&(X.includes(e.key)&&v()," "===e.key&&e.preventDefault())})})})})}).displayName=eb;var eC="SelectItemText";j.forwardRef((e,s)=>{let{__scopeSelect:a,className:r,style:l,...i}=e,n=es(eC,a),c=eo(eC,a),o=eN(eC,a),d=er(eC,a),[m,x]=j.useState(null),h=(0,P.useComposedRefs)(s,e=>x(e),o.onItemTextChange,e=>c.itemTextRefCallback?.(e,o.value,o.disabled)),u=m?.textContent,g=j.useMemo(()=>(0,t.jsx)("option",{value:o.value,disabled:o.disabled,children:u},o.value),[o.disabled,o.value,u]),{onNativeOptionAdd:p,onNativeOptionRemove:f}=d;return(0,O.useLayoutEffect)(()=>(p(g),()=>f(g)),[p,f,g]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(H.Primitive.span,{id:o.textId,...i,ref:h}),o.isSelected&&n.valueNode&&!n.valueNodeHasChildren?S.createPortal(i.children,n.valueNode):null]})}).displayName=eC;var eS="SelectItemIndicator";j.forwardRef((e,s)=>{let{__scopeSelect:a,...r}=e;return eN(eS,a).isSelected?(0,t.jsx)(H.Primitive.span,{"aria-hidden":!0,...r,ref:s}):null}).displayName=eS;var eA="SelectScrollUpButton";j.forwardRef((e,s)=>{let a=eo(eA,e.__scopeSelect),r=eg(eA,e.__scopeSelect),[l,i]=j.useState(!1),n=(0,P.useComposedRefs)(s,r.onScrollButtonChange);return(0,O.useLayoutEffect)(()=>{if(a.viewport&&a.isPositioned){let e=function(){i(t.scrollTop>0)},t=a.viewport;return e(),t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)}},[a.viewport,a.isPositioned]),l?(0,t.jsx)(ek,{...e,ref:n,onAutoScroll:()=>{let{viewport:e,selectedItem:t}=a;e&&t&&(e.scrollTop=e.scrollTop-t.offsetHeight)}}):null}).displayName=eA;var eE="SelectScrollDownButton";j.forwardRef((e,s)=>{let a=eo(eE,e.__scopeSelect),r=eg(eE,e.__scopeSelect),[l,i]=j.useState(!1),n=(0,P.useComposedRefs)(s,r.onScrollButtonChange);return(0,O.useLayoutEffect)(()=>{if(a.viewport&&a.isPositioned){let e=function(){let e=t.scrollHeight-t.clientHeight;i(Math.ceil(t.scrollTop)<e)},t=a.viewport;return e(),t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)}},[a.viewport,a.isPositioned]),l?(0,t.jsx)(ek,{...e,ref:n,onAutoScroll:()=>{let{viewport:e,selectedItem:t}=a;e&&t&&(e.scrollTop=e.scrollTop+t.offsetHeight)}}):null}).displayName=eE;var ek=j.forwardRef((e,s)=>{let{__scopeSelect:a,onAutoScroll:r,...l}=e,i=eo("SelectScrollButton",a),n=j.useRef(null),c=G(a),o=j.useCallback(()=>{null!==n.current&&(window.clearInterval(n.current),n.current=null)},[]);return j.useEffect(()=>()=>o(),[o]),(0,O.useLayoutEffect)(()=>{let e=c().find(e=>e.ref.current===document.activeElement);e?.ref.current?.scrollIntoView({block:"nearest"})},[c]),(0,t.jsx)(H.Primitive.div,{"aria-hidden":!0,...l,ref:s,style:{flexShrink:0,...l.style},onPointerDown:(0,E.composeEventHandlers)(l.onPointerDown,()=>{null===n.current&&(n.current=window.setInterval(r,50))}),onPointerMove:(0,E.composeEventHandlers)(l.onPointerMove,()=>{i.onItemLeave?.(),null===n.current&&(n.current=window.setInterval(r,50))}),onPointerLeave:(0,E.composeEventHandlers)(l.onPointerLeave,()=>{o()})})});j.forwardRef((e,s)=>{let{__scopeSelect:a,...r}=e;return(0,t.jsx)(H.Primitive.div,{"aria-hidden":!0,...r,ref:s})}).displayName="SelectSeparator";var eP="SelectArrow";function eD(e){return""===e||void 0===e}function eR(e){let t=(0,F.useCallbackRef)(e),s=j.useRef(""),a=j.useRef(0),r=j.useCallback(e=>{let r=s.current+e;t(r),function e(t){s.current=t,window.clearTimeout(a.current),""!==t&&(a.current=window.setTimeout(()=>e(""),1e3))}(r)},[t]),l=j.useCallback(()=>{s.current="",window.clearTimeout(a.current)},[]);return j.useEffect(()=>()=>window.clearTimeout(a.current),[]),[s,r,l]}function eT(e,t,s){var a,r;let l=t.length>1&&Array.from(t).every(e=>e===t[0])?t[0]:t,i=s?e.indexOf(s):-1,n=(a=e,r=Math.max(i,0),a.map((e,t)=>a[(r+t)%a.length]));1===l.length&&(n=n.filter(e=>e!==s));let c=n.find(e=>e.textValue.toLowerCase().startsWith(l.toLowerCase()));return c!==s?c:void 0}j.forwardRef((e,s)=>{let{__scopeSelect:a,...r}=e,l=ee(a),i=es(eP,a),n=eo(eP,a);return i.open&&"popper"===n.position?(0,t.jsx)(_.Arrow,{...l,...r,ref:s}):null}).displayName=eP,j.forwardRef(({__scopeSelect:e,value:s,...a},r)=>{let l=j.useRef(null),i=(0,P.useComposedRefs)(r,l),n=(0,z.usePrevious)(s);return j.useEffect(()=>{let e=l.current;if(!e)return;let t=Object.getOwnPropertyDescriptor(window.HTMLSelectElement.prototype,"value").set;if(n!==s&&t){let a=new Event("change",{bubbles:!0});t.call(e,s),e.dispatchEvent(a)}},[n,s]),(0,t.jsx)(H.Primitive.select,{...a,style:{...$.VISUALLY_HIDDEN_STYLES,...a.style},ref:i,defaultValue:s})}).displayName="SelectBubbleInput",e.i(78784),e.i(9797);let eM=(0,i.default)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var eL=e.i(80809);function eI({className:e,...s}){return(0,t.jsx)("textarea",{"data-slot":"textarea",className:(0,eL.cn)("resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-input-background px-3 py-2 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...s})}var e_=e.i(31961);let eH=(0,i.default)("calendar-days",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);(0,i.default)("settings-2",[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);var eB=e.i(86311),eF=e.i(63059),eU=e.i(70756);let eO=(0,i.default)("at-sign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]),ez=(0,i.default)("pen-line",[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var e$=e.i(86536),eK=e.i(98919),eV=e.i(14764),eW=e.i(31278),eX=e.i(64659),eq=e.i(23622);let eY={email:"",categories:[],format:"html",agreed:!1},eG="Если у вас возникли вопросы по поводу работы наших врачей или клиники в целом, а также если вы хотите сказать слова благодарности, напишите сообщение и оно придет главному врачу лично",eJ={name:"",subject:"",message:""};var eZ=e.i(20230),eQ=e.i(97630),e0=e.i(88653),e1=e.i(77705),e2=e.i(95468),e3=e.i(37727),e4=e.i(86633);function e6({isOpen:e,onClose:a}){let[r,l]=(0,j.useState)(""),[i,n]=(0,j.useState)(""),[c,o]=(0,j.useState)(""),[d,m]=(0,j.useState)(!1),[x,h]=(0,j.useState)(!1),[g,p]=(0,j.useState)(!1),[f,v]=(0,j.useState)(!1),y=(0,e4.useAlert)(),b=()=>{l(""),n(""),o(""),m(!1),h(!1),p(!1),a()},w=async()=>{if(r.trim()?i.trim()?i.length<6?(y.error("Новый пароль должен содержать минимум 6 символов","Слишком короткий пароль"),!1):i!==c?(y.error("Пароли не совпадают","Ошибка валидации"),!1):r!==i||(y.warning("Новый пароль должен отличаться от текущего","Одинаковые пароли"),!1):(y.error("Введите новый пароль","Ошибка валидации"),!1):(y.error("Введите текущий пароль","Ошибка валидации"),!1)){v(!0);try{let e=await fetch("/api/auth/change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({oldPassword:r,newPassword:i})}),t=await e.json();if(!e.ok)return void y.error(t.error||"Ошибка при смене пароля","Ошибка");y.success("Пароль успешно изменен!","Успешно"),b()}catch(e){y.error("Ошибка при смене пароля. Попробуйте позже.","Ошибка")}finally{v(!1)}}},S=(e=>{if(!e)return{strength:0,text:"",color:""};let t=0;return(e.length>=6&&t++,e.length>=8&&t++,/[a-z]/.test(e)&&/[A-Z]/.test(e)&&t++,/\d/.test(e)&&t++,/[^a-zA-Z\d]/.test(e)&&t++,t<=1)?{strength:20,text:"Слабый",color:"bg-red-500"}:t<=2?{strength:40,text:"Средний",color:"bg-orange-500"}:t<=3?{strength:60,text:"Хороший",color:"bg-yellow-500"}:t<=4?{strength:80,text:"Сильный",color:"bg-green-500"}:{strength:100,text:"Очень сильный",color:"bg-emerald-500"}})(i);return(0,t.jsx)(e0.AnimatePresence,{children:e&&(0,t.jsxs)("div",{className:"fixed inset-0 z-[120] flex items-center justify-center p-4",children:[(0,t.jsx)(s.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:b,className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),(0,t.jsxs)(s.motion.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.2},className:"relative w-full max-w-md bg-white rounded-2xl shadow-2xl overflow-hidden max-h-[90vh] flex flex-col",children:[(0,t.jsx)("div",{className:"bg-[#18A36C] px-6 py-4 flex-shrink-0",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(eK.Shield,{className:"w-6 h-6 text-white"}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Смена пароля"})]}),(0,t.jsx)("button",{onClick:b,disabled:f,className:"p-1.5 hover:bg-white/20 rounded-lg cursor-pointer transition-colors disabled:opacity-50",children:(0,t.jsx)(e3.X,{className:"w-5 h-5 text-white"})})]})}),(0,t.jsx)("div",{className:"p-6 overflow-y-auto flex-1",children:(0,t.jsxs)("div",{className:"space-y-5",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(C.Label,{htmlFor:"oldPassword",className:"text-[#2E2E2E]",children:"Текущий пароль"}),(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)(eU.Lock,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 group-focus-within:text-[#18A36C] transition-colors"}),(0,t.jsx)(N.Input,{id:"oldPassword",type:d?"text":"password",placeholder:"Введите текущий пароль",value:r,onChange:e=>l(e.target.value),className:"pl-12 pr-12 h-12 border-gray-300 focus:border-[#18A36C] transition-all duration-200 rounded-lg"}),(0,t.jsx)("button",{type:"button",onClick:()=>m(!d),className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-[#18A36C] transition-colors",children:d?(0,t.jsx)(e1.EyeOff,{className:"w-5 h-5"}):(0,t.jsx)(e$.Eye,{className:"w-5 h-5"})})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(C.Label,{htmlFor:"newPassword",className:"text-[#2E2E2E]",children:"Новый пароль"}),(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)(eU.Lock,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 group-focus-within:text-[#18A36C] transition-colors"}),(0,t.jsx)(N.Input,{id:"newPassword",type:x?"text":"password",placeholder:"Введите новый пароль",value:i,onChange:e=>n(e.target.value),className:"pl-12 pr-12 h-12 border-gray-300 focus:border-[#18A36C] transition-all duration-200 rounded-lg"}),(0,t.jsx)("button",{type:"button",onClick:()=>h(!x),className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-[#18A36C] transition-colors",children:x?(0,t.jsx)(e1.EyeOff,{className:"w-5 h-5"}):(0,t.jsx)(e$.Eye,{className:"w-5 h-5"})})]}),i&&(0,t.jsxs)(s.motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Надежность пароля"}),(0,t.jsx)("span",{className:`font-medium ${S.color.replace("bg-","text-")}`,children:S.text})]}),(0,t.jsx)("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,t.jsx)(s.motion.div,{initial:{width:0},animate:{width:`${S.strength}%`},transition:{duration:.3},className:`h-full ${S.color} rounded-full`})})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(C.Label,{htmlFor:"confirmPassword",className:"text-[#2E2E2E]",children:"Подтверждение пароля"}),(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)(eU.Lock,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 group-focus-within:text-[#18A36C] transition-colors"}),(0,t.jsx)(N.Input,{id:"confirmPassword",type:g?"text":"password",placeholder:"Повторите новый пароль",value:c,onChange:e=>o(e.target.value),className:"pl-12 pr-12 h-12 border-gray-300 focus:border-[#18A36C] transition-all duration-200 rounded-lg"}),(0,t.jsx)("button",{type:"button",onClick:()=>p(!g),className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-[#18A36C] transition-colors",children:g?(0,t.jsx)(e1.EyeOff,{className:"w-5 h-5"}):(0,t.jsx)(e$.Eye,{className:"w-5 h-5"})})]}),c&&(0,t.jsx)(s.motion.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-center gap-2",children:i===c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e2.CheckCircle2,{className:"w-4 h-4 text-green-500"}),(0,t.jsx)("span",{className:"text-xs text-green-600",children:"Пароли совпадают"})]}):(0,t.jsx)("span",{className:"text-xs text-red-600",children:"Пароли не совпадают"})})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsx)(u.Button,{onClick:b,variant:"outline",className:"flex-1 h-12 border-gray-300 text-gray-700 hover:bg-gray-50",disabled:f,children:"Отмена"}),(0,t.jsx)(u.Button,{onClick:w,disabled:f||!r||!i||!c,className:"flex-1 h-12 bg-[#18A36C] hover:bg-[#18A36C]/90 text-white",children:f?"Изменение...":"Изменить пароль"})]}),(0,t.jsxs)("div",{className:"text-center text-xs text-gray-600 mt-4 p-3 bg-[#F4F4F4] rounded-lg",children:[(0,t.jsx)(eK.Shield,{className:"w-4 h-4 inline mr-1"}),"Для безопасности используйте пароль длиной минимум 8 символов с буквами и цифрами"]})]})})]})]})})}let e8=(0,i.default)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);var e5=e.i(27612),e9=e.i(56909),e7=e.i(35804),te=["PageUp","PageDown"],tt=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ts={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},ta="Slider",[tr,tl,ti]=(0,k.createCollection)(ta),[tn,tc]=(0,D.createContextScope)(ta,[ti]),[to,td]=tn(ta),tm=j.forwardRef((e,s)=>{let{name:a,min:r=0,max:l=100,step:i=1,orientation:n="horizontal",disabled:c=!1,minStepsBetweenThumbs:o=0,defaultValue:d=[r],value:m,onValueChange:x=()=>{},onValueCommit:h=()=>{},inverted:u=!1,form:g,...p}=e,f=j.useRef(new Set),v=j.useRef(0),y="horizontal"===n,[b=[],w]=(0,U.useControllableState)({prop:m,defaultProp:d,onChange:e=>{let t=[...f.current];t[v.current]?.focus(),x(e)}}),N=j.useRef(b);function C(e,t,{commit:s}={commit:!1}){let a,n=(String(i).split(".")[1]||"").length,c=A(Math.round((Math.round((e-r)/i)*i+r)*(a=Math.pow(10,n)))/a,[r,l]);w((e=[])=>{let a=function(e=[],t,s){let a=[...e];return a[s]=t,a.sort((e,t)=>e-t)}(e,c,t);if(!function(e,t){if(t>0)return Math.min(...e.slice(0,-1).map((t,s)=>e[s+1]-t))>=t;return!0}(a,o*i))return e;{v.current=a.indexOf(c);let t=String(a)!==String(e);return t&&s&&h(a),t?a:e}})}return(0,t.jsx)(to,{scope:e.__scopeSlider,name:a,disabled:c,min:r,max:l,valueIndexToChangeRef:v,thumbs:f.current,values:b,orientation:n,form:g,children:(0,t.jsx)(tr.Provider,{scope:e.__scopeSlider,children:(0,t.jsx)(tr.Slot,{scope:e.__scopeSlider,children:(0,t.jsx)(y?tu:tg,{"aria-disabled":c,"data-disabled":c?"":void 0,...p,ref:s,onPointerDown:(0,E.composeEventHandlers)(p.onPointerDown,()=>{c||(N.current=b)}),min:r,max:l,inverted:u,onSlideStart:c?void 0:function(e){let t=function(e,t){if(1===e.length)return 0;let s=e.map(e=>Math.abs(e-t)),a=Math.min(...s);return s.indexOf(a)}(b,e);C(e,t)},onSlideMove:c?void 0:function(e){C(e,v.current)},onSlideEnd:c?void 0:function(){let e=N.current[v.current];b[v.current]!==e&&h(b)},onHomeKeyDown:()=>!c&&C(r,0,{commit:!0}),onEndKeyDown:()=>!c&&C(l,b.length-1,{commit:!0}),onStepKeyDown:({event:e,direction:t})=>{if(!c){let s=te.includes(e.key)||e.shiftKey&&tt.includes(e.key),a=v.current;C(b[a]+i*(s?10:1)*t,a,{commit:!0})}}})})})})});tm.displayName=ta;var[tx,th]=tn(ta,{startEdge:"left",endEdge:"right",size:"width",direction:1}),tu=j.forwardRef((e,s)=>{let{min:a,max:r,dir:l,inverted:i,onSlideStart:n,onSlideMove:c,onSlideEnd:o,onStepKeyDown:d,...m}=e,[x,h]=j.useState(null),u=(0,P.useComposedRefs)(s,e=>h(e)),g=j.useRef(void 0),p=(0,R.useDirection)(l),f="ltr"===p,v=f&&!i||!f&&i;function y(e){let t=g.current||x.getBoundingClientRect(),s=tA([0,t.width],v?[a,r]:[r,a]);return g.current=t,s(e-t.left)}return(0,t.jsx)(tx,{scope:e.__scopeSlider,startEdge:v?"left":"right",endEdge:v?"right":"left",direction:v?1:-1,size:"width",children:(0,t.jsx)(tp,{dir:p,"data-orientation":"horizontal",...m,ref:u,style:{...m.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:e=>{let t=y(e.clientX);n?.(t)},onSlideMove:e=>{let t=y(e.clientX);c?.(t)},onSlideEnd:()=>{g.current=void 0,o?.()},onStepKeyDown:e=>{let t=ts[v?"from-left":"from-right"].includes(e.key);d?.({event:e,direction:t?-1:1})}})})}),tg=j.forwardRef((e,s)=>{let{min:a,max:r,inverted:l,onSlideStart:i,onSlideMove:n,onSlideEnd:c,onStepKeyDown:o,...d}=e,m=j.useRef(null),x=(0,P.useComposedRefs)(s,m),h=j.useRef(void 0),u=!l;function g(e){let t=h.current||m.current.getBoundingClientRect(),s=tA([0,t.height],u?[r,a]:[a,r]);return h.current=t,s(e-t.top)}return(0,t.jsx)(tx,{scope:e.__scopeSlider,startEdge:u?"bottom":"top",endEdge:u?"top":"bottom",size:"height",direction:u?1:-1,children:(0,t.jsx)(tp,{"data-orientation":"vertical",...d,ref:x,style:{...d.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:e=>{let t=g(e.clientY);i?.(t)},onSlideMove:e=>{let t=g(e.clientY);n?.(t)},onSlideEnd:()=>{h.current=void 0,c?.()},onStepKeyDown:e=>{let t=ts[u?"from-bottom":"from-top"].includes(e.key);o?.({event:e,direction:t?-1:1})}})})}),tp=j.forwardRef((e,s)=>{let{__scopeSlider:a,onSlideStart:r,onSlideMove:l,onSlideEnd:i,onHomeKeyDown:n,onEndKeyDown:c,onStepKeyDown:o,...d}=e,m=td(ta,a);return(0,t.jsx)(H.Primitive.span,{...d,ref:s,onKeyDown:(0,E.composeEventHandlers)(e.onKeyDown,e=>{"Home"===e.key?(n(e),e.preventDefault()):"End"===e.key?(c(e),e.preventDefault()):te.concat(tt).includes(e.key)&&(o(e),e.preventDefault())}),onPointerDown:(0,E.composeEventHandlers)(e.onPointerDown,e=>{let t=e.target;t.setPointerCapture(e.pointerId),e.preventDefault(),m.thumbs.has(t)?t.focus():r(e)}),onPointerMove:(0,E.composeEventHandlers)(e.onPointerMove,e=>{e.target.hasPointerCapture(e.pointerId)&&l(e)}),onPointerUp:(0,E.composeEventHandlers)(e.onPointerUp,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&(t.releasePointerCapture(e.pointerId),i(e))})})}),tf="SliderTrack",tj=j.forwardRef((e,s)=>{let{__scopeSlider:a,...r}=e,l=td(tf,a);return(0,t.jsx)(H.Primitive.span,{"data-disabled":l.disabled?"":void 0,"data-orientation":l.orientation,...r,ref:s})});tj.displayName=tf;var tv="SliderRange",ty=j.forwardRef((e,s)=>{let{__scopeSlider:a,...r}=e,l=td(tv,a),i=th(tv,a),n=j.useRef(null),c=(0,P.useComposedRefs)(s,n),o=l.values.length,d=l.values.map(e=>tS(e,l.min,l.max)),m=o>1?Math.min(...d):0,x=100-Math.max(...d);return(0,t.jsx)(H.Primitive.span,{"data-orientation":l.orientation,"data-disabled":l.disabled?"":void 0,...r,ref:c,style:{...e.style,[i.startEdge]:m+"%",[i.endEdge]:x+"%"}})});ty.displayName=tv;var tb="SliderThumb",tw=j.forwardRef((e,s)=>{let a=tl(e.__scopeSlider),[r,l]=j.useState(null),i=(0,P.useComposedRefs)(s,e=>l(e)),n=j.useMemo(()=>r?a().findIndex(e=>e.ref.current===r):-1,[a,r]);return(0,t.jsx)(tN,{...e,ref:i,index:n})}),tN=j.forwardRef((e,s)=>{var a,r,l,i,n;let c,o,{__scopeSlider:d,index:m,name:x,...h}=e,u=td(tb,d),g=th(tb,d),[p,f]=j.useState(null),v=(0,P.useComposedRefs)(s,e=>f(e)),y=!p||u.form||!!p.closest("form"),b=(0,e7.useSize)(p),w=u.values[m],N=void 0===w?0:tS(w,u.min,u.max),C=(a=m,(r=u.values.length)>2?`Value ${a+1} of ${r}`:2===r?["Minimum","Maximum"][a]:void 0),S=b?.[g.size],A=S?(l=S,i=N,n=g.direction,o=tA([0,50],[0,c=l/2]),(c-o(i)*n)*n):0;return j.useEffect(()=>{if(p)return u.thumbs.add(p),()=>{u.thumbs.delete(p)}},[p,u.thumbs]),(0,t.jsxs)("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[g.startEdge]:`calc(${N}% + ${A}px)`},children:[(0,t.jsx)(tr.ItemSlot,{scope:e.__scopeSlider,children:(0,t.jsx)(H.Primitive.span,{role:"slider","aria-label":e["aria-label"]||C,"aria-valuemin":u.min,"aria-valuenow":w,"aria-valuemax":u.max,"aria-orientation":u.orientation,"data-orientation":u.orientation,"data-disabled":u.disabled?"":void 0,tabIndex:u.disabled?void 0:0,...h,ref:v,style:void 0===w?{display:"none"}:e.style,onFocus:(0,E.composeEventHandlers)(e.onFocus,()=>{u.valueIndexToChangeRef.current=m})})}),y&&(0,t.jsx)(tC,{name:x??(u.name?u.name+(u.values.length>1?"[]":""):void 0),form:u.form,value:w},m)]})});tw.displayName=tb;var tC=j.forwardRef(({__scopeSlider:e,value:s,...a},r)=>{let l=j.useRef(null),i=(0,P.useComposedRefs)(l,r),n=(0,z.usePrevious)(s);return j.useEffect(()=>{let e=l.current;if(!e)return;let t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value").set;if(n!==s&&t){let a=new Event("input",{bubbles:!0});t.call(e,s),e.dispatchEvent(a)}},[n,s]),(0,t.jsx)(H.Primitive.input,{style:{display:"none"},...a,ref:i,defaultValue:s})});function tS(e,t,s){return A(100/(s-t)*(e-t),[0,100])}function tA(e,t){return s=>{if(e[0]===e[1]||t[0]===t[1])return t[0];let a=(t[1]-t[0])/(e[1]-e[0]);return t[0]+a*(s-e[0])}}tC.displayName="RadioBubbleInput";let tE=j.forwardRef(({className:e,...s},a)=>(0,t.jsxs)(tm,{ref:a,className:(0,eL.cn)("relative flex w-full touch-none select-none items-center",e),...s,children:[(0,t.jsx)(tj,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-gray-200",children:(0,t.jsx)(ty,{className:"absolute h-full bg-[#18A36C]"})}),(0,t.jsx)(tw,{className:"block h-5 w-5 rounded-full border-2 border-[#18A36C] bg-white ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[#18A36C] focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 cursor-grab active:cursor-grabbing"})]}));tE.displayName=tm.displayName;let tk=(0,i.default)("zoom-in",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),tP=(0,i.default)("zoom-out",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),tD=(0,i.default)("rotate-cw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);var tR=e.i(69074);function tT({isOpen:e,onClose:s,onSave:a,imageFile:r}){let l=(0,j.useRef)(null),i=(0,j.useRef)(null),[n,c]=(0,j.useState)(null),[o,d]=(0,j.useState)(1),[m,x]=(0,j.useState)(0),[h,g]=(0,j.useState)({x:0,y:0}),[p,v]=(0,j.useState)(!1),[y,b]=(0,j.useState)({x:0,y:0}),[w,N]=(0,j.useState)(!1);(0,j.useEffect)(()=>{if(r){let e=URL.createObjectURL(r);c(e),d(1),x(0),g({x:0,y:0});let t=new Image;return t.onload=()=>{i.current=t,C()},t.src=e,()=>URL.revokeObjectURL(e)}},[r]),(0,j.useEffect)(()=>{i.current&&C()},[o,m,h]);let C=(0,j.useCallback)(()=>{let e,t,s=l.current,a=s?.getContext("2d"),r=i.current;if(!s||!a||!r)return;a.fillStyle="#f3f4f6",a.fillRect(0,0,s.width,s.height),a.save(),a.beginPath(),a.arc(s.width/2,s.height/2,100,0,2*Math.PI),a.clip(),a.translate(s.width/2+h.x,s.height/2+h.y),a.rotate(m*Math.PI/180),a.scale(o,o);let n=r.width/r.height;n>1?(t=200,e=200*n):(e=200,t=200/n),a.drawImage(r,-e/2,-t/2,e,t),a.restore(),a.strokeStyle="#18A36C",a.lineWidth=3,a.beginPath(),a.arc(s.width/2,s.height/2,100,0,2*Math.PI),a.stroke(),a.strokeStyle="#e5e7eb",a.lineWidth=1,a.beginPath(),a.arc(s.width/2,s.height/2,104,0,2*Math.PI),a.stroke()},[o,m,h,200]),S=()=>{v(!1)},A=async()=>{let e,t,s=l.current,r=i.current;if(!s||!r)return;N(!0);let n=document.createElement("canvas");n.width=200,n.height=200;let c=n.getContext("2d");if(!c)return void N(!1);c.beginPath(),c.arc(100,100,100,0,2*Math.PI),c.closePath(),c.clip(),c.translate(100+h.x,100+h.y),c.rotate(m*Math.PI/180),c.scale(o,o);let d=r.width/r.height;d>1?(t=200,e=200*d):(e=200,t=200/d),c.drawImage(r,-e/2,-t/2,e,t),n.toBlob(e=>{e&&a(e),N(!1)},"image/png",1)};return(0,t.jsx)(f.Dialog,{open:e,onOpenChange:s,children:(0,t.jsxs)(f.DialogContent,{className:"sm:max-w-lg",children:[(0,t.jsxs)(f.DialogHeader,{children:[(0,t.jsx)(f.DialogTitle,{className:"text-xl text-[#2E2E2E]",children:"Настройка аватара"}),(0,t.jsx)(f.DialogDescription,{className:"text-gray-600",children:"Перетащите изображение для позиционирования и используйте ползунок для масштабирования"})]}),(0,t.jsx)("div",{className:"flex flex-col items-center gap-4 py-4",children:n&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("canvas",{ref:l,width:300,height:300,className:"border border-gray-200 rounded-lg cursor-move bg-gray-100",onMouseDown:e=>{v(!0),b({x:e.clientX-h.x,y:e.clientY-h.y})},onMouseMove:e=>{p&&g({x:e.clientX-y.x,y:e.clientY-y.y})},onMouseUp:S,onMouseLeave:S}),(0,t.jsxs)("div",{className:"w-full space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(tP,{className:"w-4 h-4 text-gray-500"}),(0,t.jsx)(tE,{value:[o],min:.5,max:3,step:.1,onValueChange:e=>d(e[0]),className:"flex-1"}),(0,t.jsx)(tk,{className:"w-4 h-4 text-gray-500"})]}),(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsxs)(u.Button,{variant:"outline",size:"sm",onClick:()=>{x(e=>(e+90)%360)},className:"border-gray-300",children:[(0,t.jsx)(tD,{className:"w-4 h-4 mr-2"}),"Повернуть"]})})]})]})}),(0,t.jsxs)(f.DialogFooter,{className:"flex flex-col sm:flex-row gap-3 sm:gap-2",children:[(0,t.jsx)(u.Button,{variant:"outline",onClick:s,className:"w-full sm:w-auto border-gray-300",children:"Отмена"}),(0,t.jsx)(u.Button,{onClick:A,disabled:w||!n,className:"w-full sm:w-auto bg-[#18A36C] hover:bg-[#18A36C]/90 text-white",children:w?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),"Сохранение..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(tR.Upload,{className:"w-4 h-4 mr-2"}),"Сохранить"]})})]})]})})}function tM({isOpen:e,onClose:r,user:l,onProfileUpdate:i}){let n=(0,e4.useAlert)(),c=(0,j.useRef)(null),[m,x]=(0,j.useState)({name:"",email:"",phone:"",login:""}),[h,g]=(0,j.useState)(null),[p,f]=(0,j.useState)(!1),[v,y]=(0,j.useState)(!1),[b,w]=(0,j.useState)(!1),[S,A]=(0,j.useState)(!1),[E,k]=(0,j.useState)(null);(0,j.useEffect)(()=>{l&&e&&(x({name:l.name||"",email:l.email||"",phone:l.phone||"",login:l.login||""}),g(l.avatar_url||null))},[l,e]);let P=(e,t)=>{x(s=>({...s,[e]:t}))},D=async e=>{w(!1),y(!0);try{let t=new FormData;t.append("avatar",e,"avatar.png");let s=await fetch("/api/auth/avatar",{method:"POST",body:t}),a=await s.json();s.ok?(g(a.avatar_url),n.success("Аватар успешно загружен","Успех")):n.error(a.error||"Ошибка при загрузке аватара","Ошибка")}catch(e){n.error("Произошла ошибка при загрузке аватара","Ошибка")}finally{y(!1),k(null)}},R=async()=>{y(!0);try{let e=await fetch("/api/auth/avatar",{method:"DELETE"});if(e.ok)g(null),n.success("Аватар успешно удален","Успех");else{let t=await e.json();n.error(t.error||"Ошибка при удалении аватара","Ошибка")}}catch(e){n.error("Произошла ошибка при удалении аватара","Ошибка")}finally{y(!1)}},T=async()=>{f(!0);try{let e=await fetch("/api/auth/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)}),t=await e.json();e.ok?(n.success("Профиль успешно обновлен","Успех"),i(t.user),r()):n.error(t.error||"Ошибка при обновлении профиля","Ошибка")}catch(e){n.error("Произошла ошибка при обновлении профиля","Ошибка")}finally{f(!1)}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e0.AnimatePresence,{children:e&&(0,t.jsxs)("div",{className:"fixed inset-0 z-[110] flex items-center justify-center p-4",children:[(0,t.jsx)(s.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r,className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),(0,t.jsxs)(s.motion.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.2},className:"relative w-full max-w-lg bg-white rounded-2xl shadow-2xl overflow-hidden max-h-[90vh] flex flex-col",children:[(0,t.jsx)("div",{className:"bg-[#18A36C] px-6 py-4 flex-shrink-0",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Редактирование профиля"}),(0,t.jsx)("button",{onClick:r,disabled:p,className:"p-1.5 hover:bg-white/20 rounded-lg cursor-pointer transition-colors disabled:opacity-50",children:(0,t.jsx)(e3.X,{className:"w-5 h-5 text-white"})})]})}),(0,t.jsxs)("div",{className:"p-6 overflow-y-auto flex-1",children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"w-24 h-24 aspect-square rounded-full bg-[#18A36C] flex items-center justify-center overflow-hidden border-4 border-gray-100 shadow-lg flex-shrink-0",children:h?(0,t.jsx)("img",{src:h,alt:"Avatar",className:"w-full h-full object-cover rounded-full"}):(0,t.jsx)("span",{className:"text-3xl text-white font-medium",children:(()=>{if(!m.name)return"U";let e=m.name.trim().split(" ").filter(e=>e.length>0);return e.length>=2?`${e[1][0]}${e[0][0]}`.toUpperCase():e[0]?.[0]?.toUpperCase()||"U"})()})}),v&&(0,t.jsx)("div",{className:"absolute inset-0 bg-black/50 rounded-full flex items-center justify-center",children:(0,t.jsx)(eW.Loader2,{className:"w-6 h-6 text-white animate-spin"})})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{ref:c,type:"file",accept:"image/jpeg,image/png,image/gif,image/webp",className:"hidden",onChange:e=>{let t=e.target.files?.[0];if(t){if(!["image/jpeg","image/png","image/gif","image/webp"].includes(t.type))return void n.error("Недопустимый формат файла. Разрешены: JPEG, PNG, GIF, WebP","Ошибка");if(t.size>5242880)return void n.error("Размер файла не должен превышать 5MB","Ошибка");k(t),w(!0)}c.current&&(c.current.value="")}}),(0,t.jsxs)(u.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>c.current?.click(),disabled:v,className:"border-[#18A36C] text-[#18A36C]",children:[(0,t.jsx)(e8,{className:"w-4 h-4 mr-2"}),"Загрузить фото"]}),h&&(0,t.jsx)(u.Button,{type:"button",variant:"outline",size:"sm",onClick:R,disabled:v,className:"border-red-300 text-red-600 hover:bg-red-50",children:(0,t.jsx)(e5.Trash2,{className:"w-4 h-4"})})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(C.Label,{htmlFor:"name",className:"text-gray-700 flex items-center gap-2",children:[(0,t.jsx)(a.User,{className:"w-4 h-4 text-[#18A36C]"}),"ФИО"]}),(0,t.jsx)(N.Input,{id:"name",value:m.name,onChange:e=>P("name",e.target.value),placeholder:"Иванов Иван Иванович",className:"border-gray-300"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(C.Label,{htmlFor:"login",className:"text-gray-700 flex items-center gap-2",children:[(0,t.jsx)(eO,{className:"w-4 h-4 text-[#18A36C]"}),"Логин"]}),(0,t.jsx)(N.Input,{id:"login",value:m.login,onChange:e=>P("login",e.target.value),placeholder:"Ваш логин",className:"border-gray-300"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(C.Label,{htmlFor:"email",className:"text-gray-700 flex items-center gap-2",children:[(0,t.jsx)(d.Mail,{className:"w-4 h-4 text-gray-400"}),"Email",(0,t.jsx)("span",{className:"text-xs text-gray-400",children:"(нельзя изменить)"})]}),(0,t.jsx)(N.Input,{id:"email",type:"email",value:m.email,disabled:!0,className:"border-gray-200 bg-gray-50 text-gray-500 cursor-not-allowed"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(C.Label,{htmlFor:"phone",className:"text-gray-700 flex items-center gap-2",children:[(0,t.jsx)(o.Phone,{className:"w-4 h-4 text-gray-400"}),"Телефон",(0,t.jsx)("span",{className:"text-xs text-gray-400",children:"(нельзя изменить)"})]}),(0,t.jsx)(N.Input,{id:"phone",type:"tel",value:m.phone,disabled:!0,className:"border-gray-200 bg-gray-50 text-gray-500 cursor-not-allowed"})]})]}),(0,t.jsx)("div",{className:"pt-2 border-t border-gray-200",children:(0,t.jsxs)(u.Button,{type:"button",variant:"outline",onClick:()=>A(!0),className:"w-full border-gray-300 text-gray-700 hover:bg-gray-50",children:[(0,t.jsx)(eU.Lock,{className:"w-4 h-4 mr-2"}),"Сменить пароль"]})})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 mt-6 pt-6 border-t border-gray-200",children:[(0,t.jsx)(u.Button,{variant:"outline",onClick:r,className:"w-full sm:w-auto border-gray-300",children:"Отмена"}),(0,t.jsx)(u.Button,{onClick:T,disabled:p,className:"w-full sm:w-auto bg-[#18A36C] hover:bg-[#18A36C]/90 text-white",children:p?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eW.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Сохранение..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e9.Save,{className:"w-4 h-4 mr-2"}),"Сохранить"]})})]})]})]})]})}),(0,t.jsx)(tT,{isOpen:b,onClose:()=>{w(!1),k(null)},onSave:D,imageFile:E}),(0,t.jsx)(e6,{isOpen:S,onClose:()=>A(!1)})]})}var tL=e.i(83086);function tI(e){if(!e)return!1;let t=new Date(e),s=new Date;return s.setMonth(s.getMonth()-1),t>s}function t_({isOpen:e,onClose:a,material:r}){let l=!!r&&tI(r.dateRaw);return(0,t.jsx)(e0.AnimatePresence,{children:e&&r&&(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,t.jsx)(s.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:a,className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),(0,t.jsxs)(s.motion.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.2,ease:"easeOut"},className:"relative w-full max-w-2xl max-h-[90vh] overflow-y-auto bg-white rounded-2xl shadow-2xl",children:[(0,t.jsx)("button",{onClick:a,className:"absolute top-6 right-6 w-12 h-12 flex items-center justify-center rounded-xl bg-gray-100 hover:bg-gray-200 text-gray-600 hover:text-gray-800 transition-all duration-200 hover:scale-110 z-10",children:(0,t.jsx)(e3.X,{className:"w-6 h-6"})}),(0,t.jsx)("div",{className:"bg-gradient-to-r from-[#18A36C]/5 via-[#18A36C]/10 to-[#18A36C]/5 p-8 border-b border-gray-100",children:(0,t.jsx)("div",{className:"flex items-start gap-3",children:(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-[#2E2E2E] mb-2",children:r.title}),l&&(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-gradient-to-r from-[#18A36C] to-[#15905f] text-white text-xs font-medium rounded-full",children:[(0,t.jsx)(tL.Sparkles,{className:"w-3 h-3"}),"Новое"]})})]})})}),(0,t.jsxs)("div",{className:"p-8 space-y-6",children:[(0,t.jsx)(s.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"relative h-96 rounded-xl overflow-hidden shadow-md",children:(0,t.jsx)(eZ.ImageWithFallback,{src:r.image,alt:r.title,className:"w-full h-full object-cover"})}),(0,t.jsxs)(s.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.15},children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold text-[#2E2E2E] mb-3 flex items-center gap-2",children:[(0,t.jsx)("span",{className:"w-1 h-6 bg-gradient-to-b from-[#18A36C] to-[#15905f] rounded-full"}),"О материале"]}),(0,t.jsx)("p",{className:"text-gray-700 leading-relaxed",children:r.content})]}),r.detailed_content&&(0,t.jsxs)(s.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-gradient-to-br from-gray-50 to-white p-6 rounded-xl border border-gray-100",children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold text-[#2E2E2E] mb-3 flex items-center gap-2",children:[(0,t.jsx)("span",{className:"w-1 h-6 bg-gradient-to-b from-[#18A36C] to-[#15905f] rounded-full"}),"Подробная информация"]}),(0,t.jsx)("p",{className:"text-gray-700 leading-relaxed whitespace-pre-wrap",children:r.detailed_content})]}),(0,t.jsxs)(s.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.25},children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold text-[#2E2E2E] mb-3 flex items-center gap-2",children:[(0,t.jsx)("span",{className:"w-1 h-6 bg-gradient-to-b from-[#18A36C] to-[#15905f] rounded-full"}),"Дополнительно"]}),(0,t.jsx)("div",{className:"space-y-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-3 text-gray-700 bg-gradient-to-br from-[#18A36C]/5 to-transparent p-4 rounded-xl border border-[#18A36C]/10",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-[#18A36C] to-[#15905f] rounded-xl flex items-center justify-center shadow-md",children:(0,t.jsx)(eH,{className:"w-6 h-6 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Дата публикации"}),(0,t.jsx)("div",{className:"font-semibold text-[#2E2E2E]",children:r.date})]})]})})]})]})]})]})})}var tH=e.i(18050),tB=e.i(47865);function tF({className:e=""}){return(0,t.jsx)("div",{className:`animate-pulse bg-gray-200 rounded ${e}`})}function tU(){return(0,t.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-8 lg:p-12 mb-12",children:(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row items-center gap-8",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row items-center lg:items-start gap-6",children:[(0,t.jsx)(tF,{className:"w-20 h-20 lg:w-24 lg:h-24 rounded-full"}),(0,t.jsxs)("div",{className:"text-center lg:text-left flex-1",children:[(0,t.jsx)(tF,{className:"h-10 w-64 mb-4 mx-auto lg:mx-0"}),(0,t.jsx)(tF,{className:"h-5 w-48 mx-auto lg:mx-0"})]})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200 w-24 h-24",children:[(0,t.jsx)(tF,{className:"h-8 w-8 mx-auto mb-2"}),(0,t.jsx)(tF,{className:"h-4 w-16 mx-auto"})]}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200 w-24 h-24",children:[(0,t.jsx)(tF,{className:"h-8 w-8 mx-auto mb-2"}),(0,t.jsx)(tF,{className:"h-4 w-16 mx-auto"})]})]})]})})}function tO(){return(0,t.jsxs)(w.Card,{className:"border border-gray-200 mb-12",children:[(0,t.jsx)(w.CardHeader,{className:"border-b border-gray-200 bg-gray-50",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(tF,{className:"w-12 h-12 rounded-lg"}),(0,t.jsxs)("div",{children:[(0,t.jsx)(tF,{className:"h-6 w-40 mb-2"}),(0,t.jsx)(tF,{className:"h-4 w-56"})]})]}),(0,t.jsx)(tF,{className:"h-10 w-40 rounded-md"})]})}),(0,t.jsx)(w.CardContent,{className:"p-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[[1,2,3,4].map(e=>(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(tF,{className:"h-4 w-20"}),(0,t.jsx)(tF,{className:"h-12 w-full rounded-lg"})]},e)),(0,t.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,t.jsx)(tF,{className:"h-4 w-24"}),(0,t.jsx)(tF,{className:"h-12 w-full rounded-lg"})]})]})})]})}function tz(){return(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-12",children:[1,2,3].map(e=>(0,t.jsx)(w.Card,{className:"border border-gray-200",children:(0,t.jsxs)(w.CardContent,{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,t.jsx)(tF,{className:"w-14 h-14 rounded-lg"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(tF,{className:"h-5 w-24 mb-2"}),(0,t.jsx)(tF,{className:"h-4 w-32"})]})]}),(0,t.jsx)(tF,{className:"h-4 w-36"})]})},e))})}function t$(){return(0,t.jsxs)(w.Card,{className:"border border-gray-200",children:[(0,t.jsx)(tF,{className:"w-full h-48 rounded-t-lg rounded-b-none"}),(0,t.jsxs)(w.CardContent,{className:"p-4",children:[(0,t.jsx)(tF,{className:"h-6 w-full mb-2"}),(0,t.jsx)(tF,{className:"h-4 w-full mb-1"}),(0,t.jsx)(tF,{className:"h-4 w-3/4 mb-3"}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(tF,{className:"h-4 w-24"}),(0,t.jsx)(tF,{className:"h-8 w-28 rounded-md"})]})]})]})}function tK(){return(0,t.jsxs)("div",{className:"mb-12",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsx)(tF,{className:"h-8 w-48"}),(0,t.jsx)(tF,{className:"h-10 w-32 rounded-md"})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(e=>(0,t.jsx)(t$,{},e))})]})}function tV(){return(0,t.jsx)(w.Card,{className:"border border-gray-200",children:(0,t.jsx)(w.CardContent,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row items-center justify-between gap-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(tF,{className:"w-16 h-16 rounded-full"}),(0,t.jsxs)("div",{children:[(0,t.jsx)(tF,{className:"h-6 w-40 mb-2"}),(0,t.jsx)(tF,{className:"h-4 w-48 mb-1"}),(0,t.jsx)(tF,{className:"h-4 w-32"})]})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,t.jsx)(tF,{className:"h-10 w-44 rounded-md"}),(0,t.jsx)(tF,{className:"h-10 w-36 rounded-md"}),(0,t.jsx)(tF,{className:"h-10 w-24 rounded-md"})]})]})})})}function tW(){return(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 lg:px-8 py-8",children:[(0,t.jsx)(tU,{}),(0,t.jsx)(tO,{}),(0,t.jsx)(tz,{}),(0,t.jsx)(tK,{}),(0,t.jsx)(tV,{})]})}function tX(){return(0,t.jsxs)("div",{className:"p-4 lg:p-8 max-w-7xl mx-auto space-y-6",children:[(0,t.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,t.jsx)(tF,{className:"w-12 h-12 rounded-lg"}),(0,t.jsxs)("div",{children:[(0,t.jsx)(tF,{className:"h-6 w-32 mb-2"}),(0,t.jsx)(tF,{className:"h-4 w-56"})]})]})}),(0,t.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,t.jsx)(tF,{className:"h-4 w-16"}),(0,t.jsx)(tF,{className:"h-10 w-48 rounded-md"})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(e=>(0,t.jsx)(t$,{},e))})]})}function tq(){return(0,t.jsxs)("div",{className:"p-4 lg:p-8 max-w-7xl mx-auto space-y-6",children:[(0,t.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,t.jsx)(tF,{className:"w-12 h-12 rounded-lg"}),(0,t.jsxs)("div",{children:[(0,t.jsx)(tF,{className:"h-6 w-44 mb-2"}),(0,t.jsx)(tF,{className:"h-4 w-48"})]})]})}),(0,t.jsx)(w.Card,{className:"border border-gray-200",children:(0,t.jsxs)(w.CardContent,{className:"p-6 space-y-6",children:[(0,t.jsx)(tF,{className:"h-16 w-full rounded-lg"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(tF,{className:"h-4 w-24"}),(0,t.jsx)(tF,{className:"h-10 w-full rounded-md"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(tF,{className:"h-4 w-16"}),(0,t.jsx)(tF,{className:"h-10 w-full rounded-md"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(tF,{className:"h-4 w-24"}),(0,t.jsx)(tF,{className:"h-32 w-full rounded-md"})]})]}),(0,t.jsx)(tF,{className:"h-10 w-32 rounded-md"})]})})]})}function tY(){let{navigate:s,currentRoute:r}=(0,eQ.useRouter)(),{data:i,status:n}=(0,v.useSession)(),h=(0,e4.useAlert)(),[g,p]=(0,j.useState)(null),[y,b]=(0,j.useState)(!0),[S,A]=(0,j.useState)(!1),[E,k]=(0,j.useState)(!1),[P,D]=(0,j.useState)(!1),[R,T]=(0,j.useState)(!1),[M,L]=(0,j.useState)(null),[I,_]=(0,j.useState)([]),[H,B]=(0,j.useState)(0),[F,U]=(0,j.useState)(!1),O=r.replace(/^\/+|\/+$/g,"").split("/"),z="";"account"===O[0]&&(z=O[1]||"");let[$,K]=(0,j.useState)(z&&["materials","contact"].includes(z)?z:""),[V,W]=(0,j.useState)(eY),{currentPage:X,setPage:q}=(0,tB.useUrlPagination)(6),[Y,G]=(0,j.useState)(eJ),[J,Z]=(0,j.useState)("idle"),[Q,ee]=(0,j.useState)([]),[et,es]=(0,j.useState)(!1),[ea,er]=(0,j.useState)(!1),[el,ei]=(0,j.useState)(null),[en,ec]=(0,j.useState)({}),[eo,ed]=(0,j.useState)(""),[em,ex]=(0,j.useState)(!1),eh=(e,t)=>{if("subject"===e||Y.subject,"content"===e||Y.message,"subject"===e){if(!t||t.trim().length<3)return ec(e=>({...e,subject:"Тема должна содержать минимум 3 символа"})),!1;else if(t.length>200)return ec(e=>({...e,subject:"Тема не должна превышать 200 символов"})),!1}else if("content"===e){if(!t||t.trim().length<10)return ec(e=>({...e,content:"Сообщение должно содержать минимум 10 символов"})),!1;else if(t.length>5e3)return ec(e=>({...e,content:"Сообщение не должно превышать 5000 символов"})),!1}return ec(t=>{let s={...t};return delete s[e],s}),!0},eu=async()=>{es(!0);try{let e=await fetch("/api/letters");if(e.ok){let t=await e.json();ee(t)}}catch(e){}finally{es(!1)}};(0,j.useEffect)(()=>{"contact"===$&&i&&eu()},[$,i]);let eg=async t=>{try{await fetch(`/api/letters/${t}`,{method:"PATCH"}),ee(e=>e.map(e=>e.id===t?{...e,is_reply_read:!0}:e));let{clearLetterNotification:s}=await e.A(92930);s(t)}catch(e){}},ep=async e=>{if(!eo.trim()||eo.trim().length<10)return void h.error("Сообщение должно содержать минимум 10 символов","Ошибка");ex(!0);try{let t=await fetch(`/api/letters/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:eo})});if(t.ok)h.success("Сообщение отправлено","Успех"),ed(""),await eu();else{let e=await t.json();h.error(e.error||"Ошибка при отправке сообщения","Ошибка")}}catch(e){h.error("Ошибка при отправке сообщения","Ошибка")}finally{ex(!1)}};(0,j.useEffect)(()=>{g?.email&&W(e=>({...e,email:g.email}))},[g]),(0,j.useEffect)(()=>{(async()=>{U(!0);try{let e=new URLSearchParams({page:X.toString(),limit:"6"}),t=await fetch(`/api/materials?${e}`);if(t.ok){let e=await t.json();_(e.materials),B(e.pagination?.total||0),window.scrollTo({top:0,behavior:"smooth"})}else h.error("Не удалось загрузить материалы","Ошибка загрузки")}catch(e){h.error("Произошла ошибка при загрузке материалов","Ошибка")}finally{U(!1)}})()},[X,h]),(0,j.useEffect)(()=>{z&&["materials","contact"].includes(z)?K(z):K("")},[z]),(0,j.useEffect)(()=>{"authenticated"===n&&i?ef():"unauthenticated"===n&&b(!1)},[n,i]);let ef=async()=>{try{let e=await fetch("/api/auth/me");if(e.ok){let t=await e.json();p(t.user)}}catch(e){}finally{b(!1)}},ej=(()=>{if(g?.name&&g.name.trim()){let e=g.name.trim().split(" ").filter(e=>e.length>0),t=e[0]||"";return{firstName:e[1]||""||t,lastName:t,middleName:e[2]||"",fullName:g.name,name:g.name,email:g.email||"",avatarUrl:g.avatar_url||null}}if(g){let e=g.login||g.email||"Пользователь";return{firstName:e,lastName:"",middleName:"",fullName:e,name:e,email:g.email||"",avatarUrl:g.avatar_url||null}}return{firstName:"",lastName:"",middleName:"",fullName:"",name:"",email:"",avatarUrl:null}})(),ev=()=>ej.firstName&&ej.lastName?`${ej.firstName[0]}${ej.lastName[0]}`.toUpperCase():ej.firstName?ej.firstName[0].toUpperCase():ej.lastName?ej.lastName[0].toUpperCase():"U",ey=e=>{L(e),T(!0)},eb=async()=>{A(!1),await (0,v.signOut)({callbackUrl:"/",redirect:!0})},ew=async()=>{er(!0);try{let e=await fetch("/api/letters",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subject:Y.subject,content:Y.message})});if(e.ok)Z("success"),G({name:"",subject:"",message:""}),await eu(),h.success("Письмо успешно отправлено главному врачу","Отправлено"),setTimeout(()=>Z("idle"),3e3);else{let t=await e.json();h.error(t.error||"Ошибка при отправке письма","Ошибка"),Z("error")}}catch(e){h.error("Произошла ошибка при отправке письма","Ошибка"),Z("error")}finally{er(!1)}};return y?"materials"===$?(0,t.jsx)(tX,{}):"contact"===$?(0,t.jsx)(tq,{}):(0,t.jsx)(tW,{}):"materials"===$?(0,t.jsxs)("div",{className:"p-3 sm:p-4 lg:p-8 max-w-7xl mx-auto space-y-4 sm:space-y-6",children:[(0,t.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-4 sm:p-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-[#18A36C] rounded-lg flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(l.FileText,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg sm:text-xl text-gray-800",children:"Материалы"}),(0,t.jsx)("p",{className:"text-sm sm:text-base text-gray-600",children:"Полезные материалы и информация для пациентов"})]})]})}),F?(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:Array.from({length:6}).map((e,s)=>(0,t.jsxs)(w.Card,{className:"border border-gray-200",children:[(0,t.jsx)("div",{className:"w-full h-40 sm:h-48 bg-gray-200 animate-pulse rounded-t-lg"}),(0,t.jsxs)(w.CardContent,{className:"p-4 sm:p-6",children:[(0,t.jsx)("div",{className:"h-5 sm:h-6 bg-gray-200 rounded animate-pulse mb-2 w-3/4"}),(0,t.jsxs)("div",{className:"space-y-2 mb-3 sm:mb-4",children:[(0,t.jsx)("div",{className:"h-3 sm:h-4 bg-gray-200 rounded animate-pulse w-full"}),(0,t.jsx)("div",{className:"h-3 sm:h-4 bg-gray-200 rounded animate-pulse w-5/6"}),(0,t.jsx)("div",{className:"h-3 sm:h-4 bg-gray-200 rounded animate-pulse w-4/6"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-24"}),(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded animate-pulse w-24"})]})]})]},s))}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:I.map(e=>(0,t.jsxs)(w.Card,{className:"group hover:shadow-lg transition-all duration-300 border border-gray-200",children:[(0,t.jsxs)("div",{className:"relative overflow-hidden rounded-t-lg",children:[(0,t.jsx)(eZ.ImageWithFallback,{src:e.image,alt:e.title,className:"w-full h-40 sm:h-48 object-cover group-hover:scale-105 transition-transform duration-300"}),tI(e.dateRaw)&&(0,t.jsx)("div",{className:"absolute top-2 sm:top-4 left-2 sm:left-4 flex flex-wrap gap-1 sm:gap-2",children:(0,t.jsx)(e_.Badge,{className:"bg-orange-500 text-white text-xs",children:"Новое"})})]}),(0,t.jsxs)(w.CardContent,{className:"p-4 sm:p-6",children:[(0,t.jsx)("h3",{className:"text-base sm:text-lg text-gray-800 mb-2 group-hover:text-[#18A36C] transition-colors",children:e.title}),(0,t.jsx)("p",{className:"text-xs sm:text-sm text-gray-600 mb-3 sm:mb-4 line-clamp-3",children:e.content}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm text-gray-500",children:[(0,t.jsx)(eH,{className:"w-3 h-3 sm:w-4 sm:h-4"}),(0,t.jsx)("span",{children:e.date})]}),(0,t.jsxs)(u.Button,{variant:"ghost",size:"sm",onClick:()=>ey(e),className:"text-[#18A36C] hover:text-[#18A36C]/80 hover:bg-[#18A36C]/10 text-xs sm:text-sm px-2 sm:px-3",children:[(0,t.jsx)(e$.Eye,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1"}),"Подробнее"]})]})]})]},e.id))}),H>6&&(0,t.jsx)(tH.Pagination,{currentPage:X,totalPages:Math.ceil(H/6),onPageChange:q,className:"mt-8"})]}),!F&&0===I.length&&(0,t.jsxs)("div",{className:"text-center py-12 sm:py-16 bg-gradient-to-br from-gray-50 to-white rounded-2xl border border-gray-200",children:[(0,t.jsx)("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(l.FileText,{className:"w-8 h-8 sm:w-10 sm:h-10 text-gray-400"})}),(0,t.jsx)("h3",{className:"text-lg sm:text-xl text-gray-800 mb-2",children:0===I.length?"Материалы отсутствуют":"Материалы не найдены"}),(0,t.jsx)("p",{className:"text-sm sm:text-base text-gray-600 max-w-md mx-auto",children:0===I.length?"В данный момент нет доступных материалов. Они появятся здесь, как только будут опубликованы.":"В выбранном периоде нет доступных материалов. Попробуйте выбрать другой период."})]}),(0,t.jsx)(t_,{isOpen:R,onClose:()=>{T(!1),L(null)},material:M})]}):"contact"===$?(0,t.jsxs)("div",{className:"p-3 sm:p-4 lg:p-8 max-w-7xl mx-auto space-y-4 sm:space-y-6",children:[(0,t.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-4 sm:p-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-[#18A36C] rounded-lg flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(eB.MessageSquare,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg sm:text-xl text-gray-800",children:"Написать глав.врачу"}),(0,t.jsx)("p",{className:"text-sm sm:text-base text-gray-600",children:"Свяжитесь с руководством клиники"})]})]})}),g?.is_messages_blocked&&(0,t.jsx)(w.Card,{className:"border border-red-200 bg-red-50",children:(0,t.jsx)(w.CardContent,{className:"p-4 sm:p-6",children:(0,t.jsxs)("div",{className:"flex items-start sm:items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(eq.Ban,{className:"w-5 h-5 sm:w-6 sm:h-6 text-red-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-red-800 font-medium text-sm sm:text-base",children:"Отправка сообщений заблокирована"}),(0,t.jsx)("p",{className:"text-red-600 text-xs sm:text-sm",children:"Вы не можете отправлять письма главному врачу. Если вы считаете, что это ошибка, обратитесь в клинику по телефону."})]})]})})}),!g?.is_messages_blocked&&(0,t.jsx)(w.Card,{className:"border border-gray-200",children:(0,t.jsxs)(w.CardContent,{className:"p-6 space-y-6",children:[(0,t.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,t.jsx)("p",{className:"text-sm text-gray-600",children:eG})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(C.Label,{htmlFor:"subject",className:"text-gray-700",children:["Тема письма ",(0,t.jsx)("span",{className:"text-gray-400 text-xs",children:"(мин. 3 символа)"})]}),(0,t.jsx)(N.Input,{id:"subject",type:"text",placeholder:"Тема сообщения",value:Y.subject,onChange:e=>G({...Y,subject:e.target.value}),onBlur:()=>eh("subject",Y.subject),className:`border-gray-300 ${en.subject?"border-red-500":""}`}),en.subject&&(0,t.jsx)("p",{className:"text-red-500 text-xs",children:en.subject})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(C.Label,{htmlFor:"message",className:"text-gray-700",children:["Сообщение ",(0,t.jsx)("span",{className:"text-gray-400 text-xs",children:"(мин. 10 символов)"})]}),(0,t.jsx)(eI,{id:"message",placeholder:"Ваше сообщение главному врачу...",rows:6,value:Y.message,onChange:e=>G({...Y,message:e.target.value}),onBlur:()=>eh("content",Y.message),className:`border-gray-200 focus:border-[#18A36C] focus:ring-[#18A36C] focus:border-1${en.content?"border-red-500":""}`}),en.content&&(0,t.jsx)("p",{className:"text-red-500 text-xs",children:en.content}),(0,t.jsxs)("p",{className:"text-xs text-gray-400 text-right",children:[Y.message.length,"/5000"]})]})]}),(0,t.jsx)(u.Button,{onClick:ew,className:"bg-[#18A36C] hover:bg-[#18A36C]/90 text-white cursor-pointer",disabled:ea||!Y.subject||!Y.message||Y.subject.trim().length<3||Y.message.trim().length<10||Object.keys(en).length>0,children:ea?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eW.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Отправка..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eV.Send,{className:"w-4 h-4 mr-2"}),"Отправить письмо"]})}),"success"===J&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-green-600 bg-green-50 p-3 rounded-lg",children:[(0,t.jsx)(x.CheckCircle,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"text-sm",children:"Письмо успешно отправлено!"})]})]})}),(0,t.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,t.jsxs)("h3",{className:"text-base sm:text-lg text-gray-800 font-medium flex flex-wrap items-center gap-2",children:[(0,t.jsx)(d.Mail,{className:"w-4 h-4 sm:w-5 sm:h-5 text-[#18A36C]"}),"Мои письма",Q.filter(e=>e.reply&&!e.is_reply_read).length>0&&(0,t.jsxs)("span",{className:"px-2 py-0.5 bg-red-500 text-white text-xs rounded-full",children:[Q.filter(e=>e.reply&&!e.is_reply_read).length," новых"]})]}),et?(0,t.jsxs)("div",{className:"text-center py-6 sm:py-8",children:[(0,t.jsx)(eW.Loader2,{className:"w-6 h-6 sm:w-8 sm:h-8 animate-spin text-[#18A36C] mx-auto"}),(0,t.jsx)("p",{className:"text-gray-600 mt-2 text-sm sm:text-base",children:"Загрузка писем..."})]}):0===Q.length?(0,t.jsx)(w.Card,{className:"border border-gray-200",children:(0,t.jsxs)(w.CardContent,{className:"p-6 sm:p-8 text-center",children:[(0,t.jsx)(d.Mail,{className:"w-10 h-10 sm:w-12 sm:h-12 text-gray-300 mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-gray-500 text-sm sm:text-base",children:"У вас пока нет отправленных писем"})]})}):(0,t.jsx)("div",{className:"space-y-2 sm:space-y-3",children:Q.map(e=>(0,t.jsx)(w.Card,{className:`border transition-all duration-200 ${e.reply&&!e.is_reply_read?"border-[#18A36C] bg-[#18A36C]/5":"border-gray-200"}`,children:(0,t.jsxs)(w.CardContent,{className:"p-3 sm:p-4",children:[(0,t.jsxs)("div",{className:"flex items-start sm:items-center justify-between cursor-pointer gap-2",onClick:()=>{el===e.id?ei(null):(ei(e.id),e.reply&&!e.is_reply_read&&eg(e.id))},children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-1 sm:gap-2 mb-1",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800 text-sm sm:text-base truncate max-w-[150px] sm:max-w-none",children:e.subject}),e.reply?(0,t.jsx)(e_.Badge,{className:"bg-[#18A36C] text-white text-xs",children:"Ответ"}):(0,t.jsxs)(e_.Badge,{className:"bg-amber-500 text-white text-xs flex items-center gap-1",children:[(0,t.jsx)(m.Clock,{className:"w-3 h-3"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Ожидает"})]}),e.reply&&!e.is_reply_read&&(0,t.jsx)("span",{className:"w-2 h-2 bg-red-500 rounded-full flex-shrink-0"})]}),(0,t.jsx)("p",{className:"text-xs sm:text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString("ru-RU",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})})]}),(0,t.jsx)(u.Button,{variant:"ghost",size:"sm",className:"p-1 sm:p-2 flex-shrink-0",children:el===e.id?(0,t.jsx)(eM,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400"}):(0,t.jsx)(eX.ChevronDown,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400"})})]}),el===e.id&&(0,t.jsxs)("div",{className:"mt-3 sm:mt-4 pt-3 sm:pt-4 border-t border-gray-100 space-y-3 sm:space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-gray-500 mb-1 sm:mb-2 font-medium",children:"Ваше письмо:"}),(0,t.jsx)("div",{className:"bg-gray-50 rounded-lg p-2 sm:p-3",children:(0,t.jsx)("p",{className:"text-xs sm:text-sm text-gray-700 whitespace-pre-wrap",children:e.content})}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:new Date(e.created_at).toLocaleDateString("ru-RU",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]}),e.reply&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-xs text-[#18A36C] mb-1 sm:mb-2 font-medium flex items-center gap-1",children:[(0,t.jsx)(x.CheckCircle,{className:"w-3 h-3"}),"Ответ главного врача"]}),(0,t.jsx)("div",{className:"bg-[#18A36C]/10 rounded-lg p-2 sm:p-3 border border-[#18A36C]/20",children:(0,t.jsx)("p",{className:"text-xs sm:text-sm text-gray-700 whitespace-pre-wrap",children:e.reply})}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:e.replied_at&&new Date(e.replied_at).toLocaleDateString("ru-RU",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]}),e.messages&&e.messages.map(e=>(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:`text-xs mb-1 sm:mb-2 font-medium flex items-center gap-1 ${"chief_doctor"===e.sender_type?"text-[#18A36C]":"text-gray-500"}`,children:"chief_doctor"===e.sender_type?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.CheckCircle,{className:"w-3 h-3"}),"Ответ главного врача"]}):"Ваше сообщение"}),(0,t.jsx)("div",{className:`rounded-lg p-2 sm:p-3 ${"chief_doctor"===e.sender_type?"bg-[#18A36C]/10 border border-[#18A36C]/20":"bg-gray-50"}`,children:(0,t.jsx)("p",{className:"text-xs sm:text-sm text-gray-700 whitespace-pre-wrap",children:e.content})}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:new Date(e.created_at).toLocaleDateString("ru-RU",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]},e.id)),e.reply&&!g?.is_messages_blocked&&(0,t.jsxs)("div",{className:"pt-3 sm:pt-4 border-t border-gray-200",children:[(0,t.jsx)("p",{className:"text-xs text-gray-500 mb-1 sm:mb-2 font-medium",children:"Продолжить переписку:"}),(0,t.jsx)(eI,{value:eo,onChange:e=>ed(e.target.value),placeholder:"Напишите ваш ответ...",className:"min-h-[70px] sm:min-h-[80px] text-xs sm:text-sm border-gray-200 focus:border-[#18A36C] focus:ring-[#18A36C] focus:border-1"}),(0,t.jsx)("div",{className:"flex justify-end mt-2",children:(0,t.jsx)(u.Button,{onClick:()=>ep(e.id),disabled:em||!eo.trim(),className:"bg-[#18A36C] hover:bg-[#18A36C]/90 text-white w-full sm:w-auto text-sm",children:em?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eW.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Отправка..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eV.Send,{className:"w-4 h-4 mr-2"}),"Отправить"]})})})]}),e.reply&&g?.is_messages_blocked&&(0,t.jsx)("div",{className:"pt-3 sm:pt-4 border-t border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 text-red-600 bg-red-50 p-2 sm:p-3 rounded-lg",children:[(0,t.jsx)(eq.Ban,{className:"w-4 h-4 flex-shrink-0"}),(0,t.jsx)("span",{className:"text-xs sm:text-sm",children:"Отправка сообщений заблокирована"})]})})]})]})},e.id))})]})]}):(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 lg:px-8 py-4 sm:py-8",children:[(0,t.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-4 sm:p-8 lg:p-12 mb-6 sm:mb-12",children:(0,t.jsx)("div",{className:"text-center lg:text-left",children:(0,t.jsx)("div",{className:"flex flex-col lg:flex-row items-center gap-8",children:(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row items-center lg:items-start gap-6",children:[(0,t.jsx)("div",{className:"w-20 h-20 lg:w-24 lg:h-24 aspect-square bg-[#18A36C] rounded-full flex items-center justify-center overflow-hidden border-4 border-gray-100 shadow-lg flex-shrink-0",children:ej.avatarUrl?(0,t.jsx)("img",{src:ej.avatarUrl,alt:"Avatar",className:"w-full h-full object-cover rounded-full"}):(0,t.jsx)("span",{className:"text-3xl text-white font-medium",children:ev()})}),(0,t.jsxs)("div",{className:"text-center lg:text-left",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-center lg:justify-start gap-2 sm:gap-3 mb-2",children:[(0,t.jsxs)("h1",{className:"text-xl sm:text-2xl lg:text-4xl text-gray-800",children:["Добро пожаловать, ",ej.firstName||"Пользователь","!"]}),g?.role==="ADMIN"&&(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 sm:px-3 py-1 bg-[#18A36C] text-white text-xs sm:text-sm rounded-full",children:[(0,t.jsx)(eK.Shield,{className:"w-3 h-3 sm:w-4 sm:h-4"}),"Админ"]})]}),(0,t.jsx)("p",{className:"text-gray-600 text-sm sm:text-base lg:text-lg",children:"Ваш персональный медицинский помощник"})]})]})})})})}),(0,t.jsx)("div",{className:"mb-12",children:(0,t.jsxs)(w.Card,{className:"border border-gray-200",children:[(0,t.jsx)(w.CardHeader,{className:"border-b border-gray-200 bg-gray-50 p-4 sm:p-6",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-[#18A36C] rounded-lg flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(a.User,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(w.CardTitle,{className:"text-lg sm:text-xl text-gray-800",children:"Информация профиля"}),(0,t.jsx)("p",{className:"text-xs sm:text-sm text-gray-600 mt-1 hidden sm:block",children:"Ваши личные данные и настройки безопасности"})]})]}),(0,t.jsxs)(u.Button,{onClick:()=>D(!0),variant:"outline",size:"sm",className:"border-[#18A36C] text-[#18A36C] w-full sm:w-auto hover:shadow-lg hover:shadow-[#18A36C]/20",children:[(0,t.jsx)(ez,{className:"w-4 h-4 mr-2"}),"Редактировать"]})]})}),(0,t.jsx)(w.CardContent,{className:"p-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(C.Label,{className:"text-gray-600 text-sm flex items-center gap-2",children:[(0,t.jsx)(eO,{className:"w-4 h-4 text-[#18A36C]"}),"Логин"]}),(0,t.jsx)("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:(0,t.jsx)("p",{className:"text-gray-800 font-medium",children:g?.login||"Не указан"})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(C.Label,{className:"text-gray-600 text-sm flex items-center gap-2",children:[(0,t.jsx)(d.Mail,{className:"w-4 h-4 text-[#18A36C]"}),"Email"]}),(0,t.jsx)("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:(0,t.jsx)("p",{className:"text-gray-800 font-medium",children:g?.email||"Не указан"})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(C.Label,{className:"text-gray-600 text-sm flex items-center gap-2",children:[(0,t.jsx)(o.Phone,{className:"w-4 h-4 text-[#18A36C]"}),"Телефон"]}),(0,t.jsx)("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:(0,t.jsx)("p",{className:"text-gray-800 font-medium",children:g?.phone||"Не указан"})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(C.Label,{className:"text-gray-600 text-sm flex items-center gap-2",children:[(0,t.jsx)(eH,{className:"w-4 h-4 text-[#18A36C]"}),"Дата регистрации"]}),(0,t.jsx)("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:(0,t.jsx)("p",{className:"text-gray-800 font-medium",children:g?.registration_date?new Date(g.registration_date).toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"}):"Не указана"})})]}),(0,t.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,t.jsxs)(C.Label,{className:"text-gray-600 text-sm flex items-center gap-2",children:[(0,t.jsx)(a.User,{className:"w-4 h-4 text-[#18A36C]"}),"Полное имя"]}),(0,t.jsx)("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:(0,t.jsx)("p",{className:"text-gray-800 font-medium",children:g?.name||"Не указано"})})]})]})})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6 mb-8 sm:mb-12",children:[(0,t.jsx)(w.Card,{className:"group cursor-pointer hover:shadow-xl transition-all duration-300 border border-gray-200 hover:border-[#18A36C]",onClick:()=>s("/account/materials"),children:(0,t.jsxs)(w.CardContent,{className:"p-4 sm:p-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 sm:gap-4 mb-3 sm:mb-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 sm:w-14 sm:h-14 bg-[#18A36C] rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform duration-300 flex-shrink-0",children:(0,t.jsx)(l.FileText,{className:"w-6 h-6 sm:w-7 sm:h-7 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-base sm:text-lg text-gray-800 mb-0.5 sm:mb-1",children:"Материалы"}),(0,t.jsx)("p",{className:"text-xs sm:text-sm text-gray-600",children:"Специальные предложения"})]})]}),(0,t.jsxs)("div",{className:"flex items-center text-xs sm:text-sm text-[#18A36C]",children:[(0,t.jsx)("span",{children:"Просмотреть материалы"}),(0,t.jsx)(eF.ChevronRight,{className:"w-4 h-4 ml-[2.5px] group-hover:translate-x-1 transition-transform"})]})]})}),(0,t.jsx)(w.Card,{className:"group cursor-pointer hover:shadow-xl transition-all duration-300 border border-gray-200 hover:border-[#18A36C]",onClick:()=>s("/account/contact"),children:(0,t.jsxs)(w.CardContent,{className:"p-4 sm:p-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 sm:gap-4 mb-3 sm:mb-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 sm:w-14 sm:h-14 bg-[#18A36C] rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform duration-300 flex-shrink-0",children:(0,t.jsx)(eB.MessageSquare,{className:"w-6 h-6 sm:w-7 sm:h-7 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-base sm:text-lg text-gray-800 mb-0.5 sm:mb-1",children:"Связаться с главным врачом"}),(0,t.jsx)("p",{className:"text-xs sm:text-sm text-gray-600",children:"Написать главврачу"})]})]}),(0,t.jsxs)("div",{className:"flex items-center text-xs sm:text-sm text-[#18A36C]",children:[(0,t.jsx)("span",{children:"Отправить сообщение"}),(0,t.jsx)(eF.ChevronRight,{className:"w-4 h-4 ml-[2.5px] group-hover:translate-x-1 transition-transform"})]})]})})]}),(0,t.jsxs)("div",{className:"mb-8 sm:mb-12",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 mb-4 sm:mb-6",children:[(0,t.jsx)("h2",{className:"text-lg sm:text-xl lg:text-2xl text-gray-800",children:"Последние материалы"}),I.length>0&&(0,t.jsxs)(u.Button,{variant:"outline",onClick:()=>s("/account/materials"),className:"text-[#18A36C] border-[#18A36C] hover:bg-[#18A36C] hover:text-white w-full sm:w-auto hover:shadow-lg hover:shadow-[#18A36C]/20",children:["Смотреть все",(0,t.jsx)(eF.ChevronRight,{className:"w-4 h-4 ml-[2.5px]"})]})]}),0===I.length?(0,t.jsxs)("div",{className:"text-center py-12 sm:py-16 bg-gradient-to-br from-gray-50 to-white rounded-2xl border border-gray-200",children:[(0,t.jsx)("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(l.FileText,{className:"w-8 h-8 sm:w-10 sm:h-10 text-gray-400"})}),(0,t.jsx)("h3",{className:"text-lg sm:text-xl text-gray-800 mb-2",children:"Материалы отсутствуют"}),(0,t.jsx)("p",{className:"text-sm sm:text-base text-gray-600 max-w-md mx-auto",children:"В данный момент нет доступных материалов. Они появятся здесь, как только будут опубликованы."})]}):(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:I.slice(0,3).map(e=>(0,t.jsxs)(w.Card,{className:"group hover:shadow-lg transition-all duration-300 border border-gray-200",children:[(0,t.jsxs)("div",{className:"relative overflow-hidden rounded-t-lg",children:[(0,t.jsx)(eZ.ImageWithFallback,{src:e.image,alt:e.title,className:"w-full h-40 sm:h-48 object-cover group-hover:scale-105 transition-transform duration-300"}),(0,t.jsx)("div",{className:"absolute top-2 sm:top-4 left-2 sm:left-4 flex gap-1 sm:gap-2",children:tI(e.dateRaw)&&(0,t.jsx)(e_.Badge,{className:"bg-orange-500 text-white text-xs",children:"Новое"})})]}),(0,t.jsxs)(w.CardContent,{className:"p-3 sm:p-4",children:[(0,t.jsx)("h3",{className:"text-base sm:text-lg text-gray-800 mb-2 group-hover:text-[#18A36C] transition-colors line-clamp-2",children:e.title}),(0,t.jsx)("p",{className:"text-xs sm:text-sm text-gray-600 mb-2 sm:mb-3 line-clamp-2",children:e.content}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 sm:gap-2 text-xs text-gray-500",children:[(0,t.jsx)(eH,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:e.date})]}),(0,t.jsxs)(u.Button,{variant:"ghost",size:"sm",onClick:()=>ey(e),className:"text-[#18A36C] hover:text-[#18A36C]/80 hover:bg-[#18A36C]/10 p-1 sm:p-2 text-xs sm:text-sm",children:[(0,t.jsx)(e$.Eye,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1"}),"Подробнее"]})]})]})]},e.id))})]}),(0,t.jsx)(w.Card,{className:"border border-gray-200",children:(0,t.jsx)(w.CardContent,{className:"p-4 sm:p-6",children:(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row items-center justify-between gap-4 sm:gap-6",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-3 sm:gap-4 text-center sm:text-left w-full lg:w-auto",children:[(0,t.jsx)("div",{className:"w-14 h-14 sm:w-16 sm:h-16 aspect-square bg-[#18A36C] rounded-full flex items-center justify-center overflow-hidden border-2 border-gray-100 shadow-md flex-shrink-0",children:ej.avatarUrl?(0,t.jsx)("img",{src:ej.avatarUrl,alt:"Avatar",className:"w-full h-full object-cover rounded-full"}):(0,t.jsx)("span",{className:"text-lg sm:text-xl text-white font-medium",children:ev()})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-base sm:text-xl text-gray-800 mb-0.5 sm:mb-1",children:ej.fullName||ej.name||"Пользователь"}),(0,t.jsx)("p",{className:"text-sm sm:text-base text-gray-600 mb-0.5 sm:mb-1",children:ej.email||"Email не указан"}),(0,t.jsx)("p",{className:"text-xs sm:text-sm text-gray-500",children:g?.registration_date?`Участник с ${new Date(g.registration_date).getFullYear()} года`:"Участник"})]})]}),(0,t.jsxs)("div",{className:"flex flex-col w-full sm:w-auto sm:flex-row gap-2 sm:gap-3",children:[(0,t.jsxs)(u.Button,{onClick:()=>D(!0),variant:"outline",className:"text-gray-700 border-gray-300 w-full sm:w-auto text-sm",children:[(0,t.jsx)(ez,{className:"w-4 h-4 mr-[2.5px]"}),"Редактировать"]}),(0,t.jsxs)(u.Button,{onClick:()=>k(!0),variant:"outline",className:"text-[#18A36C] border-[#18A36C] hover:bg-[#18A36C] hover:text-white w-full sm:w-auto text-sm hover:shadow-lg hover:shadow-[#18A36C]/20",children:[(0,t.jsx)(eU.Lock,{className:"w-4 h-4 mr-[2.5px]"}),"Пароль"]}),(0,t.jsxs)(u.Button,{onClick:()=>{A(!0)},variant:"outline",className:"text-red-600 border-red-300 w-full sm:w-auto text-sm",children:[(0,t.jsx)(c,{className:"w-4 h-4 mr-[2.5px]"}),"Выйти"]})]})]})})}),(0,t.jsx)(f.Dialog,{open:S,onOpenChange:A,children:(0,t.jsxs)(f.DialogContent,{className:"sm:max-w-md border-0",children:[(0,t.jsxs)(f.DialogHeader,{children:[(0,t.jsx)(f.DialogTitle,{className:"text-xl text-[#2E2E2E]",children:"Подтверждение выхода"}),(0,t.jsxs)(f.DialogDescription,{className:"text-gray-600 pt-2",children:["Вы уверены, что хотите выйти из аккаунта?",(0,t.jsx)("br",{}),"Вам потребуется войти снова для доступа к личному кабинету."]})]}),(0,t.jsxs)(f.DialogFooter,{className:"flex flex-col sm:flex-row gap-3 sm:gap-2 pt-4",children:[(0,t.jsx)(u.Button,{variant:"outline",onClick:()=>A(!1),className:"w-full sm:w-auto border-gray-300 text-[#2E2E2E]",children:"Отмена"}),(0,t.jsxs)(u.Button,{onClick:eb,className:"w-full sm:w-auto bg-red-600 hover:bg-red-700 text-white",children:[(0,t.jsx)(c,{className:"w-4 h-4 mr-2"}),"Выйти"]})]})]})}),(0,t.jsx)(e6,{isOpen:E,onClose:()=>k(!1)}),(0,t.jsx)(tM,{isOpen:P,onClose:()=>D(!1),user:g,onProfileUpdate:e=>{p(e)}}),(0,t.jsx)(t_,{isOpen:R,onClose:()=>{T(!1),L(null)},material:M})]})}e.s(["AccountContent",()=>tY],76971);var tG=e.i(9056),tJ=e.i(83320);let tZ=[{id:"materials",title:"Материалы",icon:(0,t.jsx)(l.FileText,{className:"w-4 h-4"}),children:[]},{id:"contact",title:"Написать глав.врачу",icon:(0,t.jsx)(eB.MessageSquare,{className:"w-4 h-4"}),children:[]},{id:"logout",title:"Выйти",icon:(0,t.jsx)(c,{className:"w-4 h-4"}),children:[],isAction:!0}];function tQ({item:e,level:s,expandedItems:a,setExpandedItems:r,selectedItem:l,onItemClick:i}){let n=e.children&&e.children.length>0,c=a.has(e.id),o=l===e.id;return(0,t.jsxs)("div",{className:0===s?"mb-1":"",children:[(0,t.jsxs)("button",{onClick:()=>{if(n){let t=new Set(a);c?t.delete(e.id):t.add(e.id),r(t)}else i(e)},className:`w-full flex items-center justify-between px-4 py-3 text-left transition-all duration-300 group rounded-lg mx-1 cursor-pointer ${o?"bg-[#18A36C]/10 text-[#18A36C] shadow-sm":"hover:bg-gray-50"} ${s>0?"ml-6 border-l-2 border-gray-200":""} ${e.isAction?"hover:bg-red-50":""}`,style:{width:"calc(100% - 8px)"},children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[e.icon&&(0,t.jsx)("div",{className:`flex-shrink-0 transition-all duration-300 ${o?"text-[#18A36C] scale-110":"text-gray-500 group-hover:text-[#18A36C] group-hover:scale-110"} ${e.isAction?"text-red-500 group-hover:text-red-600":""}`,children:e.icon}),(0,t.jsx)("span",{className:`font-medium transition-colors duration-300 ${o?"text-[#18A36C]":"text-gray-700 group-hover:text-[#18A36C]"} ${e.isAction?"text-red-500 group-hover:text-red-600":""}`,children:e.title})]}),n&&(0,t.jsx)("div",{className:`flex-shrink-0 transition-all duration-300 ${o?"text-[#18A36C]":"text-gray-400 group-hover:text-[#18A36C]"}`,children:c?(0,t.jsx)(eX.ChevronDown,{className:"w-4 h-4"}):(0,t.jsx)(eF.ChevronRight,{className:"w-4 h-4"})})]}),n&&c&&(0,t.jsx)("div",{className:"ml-4",children:e.children.map(e=>(0,t.jsx)(tQ,{item:e,level:s+1,expandedItems:a,setExpandedItems:r,selectedItem:l,onItemClick:i},e.id))})]})}function t0(){let[e,s]=(0,j.useState)(new Set),[r,l]=(0,j.useState)(!1),[i,n]=(0,j.useState)(!1),{navigate:o,currentRoute:d}=(0,eQ.useRouter)(),{isBurgerMenuOpen:m}=(0,tJ.useMenu)(),x=d.replace(/^\/+|\/+$/g,"").split("/"),h="";"account"===x[0]&&(h=x[1]||"");let g=h&&["materials","contact"].includes(h)?h:null,p=async e=>{if(e.isAction&&"logout"===e.id){l(!1),n(!0);return}o(`/account/${e.id}`),l(!1)},y=async()=>{n(!1),await (0,v.signOut)({callbackUrl:"/",redirect:!0})},b=()=>{h&&(o("/account"),l(!1))},w=({onItemClick:r})=>(0,t.jsxs)("div",{className:"bg-white h-full flex flex-col",children:[(0,t.jsx)("div",{className:"p-4 lg:p-6 border-b border-gray-100 bg-gradient-to-r from-white to-gray-50",children:(0,t.jsxs)("button",{onClick:b,className:`w-full flex items-center gap-3 transition-all duration-300 ${h?"cursor-pointer hover:bg-[#18A36C]/5 rounded-xl p-3 -m-3":"cursor-default p-3 -m-3"}`,disabled:!h,children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-[#18A36C] to-[#15905f] rounded-xl flex items-center justify-center flex-shrink-0 shadow-md",children:(0,t.jsx)(a.User,{className:"w-6 h-6 text-white"})}),(0,t.jsxs)("div",{className:"text-left flex-1",children:[(0,t.jsx)("h2",{className:`text-lg lg:text-xl font-semibold transition-colors duration-300 ${h?"text-[#18A36C]":"text-gray-800"}`,children:"Личный кабинет"}),(0,t.jsx)("p",{className:"text-xs lg:text-sm text-gray-500 mt-0.5",children:"Управление аккаунтом"})]}),h&&(0,t.jsx)(eF.ChevronRight,{className:"w-5 h-5 text-[#18A36C] flex-shrink-0 transition-transform duration-300 group-hover:translate-x-1"})]})}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,t.jsx)("nav",{className:"py-4 px-2",children:tZ.map(a=>(0,t.jsx)(tQ,{item:a,level:0,expandedItems:e,setExpandedItems:s,selectedItem:g,onItemClick:r||p},a.id))})}),(0,t.jsx)("div",{className:"p-4 border-t border-gray-100 bg-gradient-to-r from-gray-50 to-white",children:(0,t.jsx)("p",{className:"text-xs text-gray-500 text-center font-medium",children:"Doctor Family © 2025"})})]});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"hidden lg:block w-80 flex-shrink-0 sticky top-[80px] h-[calc(100vh-80px)] overflow-y-auto bg-white border-r border-gray-200 shadow-lg",children:(0,t.jsx)(w,{})}),(0,t.jsx)("div",{className:"lg:hidden fixed top-24 left-4 z-50",children:(0,t.jsxs)(tG.Sheet,{open:r&&!m,onOpenChange:e=>!m&&l(e),children:[(0,t.jsx)(tG.SheetTrigger,{asChild:!0,children:(0,t.jsx)(u.Button,{size:"sm",disabled:m,className:"bg-[#18A36C] hover:bg-[#18A36C]/90 text-white shadow-xl rounded-full w-14 h-14 p-0 transition-all duration-300 hover:scale-110 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,t.jsx)(a.User,{className:"w-6 h-6"})})}),(0,t.jsxs)(tG.SheetContent,{side:"left",className:"w-80 p-0",children:[(0,t.jsxs)(tG.SheetHeader,{className:"sr-only",children:[(0,t.jsx)(tG.SheetTitle,{children:"Личный кабинет"}),(0,t.jsx)(tG.SheetDescription,{children:"Управление аккаунтом и настройками"})]}),(0,t.jsx)(w,{onItemClick:p})]})]})}),(0,t.jsx)(f.Dialog,{open:i,onOpenChange:n,children:(0,t.jsxs)(f.DialogContent,{className:"sm:max-w-md border-0",children:[(0,t.jsxs)(f.DialogHeader,{children:[(0,t.jsx)(f.DialogTitle,{className:"text-xl text-[#2E2E2E]",children:"Подтверждение выхода"}),(0,t.jsxs)(f.DialogDescription,{className:"text-gray-600 pt-2",children:["Вы уверены, что хотите выйти из аккаунта?",(0,t.jsx)("br",{}),"Вам потребуется войти снова для доступа к личному кабинету."]})]}),(0,t.jsxs)(f.DialogFooter,{className:"flex flex-col sm:flex-row gap-3 sm:gap-2 pt-4",children:[(0,t.jsx)(u.Button,{variant:"outline",onClick:()=>n(!1),className:"w-full sm:w-auto border-gray-300 text-[#2E2E2E] hover:bg-gray-50",children:"Отмена"}),(0,t.jsxs)(u.Button,{onClick:y,className:"w-full sm:w-auto bg-red-600 hover:bg-red-700 text-white",children:[(0,t.jsx)(c,{className:"w-4 h-4 mr-2"}),"Выйти"]})]})]})})]})}e.s(["NavigableAccountMenu",()=>t0],1370)}]);