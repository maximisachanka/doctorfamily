module.exports=[10179,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(62036),e=a.i(60246),f=a.i(67974);a.i(24933);var g=a.i(41567),h=a.i(31860),i=a.i(72663),j=a.i(4297),k=a.i(55220),l=a.i(79212),m=a.i(96215),n=a.i(37210),o=a.i(72549);a.i(27190);var p=a.i(25170),q=a.i(48701),r=a.i(50944),s=a.i(50751),t=a.i(32860),u=a.i(3314),v=a.i(8406),w=a.i(9526),x=a.i(46271);function y(){let a=(0,r.useRouter)();return(0,b.jsx)("div",{className:"min-h-[calc(100vh-8rem)] flex items-center justify-center p-4",children:(0,b.jsx)(x.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"max-w-2xl w-full",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[(0,b.jsxs)("div",{className:"bg-gradient-to-br from-[#18A36C] to-[#15905f] p-8 text-white relative overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full -mr-32 -mt-32"}),(0,b.jsx)("div",{className:"absolute bottom-0 left-0 w-48 h-48 bg-white/10 rounded-full -ml-24 -mb-24"}),(0,b.jsxs)("div",{className:"relative z-10",children:[(0,b.jsx)("div",{className:"flex items-center justify-center mb-6",children:(0,b.jsx)("div",{className:"w-20 h-20 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center",children:(0,b.jsx)(u.Shield,{className:"w-10 h-10 text-white"})})}),(0,b.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-center mb-3",children:"Добро пожаловать в админ-панель!"}),(0,b.jsx)("p",{className:"text-white/90 text-center text-lg",children:"Вы вошли как оператор"})]})]}),(0,b.jsx)("div",{className:"p-8",children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-100",children:(0,b.jsxs)("div",{className:"flex items-start gap-4",children:[(0,b.jsx)("div",{className:"flex-shrink-0",children:(0,b.jsx)("div",{className:"w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center",children:(0,b.jsx)(v.Sparkles,{className:"w-6 h-6 text-white"})})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Ваша роль и возможности"}),(0,b.jsxs)("p",{className:"text-gray-600 leading-relaxed",children:["Как оператор, вы имеете доступ к разделу ",(0,b.jsx)("strong",{children:"чата"}),", где можете отвечать на вопросы пациентов и помогать им с их запросами в режиме реального времени."]})]})]})}),(0,b.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-6 border border-green-100",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-[#18A36C] rounded-lg flex items-center justify-center flex-shrink-0",children:(0,b.jsx)(s.MessagesSquare,{className:"w-6 h-6 text-white"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Раздел чата"}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Управляйте сообщениями пациентов"})]})]}),(0,b.jsxs)(w.Button,{onClick:()=>a.push("/admin/chat"),className:"w-full bg-[#18A36C] hover:bg-[#15905f] text-white font-medium py-3 rounded-lg transition-all duration-300 hover:scale-[1.02] active:scale-[0.98] shadow-lg shadow-[#18A36C]/20 flex items-center justify-center gap-2",children:["Перейти в чат",(0,b.jsx)(t.ArrowRight,{className:"w-5 h-5"})]})]}),(0,b.jsx)("div",{className:"text-center pt-4",children:(0,b.jsxs)("p",{className:"text-sm text-gray-500",children:["Если у вас есть вопросы по работе с системой,",(0,b.jsx)("br",{}),"обратитесь к администратору или главному врачу"]})})]})})]})})})}function z(){let{sessionVerified:a,isLoading:r,verifySession:s}=(0,l.useAdminSession)(),t=(0,o.useConfirmDialog)(),{success:u,error:v}=(0,p.useAlert)(),[w,x]=(0,c.useState)(null),[z,A]=(0,c.useState)(!0),[B,C]=(0,c.useState)([]),[D,E]=(0,c.useState)([]),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(""),{currentPage:J,setPage:K,paginateData:L}=(0,q.useUrlPagination)(12),[M,N]=(0,c.useState)(!1),[O,P]=(0,c.useState)(null),[Q,R]=(0,c.useState)(!1),[S,T]=(0,c.useState)({name:"",specialization:"",qualification:"",experience:"",grade:"5",image_url:"",activity_area:"",education_details:"",conferences:"",specializations:"",education:"",category_id:"",service_category_id:""});(0,c.useEffect)(()=>{(async()=>{if(a)try{let a=await fetch("/api/admin/auth"),b=await a.json();x(b.role||null)}catch(a){x(null)}finally{A(!1)}else!1===a&&A(!1)})()},[a]),(0,c.useEffect)(()=>{a&&w&&"OPERATOR"!==w&&U()},[a,w]);let U=async()=>{G(!0);try{let[a,b]=await Promise.all([fetch("/api/admin/specialists"),fetch("/api/service-categories")]);if(a.ok){let b=await a.json();C(b)}if(b.ok){let a=await b.json();E(a)}}catch(a){}finally{G(!1)}},V=(0,c.useMemo)(()=>{if(!H)return B;let a=H.toLowerCase();return B.filter(b=>b.name.toLowerCase().includes(a)||b.specialization.toLowerCase().includes(a)||b.category?.name.toLowerCase().includes(a)||b.serviceCategory?.name.toLowerCase().includes(a))},[B,H]);(0,c.useEffect)(()=>{K(1)},[H]);let{paginatedData:W,totalPages:X}=(0,c.useMemo)(()=>L(V),[L,V]),Y=()=>{T({name:"",specialization:"",qualification:"",experience:"",grade:"5",image_url:"",activity_area:"",education_details:"",conferences:"",specializations:"",education:"",category_id:"",service_category_id:""}),P(null),N(!1)},Z=()=>{Y(),N(!0)},$=async()=>{R(!0);try{let a={...S,specializations:S.specializations.split("\n").filter(a=>a.trim()),education:S.education.split("\n").filter(a=>a.trim()),conferences:S.conferences.split("\n").filter(a=>a.trim())},b=O?`/api/admin/specialists/${O.id}`:"/api/admin/specialists",c=O?"PUT":"POST",d=await fetch(b,{method:c,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(d.ok)await U(),Y(),u(O?"Специалист обновлен":"Специалист создан");else{let a=await d.json();v(a.error||"Ошибка сохранения")}}catch(a){v("Ошибка сохранения")}finally{R(!1)}},_=async(a,b)=>{if(await t.confirm({title:"Удаление специалиста",message:`Вы уверены, что хотите удалить специалиста "${b}"? Это действие нельзя отменить.`,confirmText:"Удалить",cancelText:"Отмена",variant:"danger"}))try{let b=await fetch(`/api/admin/specialists/${a}`,{method:"DELETE"});if(b.ok)await U(),u("Специалист удален");else{let a=await b.json();v(a.error||"Ошибка удаления")}}catch(a){v("Ошибка удаления")}};return r||z?(0,b.jsx)(m.AdminAccessSkeleton,{}):a?"OPERATOR"===w?(0,b.jsxs)("div",{className:"flex min-h-screen bg-gray-50",children:[(0,b.jsx)(i.AdminMenu,{}),(0,b.jsx)("div",{className:"flex-1 overflow-auto",children:(0,b.jsx)(y,{})})]}):(0,b.jsxs)("div",{className:"flex min-h-screen bg-gray-50",children:[(0,b.jsx)(i.AdminMenu,{}),(0,b.jsx)("div",{className:"flex-1 p-4 lg:p-8 overflow-auto",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,b.jsx)(j.AdminSection,{title:"Специалисты",icon:e.Users,count:B.length,loading:F,searchValue:H,onSearchChange:I,onAdd:Z,addButtonText:"Добавить специалиста",children:0===V.length?(0,b.jsx)(j.EmptyState,{icon:e.Users,title:"Специалисты не найдены",description:H?"Попробуйте изменить поисковый запрос":"Добавьте первого специалиста",actionText:H?void 0:"Добавить специалиста",onAction:H?void 0:Z}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:(0,b.jsx)(d.AnimatePresence,{children:W.map(a=>(0,b.jsxs)(j.ItemCard,{children:[(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsx)("div",{className:"w-20 h-20 rounded-xl overflow-hidden flex-shrink-0 bg-gray-100",children:(0,b.jsx)(h.ImageWithFallback,{src:a.image_url,alt:a.name,className:"w-full h-full object-cover"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-800 truncate",children:a.name}),(0,b.jsx)("p",{className:"text-sm text-gray-500 truncate",children:a.specialization}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,b.jsx)(j.Badge,{variant:"primary",children:a.serviceCategory?.name||a.category?.name||"Без категории"}),(0,b.jsxs)(j.Badge,{variant:"secondary",children:[a.experience," лет"]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-gray-100",children:[(0,b.jsx)("span",{className:"text-xs text-gray-400",children:a.qualification}),(0,b.jsx)(j.CardActions,{onEdit:()=>{P(a),T({name:a.name,specialization:a.specialization,qualification:a.qualification,experience:a.experience.toString(),grade:a.grade.toString(),image_url:a.image_url,activity_area:a.activity_area||"",education_details:a.education_details||"",conferences:a.conferences.join("\n"),specializations:a.specializations.join("\n"),education:a.education.join("\n"),category_id:a.category_id?a.category_id.toString():"",service_category_id:a.service_category_id?a.service_category_id.toString():""}),N(!0)},onDelete:()=>_(a.id,a.name)})]})]},a.id))})}),X>1&&(0,b.jsx)(f.Pagination,{currentPage:J,totalPages:X,onPageChange:K,className:"mt-6"})]})}),(0,b.jsx)(j.FormModal,{isOpen:M,onClose:Y,title:O?"Редактирование специалиста":"Новый специалист",onSubmit:$,loading:Q,disabled:!S.name||!S.specialization||!S.service_category_id,children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsx)(j.FormField,{label:"ФИО",required:!0,children:(0,b.jsx)(j.FormInput,{type:"text",value:S.name,onChange:a=>T({...S,name:a.target.value}),placeholder:"Иванов Иван Иванович"})}),(0,b.jsx)(j.FormField,{label:"Специализация",required:!0,children:(0,b.jsx)(j.FormInput,{type:"text",value:S.specialization,onChange:a=>T({...S,specialization:a.target.value}),placeholder:"Стоматолог-терапевт"})}),(0,b.jsx)(j.FormField,{label:"Квалификация",required:!0,children:(0,b.jsx)(j.FormInput,{type:"text",value:S.qualification,onChange:a=>T({...S,qualification:a.target.value}),placeholder:"Врач высшей категории"})}),(0,b.jsx)(j.FormField,{label:"Категория услуг",required:!0,children:(0,b.jsxs)(j.FormSelect,{value:S.service_category_id,onChange:a=>T({...S,service_category_id:a.target.value}),children:[(0,b.jsx)("option",{value:"",children:"Выберите категорию услуг"}),D.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})}),(0,b.jsx)(j.FormField,{label:"Стаж (лет)",required:!0,children:(0,b.jsx)(j.FormInput,{type:"number",value:S.experience,onChange:a=>T({...S,experience:a.target.value}),placeholder:"10"})}),(0,b.jsx)(j.FormField,{label:"Рейтинг (1-5)",children:(0,b.jsx)(j.FormInput,{type:"number",min:"1",max:"5",value:S.grade,onChange:a=>T({...S,grade:a.target.value})})}),(0,b.jsx)("div",{className:"md:col-span-2",children:(0,b.jsx)(j.FormField,{label:"Фото специалиста",children:(0,b.jsx)(g.ImageUploader,{value:S.image_url,onChange:a=>T({...S,image_url:a}),folder:"smartmedical/specialists",placeholder:"Загрузите фото специалиста",maxSizeMB:10})})}),(0,b.jsx)("div",{className:"md:col-span-2",children:(0,b.jsx)(j.FormField,{label:"Направления (каждое с новой строки)",children:(0,b.jsx)(j.FormTextarea,{value:S.specializations,onChange:a=>T({...S,specializations:a.target.value}),rows:3,placeholder:"Терапевтическая стоматология Эстетическая реставрация"})})}),(0,b.jsx)("div",{className:"md:col-span-2",children:(0,b.jsx)(j.FormField,{label:"Образование (каждое с новой строки)",children:(0,b.jsx)(j.FormTextarea,{value:S.education,onChange:a=>T({...S,education:a.target.value}),rows:3,placeholder:"МГУ, Медицинский факультет, 2010 Ординатура по стоматологии, 2012"})})}),(0,b.jsx)("div",{className:"md:col-span-2",children:(0,b.jsx)(j.FormField,{label:"Конференции (каждая с новой строки)",children:(0,b.jsx)(j.FormTextarea,{value:S.conferences,onChange:a=>T({...S,conferences:a.target.value}),rows:3,placeholder:"Международная конференция стоматологов 2023 DentalTech Summit 2024 European Dental Congress 2024"})})})]})}),(0,b.jsx)(n.ConfirmDialog,{isOpen:t.isOpen,onClose:t.handleCancel,onConfirm:t.handleConfirm,title:t.options.title,message:t.options.message,confirmText:t.options.confirmText,cancelText:t.options.cancelText,variant:t.options.variant,loading:t.loading})]})})]}):(0,b.jsx)(k.AdminAuthForm,{onSuccess:()=>{s()}})}a.s(["default",()=>z],10179)}];

//# sourceMappingURL=src_app_admin_page_tsx_645532da._.js.map