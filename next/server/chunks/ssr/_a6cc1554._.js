module.exports=[38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},37210,a=>{"use strict";var b=a.i(87924),c=a.i(46271),d=a.i(62036),e=a.i(73570),f=a.i(33508),g=a.i(9526);function h({isOpen:a,onClose:h,onConfirm:i,title:j,message:k,confirmText:l="Удалить",cancelText:m="Отмена",variant:n="danger",loading:o=!1}){return a?(0,b.jsx)(d.AnimatePresence,{children:a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(c.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:h,className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[9998]"}),(0,b.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",children:(0,b.jsxs)(c.motion.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",duration:.3},className:"bg-white rounded-2xl shadow-2xl max-w-md w-full overflow-hidden",onClick:a=>a.stopPropagation(),children:[(0,b.jsx)("div",{className:`px-6 py-5 border-b border-gray-100 ${"danger"===n?"bg-red-50":"bg-yellow-50"}`,children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${"danger"===n?"bg-red-100":"bg-yellow-100"}`,children:(0,b.jsx)(e.AlertTriangle,{className:`w-6 h-6 ${"danger"===n?"text-red-600":"text-yellow-600"}`})}),(0,b.jsx)("div",{children:(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:j})})]}),(0,b.jsx)("button",{onClick:h,disabled:o,className:"text-gray-400 hover:text-gray-600 transition-colors disabled:opacity-50 cursor-pointer",children:(0,b.jsx)(f.X,{className:"w-5 h-5"})})]})}),(0,b.jsx)("div",{className:"px-6 py-5",children:(0,b.jsx)("p",{className:"text-gray-600 leading-relaxed",children:k})}),(0,b.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-100 flex items-center justify-end gap-3",children:[(0,b.jsx)(g.Button,{onClick:h,disabled:o,variant:"ghost",className:"px-5 py-2.5 cursor-pointer",children:m}),(0,b.jsx)("button",{onClick:()=>{i()},disabled:o,className:`px-5 py-2.5 rounded-xl font-medium transition-all disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer ${"danger"===n?"bg-red-600 hover:bg-red-700 text-white shadow-lg shadow-red-600/30":"bg-yellow-600 hover:bg-yellow-700 text-white shadow-lg shadow-yellow-600/30"}`,children:o?(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),(0,b.jsx)("span",{children:"Удаление..."})]}):l})]})]})})]})}):null}a.s(["ConfirmDialog",()=>h])},72549,a=>{"use strict";var b=a.i(72131);function c(){let[a,c]=(0,b.useState)(!1),[d,e]=(0,b.useState)(!1),[f,g]=(0,b.useState)({title:"",message:""}),[h,i]=(0,b.useState)(null),j=(0,b.useCallback)(a=>(g(a),c(!0),e(!1),new Promise(a=>{i({resolve:a})})),[]);return{confirm:j,isOpen:a,loading:d,options:f,handleConfirm:(0,b.useCallback)(async()=>{h&&(e(!0),await new Promise(a=>setTimeout(a,300)),h.resolve(!0),c(!1),e(!1),i(null))},[h]),handleCancel:(0,b.useCallback)(()=>{h&&(h.resolve(!1),c(!1),e(!1),i(null))},[h])}}a.s(["useConfirmDialog",()=>c])},27190,a=>{"use strict";a.i(6016),a.i(26481),a.i(25170),a.s([])},91678,a=>{"use strict";let b={а:"a",б:"b",в:"v",г:"g",д:"d",е:"e",ё:"yo",ж:"zh",з:"z",и:"i",й:"y",к:"k",л:"l",м:"m",н:"n",о:"o",п:"p",р:"r",с:"s",т:"t",у:"u",ф:"f",х:"h",ц:"ts",ч:"ch",ш:"sh",щ:"sch",ъ:"",ы:"y",ь:"",э:"e",ю:"yu",я:"ya",А:"A",Б:"B",В:"V",Г:"G",Д:"D",Е:"E",Ё:"Yo",Ж:"Zh",З:"Z",И:"I",Й:"Y",К:"K",Л:"L",М:"M",Н:"N",О:"O",П:"P",Р:"R",С:"S",Т:"T",У:"U",Ф:"F",Х:"H",Ц:"Ts",Ч:"Ch",Ш:"Sh",Щ:"Sch",Ъ:"",Ы:"Y",Ь:"",Э:"E",Ю:"Yu",Я:"Ya"};function c(a){return a?a.split("").map(a=>b[a]||a).join("").toLowerCase().trim().replace(/[\s_]+/g,"-").replace(/[^a-z0-9-]/g,"").replace(/-+/g,"-").replace(/^-+|-+$/g,""):""}a.s(["generateSlug",()=>c])},65098,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(75003),e=a.i(62036),f=a.i(49447),g=a.i(72663),h=a.i(4297),i=a.i(52913),j=a.i(55220),k=a.i(79212),l=a.i(96215),m=a.i(37210),n=a.i(72549);a.i(27190);var o=a.i(25170),p=a.i(91678);function q(){let{status:a}=(0,d.useSession)(),{sessionVerified:q,isLoading:r,verifySession:s}=(0,k.useAdminSession)(),[t,u]=(0,c.useState)(null),v=(0,n.useConfirmDialog)(),{success:w,error:x}=(0,o.useAlert)(),[y,z]=(0,c.useState)([]),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)({name:"",slug:"",description:"",order:""}),[M,N]=(0,c.useState)("");(0,c.useEffect)(()=>{"authenticated"===a?O():"unauthenticated"===a&&u(!1)},[a]);let O=async()=>{try{let a=await fetch("/api/admin/auth"),b=await a.json();u(b.isAdmin)}catch(a){u(!1)}},P=async()=>{B(!0);try{let a=await fetch("/api/admin/question-categories"),b=await a.json();z(b)}catch(a){x("Ошибка загрузки данных")}finally{B(!1)}};(0,c.useEffect)(()=>{q&&P()},[q]);let Q=()=>{H(null),L({name:"",slug:"",description:"",order:""}),N(""),F(!0)},R=()=>{L({name:"",slug:"",description:"",order:""}),H(null),N(""),F(!1)},S=async()=>{if(!K.name||!K.slug)return void x("Заполните обязательные поля");J(!0);try{let a=G?`/api/admin/question-categories/${G.id}`:"/api/admin/question-categories",b=await fetch(a,{method:G?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:K.name,slug:K.slug,description:K.description||null,order:K.order?parseInt(K.order):0})});if(b.ok)await P(),R(),w(G?"Категория обновлена":"Категория создана");else{let a=await b.json();x(a.error||"Ошибка сохранения")}}catch(a){x("Ошибка сохранения")}finally{J(!1)}},T=async(a,b)=>{if(await v.confirm({title:"Удаление категории",message:`Вы уверены, что хотите удалить категорию "${b}"? Это действие нельзя отменить.`,confirmText:"Удалить",cancelText:"Отмена",variant:"danger"}))try{let b=await fetch(`/api/admin/question-categories/${a}`,{method:"DELETE"});if(b.ok)await P(),w("Категория удалена");else{let a=await b.json();x(a.error||"Ошибка удаления")}}catch(a){x("Ошибка удаления")}},U=y.filter(a=>a.name.toLowerCase().includes(C.toLowerCase())||a.slug.toLowerCase().includes(C.toLowerCase()));return"loading"===a||null===t||r?(0,b.jsx)(l.AdminAccessSkeleton,{}):"unauthenticated"!==a&&t?q?(0,b.jsxs)("div",{className:"flex min-h-screen bg-gray-50",children:[(0,b.jsx)(g.AdminMenu,{}),(0,b.jsx)("div",{className:"flex-1 p-4 lg:p-8 overflow-auto",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,b.jsx)(h.AdminSection,{title:"Категории вопросов",icon:f.HelpCircle,count:U.length,loading:A,searchValue:C,onSearchChange:D,onAdd:Q,addButtonText:"Добавить категорию",loadingSkeleton:(0,b.jsx)(l.AdminQuestionsGridSkeleton,{count:8}),children:0===U.length?(0,b.jsx)(h.EmptyState,{icon:f.HelpCircle,title:"Категории не найдены",description:C?"Попробуйте изменить поисковый запрос":"Добавьте первую категорию",actionText:C?void 0:"Добавить категорию",onAction:C?void 0:Q}):(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsx)(e.AnimatePresence,{children:U.map(a=>(0,b.jsx)(h.ItemCard,{children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-800",children:a.name}),(0,b.jsx)(h.Badge,{variant:a.is_active?"success":"secondary",children:a.is_active?"Активна":"Неактивна"}),(0,b.jsxs)(h.Badge,{variant:"secondary",children:["Порядок: ",a.order]}),(0,b.jsxs)(h.Badge,{variant:"primary",children:[a._count.questions," вопросов"]})]}),(0,b.jsxs)("p",{className:"text-sm text-gray-500 mb-2",children:["Slug: /",a.slug]}),a.description&&(0,b.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2",children:a.description})]}),(0,b.jsx)(h.CardActions,{onEdit:()=>{H(a),L({name:a.name,slug:a.slug,description:a.description||"",order:a.order.toString()}),N(""),F(!0)},onDelete:()=>T(a.id,a.name)})]})},a.id))})})})})}),(0,b.jsxs)(h.FormModal,{isOpen:E,onClose:R,title:G?"Редактировать категорию":"Добавить категорию",onSubmit:S,submitText:G?"Сохранить":"Создать",loading:I,children:[(0,b.jsx)(h.FormField,{label:"Название",required:!0,children:(0,b.jsx)(h.FormInput,{placeholder:"Например: Детское здоровье",value:K.name,onChange:a=>{let b=a.target.value;L({...K,name:b,slug:(0,p.generateSlug)(b)})}})}),(0,b.jsx)(h.FormField,{label:"Slug (URL)",required:!0,children:(0,b.jsx)(h.FormInput,{placeholder:"detskoe-zdorovye",value:K.slug,onChange:a=>L({...K,slug:a.target.value})})}),(0,b.jsx)(h.FormField,{label:"Описание",children:(0,b.jsx)(h.FormTextarea,{placeholder:"Краткое описание категории",value:K.description,onChange:a=>L({...K,description:a.target.value}),rows:3})}),(0,b.jsxs)(h.FormField,{label:"Порядок сортировки",required:!0,children:[(0,b.jsx)(h.FormInput,{type:"number",placeholder:"0",value:K.order,onChange:a=>{L({...K,order:a.target.value}),(a=>{if(!a)return N("");let b=parseInt(a),c=y.find(a=>(!G||a.id!==G.id)&&a.order===b);c?N(`⚠️ Порядок ${b} уже занят категорией "${c.name}"`):N("")})(a.target.value)}}),M&&(0,b.jsx)("p",{className:"text-orange-600 text-sm mt-1",children:M})]})]}),(0,b.jsx)(m.ConfirmDialog,{isOpen:v.isOpen,onClose:v.handleCancel,onConfirm:v.handleConfirm,title:v.options.title,message:v.options.message,confirmText:v.options.confirmText,cancelText:v.options.cancelText,variant:v.options.variant,loading:v.loading})]}):(0,b.jsx)(j.AdminAuthForm,{onSuccess:()=>{s(),P()}}):(0,b.jsx)(i.default,{})}a.s(["default",()=>q])}];

//# sourceMappingURL=_a6cc1554._.js.map