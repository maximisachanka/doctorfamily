(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,i,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"warnOnce",{enumerable:!0,get:function(){return t}});let t=e=>{}},69524,91900,e=>{"use strict";var i=e.i(43476),a=e.i(46932),t=e.i(88653),s=e.i(78894),n=e.i(37727),l=e.i(26299);function r({isOpen:e,onClose:r,onConfirm:o,title:c,message:d,confirmText:u="Удалить",cancelText:m="Отмена",variant:x="danger",loading:h=!1}){return e?(0,i.jsx)(t.AnimatePresence,{children:e&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r,className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[9998]"}),(0,i.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",children:(0,i.jsxs)(a.motion.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",duration:.3},className:"bg-white rounded-2xl shadow-2xl max-w-md w-full overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,i.jsx)("div",{className:`px-6 py-5 border-b border-gray-100 ${"danger"===x?"bg-red-50":"bg-yellow-50"}`,children:(0,i.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${"danger"===x?"bg-red-100":"bg-yellow-100"}`,children:(0,i.jsx)(s.AlertTriangle,{className:`w-6 h-6 ${"danger"===x?"text-red-600":"text-yellow-600"}`})}),(0,i.jsx)("div",{children:(0,i.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:c})})]}),(0,i.jsx)("button",{onClick:r,disabled:h,className:"text-gray-400 hover:text-gray-600 transition-colors disabled:opacity-50",children:(0,i.jsx)(n.X,{className:"w-5 h-5"})})]})}),(0,i.jsx)("div",{className:"px-6 py-5",children:(0,i.jsx)("p",{className:"text-gray-600 leading-relaxed",children:d})}),(0,i.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-100 flex items-center justify-end gap-3",children:[(0,i.jsx)(l.Button,{onClick:r,disabled:h,variant:"ghost",className:"px-5 py-2.5",children:m}),(0,i.jsx)("button",{onClick:()=>{o()},disabled:h,className:`px-5 py-2.5 rounded-xl font-medium transition-all disabled:opacity-50 disabled:cursor-not-allowed ${"danger"===x?"bg-red-600 hover:bg-red-700 text-white shadow-lg shadow-red-600/30":"bg-yellow-600 hover:bg-yellow-700 text-white shadow-lg shadow-yellow-600/30"}`,children:h?(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),(0,i.jsx)("span",{children:"Удаление..."})]}):u})]})]})})]})}):null}e.s(["ConfirmDialog",()=>r],69524);var o=e.i(71645);function c(){let[e,i]=(0,o.useState)(!1),[a,t]=(0,o.useState)(!1),[s,n]=(0,o.useState)({title:"",message:""}),[l,r]=(0,o.useState)(null),c=(0,o.useCallback)(e=>(n(e),i(!0),t(!1),new Promise(e=>{r({resolve:e})})),[]);return{confirm:c,isOpen:e,loading:a,options:s,handleConfirm:(0,o.useCallback)(async()=>{l&&(t(!0),await new Promise(e=>setTimeout(e,300)),l.resolve(!0),i(!1),t(!1),r(null))},[l]),handleCancel:(0,o.useCallback)(()=>{l&&(l.resolve(!1),i(!1),t(!1),r(null))},[l])}}e.s(["useConfirmDialog",()=>c],91900)},87690,e=>{"use strict";e.i(51651),e.i(5901),e.i(86633),e.s([])},56187,e=>{"use strict";var i=e.i(43476),a=e.i(71645),t=e.i(17255),s=e.i(88653),n=e.i(74875),l=e.i(75961),r=e.i(4125),o=e.i(29306),c=e.i(18026),d=e.i(45347),u=e.i(73250),m=e.i(69524),x=e.i(91900);e.i(87690);var h=e.i(86633);let g={"children-teeth":"Детские зубы","girls-hygiene":"Гигиена девочек","boys-hygiene":"Гигиена мальчиков","girls-puberty":"Половое созревание девочек",culdocentesis:"Кульдоцентез",stomatology:"Стоматология","polyp-removal":"Удаления полипов | Полипэктомия",ultrasound:"УЗИ","womens-health":"Женское здоровье",curettage:"Раздельное диагностическое выскабливание"},p=e=>e?g[e]||e:"";function y(){let{status:e}=(0,t.useSession)(),{sessionVerified:y,isLoading:j,verifySession:f}=(0,d.useAdminSession)(),[v,w]=(0,a.useState)(null),b=(0,x.useConfirmDialog)(),{success:C,error:N}=(0,h.useAlert)(),[S,A]=(0,a.useState)([]),[T,k]=(0,a.useState)([]),[F,q]=(0,a.useState)(!1),[P,O]=(0,a.useState)(""),[E,$]=(0,a.useState)(!1),[_,B]=(0,a.useState)(null),[D,L]=(0,a.useState)(!1),[M,Q]=(0,a.useState)({question:"",answer:"",category:"",service_id:""});(0,a.useEffect)(()=>{"authenticated"===e?U():"unauthenticated"===e&&w(!1)},[e]),(0,a.useEffect)(()=>{y&&v&&z()},[y,v]);let U=async()=>{try{let e=await fetch("/api/admin/auth"),i=await e.json();w(i.isAdmin)}catch(e){w(!1)}},z=async()=>{q(!0);try{let[e,i]=await Promise.all([fetch("/api/admin/questions"),fetch("/api/services")]);if(e.ok){let i=await e.json();A(i)}if(i.ok){let e=await i.json();k(e)}}catch(e){console.error("Error loading data:",e)}finally{q(!1)}},H=(0,a.useMemo)(()=>{if(!P)return S;let e=P.toLowerCase();return S.filter(i=>i.question.toLowerCase().includes(e)||i.answer?.toLowerCase().includes(e)||p(i.category).toLowerCase().includes(e))},[S,P]),K=()=>{Q({question:"",answer:"",category:"",service_id:""}),B(null),$(!1)},R=()=>{K(),$(!0)},G=async()=>{L(!0);try{let e=_?`/api/admin/questions/${_.id}`:"/api/admin/questions",i=_?"PUT":"POST",a=await fetch(e,{method:i,headers:{"Content-Type":"application/json"},body:JSON.stringify(M)});if(a.ok)await z(),K(),C(_?"Вопрос обновлен":"Вопрос создан");else{let e=await a.json();N(e.error||"Ошибка сохранения")}}catch(e){N("Ошибка сохранения")}finally{L(!1)}},I=async(e,i)=>{if(await b.confirm({title:"Удаление вопроса",message:`Вы уверены, что хотите удалить вопрос "${i.substring(0,50)}${i.length>50?"...":""}"? Это действие нельзя отменить.`,confirmText:"Удалить",cancelText:"Отмена",variant:"danger"}))try{let i=await fetch(`/api/admin/questions/${e}`,{method:"DELETE"});if(i.ok)await z(),C("Вопрос удален");else{let e=await i.json();N(e.error||"Ошибка удаления")}}catch(e){N("Ошибка удаления")}};return"loading"===e||null===v||j?(0,i.jsx)(u.AdminAccessSkeleton,{}):"unauthenticated"!==e&&v?y?(0,i.jsxs)("div",{className:"flex min-h-screen bg-gray-50",children:[(0,i.jsx)(l.AdminMenu,{}),(0,i.jsx)("div",{className:"flex-1 p-4 lg:p-8 overflow-auto",children:(0,i.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,i.jsx)(r.AdminSection,{title:"Вопросы (FAQ)",icon:n.HelpCircle,count:S.length,loading:F,searchValue:P,onSearchChange:O,onAdd:R,addButtonText:"Добавить вопрос",loadingSkeleton:(0,i.jsx)(u.AdminQuestionsGridSkeleton,{count:12}),children:0===H.length?(0,i.jsx)(r.EmptyState,{icon:n.HelpCircle,title:"Вопросы не найдены",description:P?"Попробуйте изменить поисковый запрос":"Добавьте первый вопрос",actionText:P?void 0:"Добавить вопрос",onAction:P?void 0:R}):(0,i.jsx)("div",{className:"space-y-4",children:(0,i.jsx)(s.AnimatePresence,{children:H.map(e=>(0,i.jsx)(r.ItemCard,{children:(0,i.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("h3",{className:"font-semibold text-gray-800 mb-2",children:e.question}),e.answer&&(0,i.jsx)("p",{className:"text-sm text-gray-500 line-clamp-2 mb-3",children:e.answer}),(0,i.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[e.category&&(0,i.jsx)(r.Badge,{variant:"primary",children:p(e.category)}),e.service&&(0,i.jsx)(r.Badge,{variant:"secondary",children:e.service.title}),!e.answer&&(0,i.jsx)(r.Badge,{variant:"warning",children:"Без ответа"})]})]}),(0,i.jsx)(r.CardActions,{onEdit:()=>{B(e),Q({question:e.question,answer:e.answer||"",category:e.category||"",service_id:e.service_id?.toString()||""}),$(!0)},onDelete:()=>I(e.id,e.question)})]})},e.id))})})}),(0,i.jsx)(r.FormModal,{isOpen:E,onClose:K,title:_?"Редактирование вопроса":"Новый вопрос",onSubmit:G,loading:D,disabled:!M.question,children:(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)(r.FormField,{label:"Вопрос",required:!0,children:(0,i.jsx)(r.FormTextarea,{value:M.question,onChange:e=>Q({...M,question:e.target.value}),rows:2,placeholder:"Введите вопрос"})}),(0,i.jsx)(r.FormField,{label:"Ответ",children:(0,i.jsx)(r.FormTextarea,{value:M.answer,onChange:e=>Q({...M,answer:e.target.value}),rows:4,placeholder:"Введите ответ на вопрос"})}),(0,i.jsx)(r.FormField,{label:"Категория FAQ (для страницы Клиника)",children:(0,i.jsxs)(r.FormSelect,{value:M.category,onChange:e=>Q({...M,category:e.target.value}),children:[(0,i.jsx)("option",{value:"",children:"Не выбрано"}),Object.entries(g).map(([e,a])=>(0,i.jsx)("option",{value:e,children:a},e))]})}),(0,i.jsx)(r.FormField,{label:"Привязка к услуге (опционально)",children:(0,i.jsxs)(r.FormSelect,{value:M.service_id,onChange:e=>Q({...M,service_id:e.target.value}),children:[(0,i.jsx)("option",{value:"",children:"Не привязан к услуге"}),T.map(e=>(0,i.jsx)("option",{value:e.id,children:e.title},e.id))]})})]})}),(0,i.jsx)(m.ConfirmDialog,{isOpen:b.isOpen,onClose:b.handleCancel,onConfirm:b.handleConfirm,title:b.options.title,message:b.options.message,confirmText:b.options.confirmText,cancelText:b.options.cancelText,variant:b.options.variant,loading:b.loading})]})})]}):(0,i.jsx)(c.AdminAuthForm,{onSuccess:()=>{f()}}):(0,i.jsx)(o.default,{})}e.s(["default",()=>y])}]);