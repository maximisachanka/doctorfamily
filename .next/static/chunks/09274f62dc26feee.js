(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,t,i)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"warnOnce",{enumerable:!0,get:function(){return a}});let a=e=>{}},18050,e=>{"use strict";var t=e.i(43476),i=e.i(73375),a=e.i(63059),r=e.i(26299);function s({currentPage:e,totalPages:s,onPageChange:l,className:n=""}){if(s<=1)return null;let o=(()=>{let t=[];if(s<=5)for(let e=1;e<=s;e++)t.push(e);else{t.push(1),e>3&&t.push("...");let i=Math.max(2,e-1),a=Math.min(s-1,e+1);for(let e=i;e<=a;e++)t.push(e);e<s-2&&t.push("..."),t.push(s)}return t})();return(0,t.jsxs)("div",{className:`flex items-center justify-center gap-2 ${n}`,children:[(0,t.jsx)(r.Button,{onClick:()=>l(e-1),disabled:1===e,variant:"outline",className:"h-10 w-10 p-0 border-gray-300 hover:bg-gray-50 disabled:opacity-50 cursor-pointer disabled:cursor-not-allowed hidden sm:flex items-center justify-center",children:(0,t.jsx)(i.ChevronLeft,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{className:"flex sm:hidden items-center gap-2",children:[(0,t.jsx)(r.Button,{onClick:()=>l(e-1),disabled:1===e,variant:"outline",className:"h-10 px-3 border-gray-300 hover:bg-gray-50 disabled:opacity-50 cursor-pointer disabled:cursor-not-allowed",children:(0,t.jsx)(i.ChevronLeft,{className:"w-4 h-4"})}),(0,t.jsxs)("span",{className:"text-sm text-gray-700 min-w-[80px] text-center",children:[e," / ",s]}),(0,t.jsx)(r.Button,{onClick:()=>l(e+1),disabled:e===s,variant:"outline",className:"h-10 px-3 border-gray-300 hover:bg-gray-50 disabled:opacity-50 cursor-pointer disabled:cursor-not-allowed",children:(0,t.jsx)(a.ChevronRight,{className:"w-4 h-4"})})]}),(0,t.jsx)("div",{className:"hidden sm:flex items-center gap-2",children:o.map((i,a)=>{if("..."===i)return(0,t.jsx)("span",{className:"px-2 text-gray-500",children:"..."},`ellipsis-${a}`);let s=i===e;return(0,t.jsx)(r.Button,{onClick:()=>l(i),variant:s?"default":"outline",className:`h-10 w-10 p-0 cursor-pointer ${s?"bg-[#18A36C] hover:bg-[#18A36C]/90 text-white border-[#18A36C]":"border-gray-300 hover:bg-gray-50 text-gray-700"}`,children:i},i)})}),(0,t.jsx)(r.Button,{onClick:()=>l(e+1),disabled:e===s,variant:"outline",className:"h-10 w-10 p-0 border-gray-300 hover:bg-gray-50 disabled:opacity-50 cursor-pointer disabled:cursor-not-allowed hidden sm:flex items-center justify-center",children:(0,t.jsx)(a.ChevronRight,{className:"w-5 h-5"})})]})}e.s(["Pagination",()=>s])},9056,e=>{"use strict";var t=e.i(43476),i=e.i(26999),a=e.i(95926),r=e.i(46932),s=e.i(80809);function l({...e}){return(0,t.jsx)(i.Root,{"data-slot":"sheet",...e})}function n({...e}){return(0,t.jsx)(i.Trigger,{"data-slot":"sheet-trigger",...e})}function o({...e}){return(0,t.jsx)(i.Portal,{"data-slot":"sheet-portal",...e})}let d={hidden:{opacity:0},visible:{opacity:1}},c={left:{hidden:{x:"-100%"},visible:{x:0}},right:{hidden:{x:"100%"},visible:{x:0}},top:{hidden:{y:"-100%"},visible:{y:0}},bottom:{hidden:{y:"100%"},visible:{y:0}}};function u({className:e,children:l,side:n="right",...u}){return(0,t.jsxs)(o,{children:[(0,t.jsx)(i.Overlay,{asChild:!0,children:(0,t.jsx)(r.motion.div,{"data-slot":"sheet-overlay",className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm",initial:"hidden",animate:"visible",exit:"hidden",variants:d,transition:{duration:.3,ease:"easeOut"}})}),(0,t.jsx)(i.Content,{asChild:!0,...u,children:(0,t.jsxs)(r.motion.div,{"data-slot":"sheet-content",className:(0,s.cn)("bg-background fixed z-50 flex flex-col shadow-2xl","right"===n&&"inset-y-0 right-0 h-full w-3/4 border-none sm:max-w-sm","left"===n&&"inset-y-0 left-0 h-full w-3/4 border-none sm:max-w-sm","top"===n&&"inset-x-0 top-0 h-auto border-b","bottom"===n&&"inset-x-0 bottom-0 h-auto border-t",e),initial:"hidden",animate:"visible",exit:"hidden",variants:c[n],transition:{type:"spring",damping:30,stiffness:300,mass:.8},children:[l,(0,t.jsxs)(i.Close,{className:"ring-offset-background focus:ring-ring absolute top-4 right-4 rounded-full w-8 h-8 flex items-center justify-center bg-gray-100 hover:bg-gray-200 transition-all duration-200 hover:scale-110 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none z-10",children:[(0,t.jsx)(a.XIcon,{className:"size-4 text-gray-600"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})})]})}function g({className:e,...i}){return(0,t.jsx)("div",{"data-slot":"sheet-header",className:(0,s.cn)("flex flex-col gap-1.5 p-4",e),...i})}function m({className:e,...a}){return(0,t.jsx)(i.Title,{"data-slot":"sheet-title",className:(0,s.cn)("text-foreground font-semibold",e),...a})}function h({className:e,...a}){return(0,t.jsx)(i.Description,{"data-slot":"sheet-description",className:(0,s.cn)("text-muted-foreground text-sm",e),...a})}e.s(["Sheet",()=>l,"SheetContent",()=>u,"SheetDescription",()=>h,"SheetHeader",()=>g,"SheetTitle",()=>m,"SheetTrigger",()=>n])},19964,e=>{"use strict";var t=e.i(43476),i=e.i(80809);function a({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,i.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border",e),...a})}function r({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,i.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 pt-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...a})}function s({className:e,...a}){return(0,t.jsx)("h4",{"data-slot":"card-title",className:(0,i.cn)("leading-none",e),...a})}function l({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,i.cn)("px-6 [&:last-child]:pb-6",e),...a})}e.s(["Card",()=>a,"CardContent",()=>l,"CardHeader",()=>r,"CardTitle",()=>s])},87316,e=>{"use strict";let t=(0,e.i(75254).default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);e.s(["Calendar",()=>t],87316)},70756,e=>{"use strict";let t=(0,e.i(75254).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["Lock",()=>t],70756)},69524,e=>{"use strict";var t=e.i(43476),i=e.i(46932),a=e.i(88653),r=e.i(78894),s=e.i(37727),l=e.i(26299);function n({isOpen:e,onClose:n,onConfirm:o,title:d,message:c,confirmText:u="Удалить",cancelText:g="Отмена",variant:m="danger",loading:h=!1}){return e?(0,t.jsx)(a.AnimatePresence,{children:e&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[9998]"}),(0,t.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",children:(0,t.jsxs)(i.motion.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",duration:.3},className:"bg-white rounded-2xl shadow-2xl max-w-md w-full overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("div",{className:`px-6 py-5 border-b border-gray-100 ${"danger"===m?"bg-red-50":"bg-yellow-50"}`,children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${"danger"===m?"bg-red-100":"bg-yellow-100"}`,children:(0,t.jsx)(r.AlertTriangle,{className:`w-6 h-6 ${"danger"===m?"text-red-600":"text-yellow-600"}`})}),(0,t.jsx)("div",{children:(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:d})})]}),(0,t.jsx)("button",{onClick:n,disabled:h,className:"text-gray-400 hover:text-gray-600 transition-colors disabled:opacity-50 cursor-pointer",children:(0,t.jsx)(s.X,{className:"w-5 h-5"})})]})}),(0,t.jsx)("div",{className:"px-6 py-5",children:(0,t.jsx)("p",{className:"text-gray-600 leading-relaxed",children:c})}),(0,t.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-100 flex items-center justify-end gap-3",children:[(0,t.jsx)(l.Button,{onClick:n,disabled:h,variant:"ghost",className:"px-5 py-2.5 cursor-pointer",children:g}),(0,t.jsx)("button",{onClick:()=>{o()},disabled:h,className:`px-5 py-2.5 rounded-xl font-medium transition-all disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer ${"danger"===m?"bg-red-600 hover:bg-red-700 text-white shadow-lg shadow-red-600/30":"bg-yellow-600 hover:bg-yellow-700 text-white shadow-lg shadow-yellow-600/30"}`,children:h?(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),(0,t.jsx)("span",{children:"Удаление..."})]}):u})]})]})})]})}):null}e.s(["ConfirmDialog",()=>n])},91900,e=>{"use strict";var t=e.i(71645);function i(){let[e,i]=(0,t.useState)(!1),[a,r]=(0,t.useState)(!1),[s,l]=(0,t.useState)({title:"",message:""}),[n,o]=(0,t.useState)(null),d=(0,t.useCallback)(e=>(l(e),i(!0),r(!1),new Promise(e=>{o({resolve:e})})),[]);return{confirm:d,isOpen:e,loading:a,options:s,handleConfirm:(0,t.useCallback)(async()=>{n&&(r(!0),await new Promise(e=>setTimeout(e,300)),n.resolve(!0),i(!1),r(!1),o(null))},[n]),handleCancel:(0,t.useCallback)(()=>{n&&(n.resolve(!1),i(!1),r(!1),o(null))},[n])}}e.s(["useConfirmDialog",()=>i])},13849,e=>{"use strict";var t=e.i(18566),i=e.i(71645);function a(r=12){let s=function(){try{let{useSearchParams:t}=e.r(18566);return t()}catch{return null}}(),l=(0,t.useRouter)(),n=(0,t.usePathname)(),o=(0,i.useMemo)(()=>{if(!s)return 1;let e=s.get("p"),t=e?parseInt(e,10):1;return t>0?t:1},[s]),d=(0,i.useCallback)(e=>{let t=new URLSearchParams(s?.toString()||"");1===e?t.delete("p"):t.set("p",e.toString());let i=t.toString(),a=i?`${n}?${i}`:n;l.replace(a,{scroll:!1})},[s,n,l]),c=(0,i.useCallback)((e,t)=>{let i=new URLSearchParams;return i.set("page",o.toString()),i.set("limit",r.toString()),t&&i.set("search",t),`${e}?${i.toString()}`},[o,r]);return{currentPage:o,setPage:d,buildApiUrl:c,itemsPerPage:r}}e.s(["useServerPagination",()=>a])},20230,e=>{"use strict";var t=e.i(43476),i=e.i(71645);function a(e){let[a,r]=(0,i.useState)(!1),{src:s,alt:l,style:n,className:o,...d}=e;return a||!s?(0,t.jsx)("div",{className:`inline-block bg-gray-100 text-center align-middle ${o??""}`,style:n,children:(0,t.jsx)("div",{className:"flex items-center justify-center w-full h-full",children:(0,t.jsx)("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODgiIGhlaWdodD0iODgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBvcGFjaXR5PSIuMyIgZmlsbD0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIzLjciPjxyZWN0IHg9IjE2IiB5PSIxNiIgd2lkdGg9IjU2IiBoZWlnaHQ9IjU2IiByeD0iNiIvPjxwYXRoIGQ9Im0xNiA1OCAxNi0xOCAzMiAzMiIvPjxjaXJjbGUgY3g9IjUzIiBjeT0iMzUiIHI9IjciLz48L3N2Zz4KCg==",alt:l||"Нет фото",...d,"data-original-url":s})})}):(0,t.jsx)("img",{src:s,alt:l,className:o,style:n,...d,onError:()=>{r(!0)}})}e.s(["ImageWithFallback",()=>a])},31171,e=>{"use strict";let t=(0,e.i(75254).default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);e.s(["default",()=>t])},64659,e=>{"use strict";var t=e.i(31171);e.s(["ChevronDown",()=>t.default])},25276,e=>{"use strict";var t=e.i(43476),i=e.i(71645),a=e.i(17255),r=e.i(88653),s=e.i(50965),l=e.i(18050),n=e.i(1558),o=e.i(64659);function d({images:e,onChange:a,folder:r,maxSizeMB:s=10}){let l=[{key:"image_url",label:"Главное изображение",value:e.image_url},{key:"image_url_1",label:"Изображение 1",value:e.image_url_1},{key:"image_url_2",label:"Изображение 2",value:e.image_url_2},{key:"image_url_3",label:"Изображение 3",value:e.image_url_3},{key:"image_url_4",label:"Изображение 4 (опционально)",value:e.image_url_4}],[d,c]=(0,i.useState)(l[0].key),u=l.find(e=>e.key===d)||l[0];return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Выберите слот изображения"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("select",{value:d,onChange:e=>c(e.target.value),className:"w-full px-4 py-3 bg-white border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#18A36C] focus:border-transparent appearance-none cursor-pointer transition-all",children:l.map(e=>(0,t.jsxs)("option",{value:e.key,children:[e.label,e.value?" ✓":""]},e.key))}),(0,t.jsx)(o.ChevronDown,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none"})]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4 border border-gray-200",children:[(0,t.jsx)("p",{className:"text-xs font-medium text-gray-600 mb-3",children:"Загруженные изображения:"}),(0,t.jsx)("div",{className:"grid grid-cols-5 gap-2",children:l.map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>c(e.key),className:`relative aspect-square rounded-lg overflow-hidden border-2 transition-all ${d===e.key?"border-[#18A36C] ring-2 ring-[#18A36C]/20":"border-gray-200 hover:border-gray-300"}`,title:e.label,children:[e.value?(0,t.jsx)("img",{src:e.value,alt:e.label,className:"w-full h-full object-cover"}):(0,t.jsx)("div",{className:"w-full h-full bg-gray-100 flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-xs text-gray-400 font-medium",children:"image_url"===e.key?"Главное":e.key.replace("image_url_","")})}),d===e.key&&(0,t.jsx)("div",{className:"absolute inset-0 bg-[#18A36C]/10 flex items-center justify-center",children:(0,t.jsx)("div",{className:"w-6 h-6 bg-[#18A36C] rounded-full flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})})]},e.key))})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl p-4 border-2 border-dashed border-gray-300",children:[(0,t.jsxs)("p",{className:"text-sm font-medium text-gray-700 mb-3",children:["Загрузка для: ",(0,t.jsx)("span",{className:"text-[#18A36C]",children:u.label})]}),(0,t.jsx)(n.ImageUploader,{value:u.value,onChange:e=>a(d,e),folder:r,placeholder:`Загрузите ${u.label.toLowerCase()}`,maxSizeMB:s})]})]})}var c=e.i(75961),u=e.i(13849),g=e.i(4125),m=e.i(29306),h=e.i(18026),x=e.i(45347),p=e.i(86633),b=e.i(73250),y=e.i(20230),v=e.i(69524),f=e.i(91900),j=e.i(63059);let _=(0,e.i(75254).default)("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var N=e.i(95468);function w({categories:e,value:i,onChange:a,placeholder:r="Выберите категорию",maxHeight:s="320px",showHeader:l=!0,showFooter:n=!0}){let o=i?parseInt(i.toString()):null;return(0,t.jsxs)("div",{className:"w-full border border-gray-200 rounded-xl bg-white overflow-hidden",children:[l&&(0,t.jsx)("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:(0,t.jsx)("p",{className:"text-sm text-gray-600",children:o&&e.find(e=>e.id===o)?.name||r})}),(0,t.jsx)("div",{className:"overflow-y-auto",style:{maxHeight:s},children:e.map(e=>{let i=e.id===o,r=e.disabled;return(0,t.jsx)("div",{onClick:()=>!r&&a(e.id.toString()),className:`
                px-4 py-3 border-b border-gray-100 transition-all cursor-pointer
                ${r?"bg-gray-50 cursor-not-allowed opacity-60":"hover:bg-[#18A36C]/5 hover:border-l-4 hover:border-l-[#18A36C]"}
                ${i&&!r?"bg-[#18A36C]/10 border-l-4 border-l-[#18A36C]":"border-l-4 border-l-transparent"}
              `,style:{paddingLeft:`${16+20*e.level}px`},children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.level>0&&(0,t.jsx)(j.ChevronRight,{className:"w-3 h-3 text-gray-400 flex-shrink-0"}),i?(0,t.jsx)(N.CheckCircle2,{className:"w-4 h-4 text-[#18A36C] flex-shrink-0"}):(0,t.jsx)(_,{className:"w-4 h-4 text-gray-300 flex-shrink-0"}),(0,t.jsx)("span",{className:`
                    text-sm flex-1 truncate
                    ${r?"text-gray-400":"text-gray-800"}
                    ${i?"font-semibold text-[#18A36C]":""}
                  `,children:e.name})]}),r&&e.disabledReason&&(0,t.jsx)("span",{className:"text-xs text-gray-400 italic flex-shrink-0",children:e.disabledReason})]})},e.id)})}),n&&(0,t.jsx)("div",{className:"px-4 py-2 bg-gray-50 border-t border-gray-200",children:(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Доступны только категории без подкатегорий"})})]})}function C(){let{status:e}=(0,a.useSession)(),{sessionVerified:n,isLoading:o,verifySession:j}=(0,x.useAdminSession)(),[_,N]=(0,i.useState)(null),[C,k]=(0,i.useState)(!0),{success:S,error:A}=(0,p.useAlert)(),I=(0,f.useConfirmDialog)(),{currentPage:P,setPage:B,buildApiUrl:F}=(0,u.useServerPagination)(12),[T,$]=(0,i.useState)([]),[M,z]=(0,i.useState)(1),[L,D]=(0,i.useState)(0),[R,O]=(0,i.useState)([]),[U,E]=(0,i.useState)([]),[H,W]=(0,i.useState)(!1),[Z,q]=(0,i.useState)(""),[G,X]=(0,i.useState)(!1),[J,Y]=(0,i.useState)(null),[K,Q]=(0,i.useState)(!1),[V,ee]=(0,i.useState)({title:"",subtitle:"",price:"",video_url:"",description:"",image_url:"",image_url_1:"",image_url_2:"",image_url_3:"",image_url_4:"",specialist_ids:[],service_category_id:""});(0,i.useEffect)(()=>{"authenticated"===e?et():"unauthenticated"===e&&N(!1)},[e]),(0,i.useEffect)(()=>{n&&_&&ei()},[n,_,P,Z]);let et=async()=>{k(!0);try{let e=await fetch("/api/admin/auth"),t=await e.json();N(t.isAdmin)}catch(e){N(!1)}finally{k(!1)}},ei=async()=>{W(!0);try{let e=F("/api/admin/services",Z),[t,i,a]=await Promise.all([fetch(e),fetch("/api/service-categories"),fetch("/api/specialists")]);if(t.ok){let e=await t.json();$(e.data||[]),z(e.totalPages||1),D(e.totalCount||0)}if(i.ok){let e=await i.json();O(e)}if(a.ok){let e=await a.json();E(e)}}catch(e){console.error("Error loading data:",e),A("Ошибка загрузки данных")}finally{W(!1)}};(0,i.useEffect)(()=>{B(1)},[Z]);let ea=(0,i.useMemo)(()=>{let e=new Set(T.filter(e=>e.service_category_id&&(!J||e.id!==J.id)).map(e=>e.service_category_id)),t=(i,a=0)=>{let r=[];for(let s of i){let i=s.children&&s.children.length>0,l=e.has(s.id),n=!1,o="";i?(n=!0,o="имеет подкатегории"):l&&(n=!0,o="уже занята"),r.push({...s,level:a,disabled:n,disabledReason:o}),s.children&&s.children.length>0&&r.push(...t(s.children,a+1))}return r};return t(R)},[R,T,J]),er=()=>{ee({title:"",subtitle:"",price:"",video_url:"",description:"",image_url:"",image_url_1:"",image_url_2:"",image_url_3:"",image_url_4:"",specialist_ids:[],service_category_id:""}),Y(null),X(!1)},es=()=>{er(),X(!0)},el=async()=>{Q(!0);try{let e=J?`/api/admin/services/${J.id}`:"/api/admin/services",t=J?"PUT":"POST",i=await fetch(e,{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify(V)});if(i.ok)await ei(),er(),S(J?"Услуга обновлена":"Услуга создана");else{let e=await i.json();A(e.error||"Ошибка сохранения")}}catch(e){A("Ошибка сохранения")}finally{Q(!1)}},en=async(e,t)=>{if(await I.confirm({title:"Удаление услуги",message:`Вы уверены, что хотите удалить услугу "${t}"? Это действие нельзя отменить.`,confirmText:"Удалить",cancelText:"Отмена",variant:"danger"}))try{let t=await fetch(`/api/admin/services/${e}`,{method:"DELETE"});if(t.ok)await ei(),S("Услуга удалена");else{let e=await t.json();A(e.error||"Ошибка удаления")}}catch(e){A("Ошибка удаления")}};return"loading"===e||null===_||o||C?(0,t.jsx)(b.AdminAccessSkeleton,{}):"unauthenticated"===e||!1===_?(0,t.jsx)(m.default,{}):n?(0,t.jsxs)("div",{className:"flex min-h-screen bg-gray-50",children:[(0,t.jsx)(c.AdminMenu,{}),(0,t.jsx)("div",{className:"flex-1 p-4 lg:p-8 overflow-auto",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsx)(g.AdminSection,{title:"Услуги",icon:s.ShoppingBag,count:L,loading:H,searchValue:Z,onSearchChange:q,onAdd:es,addButtonText:"Добавить услугу",children:0===T.length?(0,t.jsx)(g.EmptyState,{icon:s.ShoppingBag,title:"Услуги не найдены",description:Z?"Попробуйте изменить поисковый запрос":"Добавьте первую услугу",actionText:Z?void 0:"Добавить услугу",onAction:Z?void 0:es}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:(0,t.jsx)(r.AnimatePresence,{children:T.map(e=>(0,t.jsxs)(g.ItemCard,{children:[(0,t.jsx)("div",{className:"w-full h-32 rounded-xl overflow-hidden bg-gray-100 mb-3",children:(0,t.jsx)(y.ImageWithFallback,{src:e.image_url,alt:e.title,className:"w-full h-full object-cover"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-800 line-clamp-1",children:e.title}),(0,t.jsx)("p",{className:"text-sm text-gray-500 line-clamp-2 mt-1",children:e.subtitle})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-3 flex-wrap",children:[e.serviceCategory&&(0,t.jsx)(g.Badge,{variant:"primary",children:e.serviceCategory.name}),(0,t.jsxs)(g.Badge,{variant:"success",children:[e.price," BYN"]})]}),e.specialists.length>0&&(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsxs)(g.Badge,{variant:"secondary",children:["Специалисты (",e.specialists.length,")"]})}),(0,t.jsx)("div",{className:"flex items-center justify-end mt-4 pt-4 border-t border-gray-100",children:(0,t.jsx)(g.CardActions,{onEdit:()=>{Y(e),ee({title:e.title,subtitle:e.subtitle,price:e.price.toString(),video_url:e.video_url,description:e.description,image_url:e.image_url,image_url_1:e.image_url_1,image_url_2:e.image_url_2,image_url_3:e.image_url_3,image_url_4:e.image_url_4||"",specialist_ids:e.specialists.map(e=>e.id.toString()),service_category_id:e.service_category_id?.toString()||""}),X(!0)},onDelete:()=>en(e.id,e.title)})})]},e.id))})}),M>1&&(0,t.jsx)(l.Pagination,{currentPage:P,totalPages:M,onPageChange:B,className:"mt-6"})]})}),(0,t.jsx)(g.FormModal,{isOpen:G,onClose:er,title:J?"Редактирование услуги":"Новая услуга",onSubmit:el,loading:K,disabled:!V.title||!V.subtitle||!V.price||!V.service_category_id||0===V.specialist_ids.length,children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsx)(g.FormField,{label:"Название",required:!0,children:(0,t.jsx)(g.FormInput,{type:"text",value:V.title,onChange:e=>ee({...V,title:e.target.value}),placeholder:"Лечение кариеса"})}),(0,t.jsx)(g.FormField,{label:"Цена (BYN)",required:!0,children:(0,t.jsx)(g.FormInput,{type:"number",value:V.price,onChange:e=>ee({...V,price:e.target.value}),placeholder:"100"})})]}),(0,t.jsx)(g.FormField,{label:"Подзаголовок",required:!0,children:(0,t.jsx)(g.FormInput,{type:"text",value:V.subtitle,onChange:e=>ee({...V,subtitle:e.target.value}),placeholder:"Краткое описание услуги"})}),(0,t.jsx)(g.FormField,{label:"Категория услуги",required:!0,children:(0,t.jsx)(w,{categories:ea,value:V.service_category_id,onChange:e=>ee({...V,service_category_id:e}),placeholder:"Выберите категорию"})}),(0,t.jsx)("div",{className:"grid grid-cols-1 gap-4",children:(0,t.jsxs)(g.FormField,{label:"Специалисты",required:!0,children:[(0,t.jsx)("div",{className:"space-y-2 max-h-48 overflow-y-auto border border-gray-200 rounded-xl p-3 bg-gray-50",children:U.map(e=>(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-100 p-2 rounded-lg transition-colors",children:[(0,t.jsx)("input",{type:"checkbox",checked:V.specialist_ids.includes(e.id.toString()),onChange:t=>{t.target.checked?ee({...V,specialist_ids:[...V.specialist_ids,e.id.toString()]}):ee({...V,specialist_ids:V.specialist_ids.filter(t=>t!==e.id.toString())})},className:"w-4 h-4 text-[#18A36C] border-gray-300 rounded focus:ring-[#18A36C]"}),(0,t.jsx)("span",{className:"text-sm text-gray-700",children:e.name})]},e.id))}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Выбрано: ",V.specialist_ids.length]})]})}),(0,t.jsx)(g.FormField,{label:"Описание",children:(0,t.jsx)(g.FormTextarea,{value:V.description,onChange:e=>ee({...V,description:e.target.value}),rows:4,placeholder:"Полное описание услуги..."})}),(0,t.jsx)(g.FormField,{label:"Ссылка на видео (YouTube)",children:(0,t.jsx)(g.FormInput,{type:"text",value:V.video_url,onChange:e=>ee({...V,video_url:e.target.value}),placeholder:"https://youtube.com/watch?v=..."})}),(0,t.jsxs)("div",{className:"border-t border-gray-100 pt-6",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-700 mb-4",children:"Изображения услуги"}),(0,t.jsx)(d,{images:{image_url:V.image_url,image_url_1:V.image_url_1,image_url_2:V.image_url_2,image_url_3:V.image_url_3,image_url_4:V.image_url_4},onChange:(e,t)=>ee({...V,[e]:t}),folder:"smartmedical/services",maxSizeMB:10})]})]})}),(0,t.jsx)(v.ConfirmDialog,{isOpen:I.isOpen,onClose:I.handleCancel,onConfirm:I.handleConfirm,title:I.options.title,message:I.options.message,confirmText:I.options.confirmText,cancelText:I.options.cancelText,variant:I.options.variant,loading:I.loading})]})})]}):(0,t.jsx)(h.AdminAuthForm,{onSuccess:()=>{j()}})}e.s(["default",()=>C],25276)}]);