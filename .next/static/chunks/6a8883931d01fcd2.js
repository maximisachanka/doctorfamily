(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"warnOnce",{enumerable:!0,get:function(){return a}});let a=e=>{}},69524,91900,e=>{"use strict";var t=e.i(43476),s=e.i(46932),a=e.i(88653),i=e.i(78894),l=e.i(37727),r=e.i(26299);function n({isOpen:e,onClose:n,onConfirm:d,title:c,message:o,confirmText:m="Удалить",cancelText:x="Отмена",variant:h="danger",loading:u=!1}){return e?(0,t.jsx)(a.AnimatePresence,{children:e&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[9998]"}),(0,t.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",children:(0,t.jsxs)(s.motion.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",duration:.3},className:"bg-white rounded-2xl shadow-2xl max-w-md w-full overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("div",{className:`px-6 py-5 border-b border-gray-100 ${"danger"===h?"bg-red-50":"bg-yellow-50"}`,children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${"danger"===h?"bg-red-100":"bg-yellow-100"}`,children:(0,t.jsx)(i.AlertTriangle,{className:`w-6 h-6 ${"danger"===h?"text-red-600":"text-yellow-600"}`})}),(0,t.jsx)("div",{children:(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:c})})]}),(0,t.jsx)("button",{onClick:n,disabled:u,className:"text-gray-400 hover:text-gray-600 transition-colors disabled:opacity-50",children:(0,t.jsx)(l.X,{className:"w-5 h-5"})})]})}),(0,t.jsx)("div",{className:"px-6 py-5",children:(0,t.jsx)("p",{className:"text-gray-600 leading-relaxed",children:o})}),(0,t.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-100 flex items-center justify-end gap-3",children:[(0,t.jsx)(r.Button,{onClick:n,disabled:u,variant:"ghost",className:"px-5 py-2.5",children:x}),(0,t.jsx)("button",{onClick:()=>{d()},disabled:u,className:`px-5 py-2.5 rounded-xl font-medium transition-all disabled:opacity-50 disabled:cursor-not-allowed ${"danger"===h?"bg-red-600 hover:bg-red-700 text-white shadow-lg shadow-red-600/30":"bg-yellow-600 hover:bg-yellow-700 text-white shadow-lg shadow-yellow-600/30"}`,children:u?(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),(0,t.jsx)("span",{children:"Удаление..."})]}):m})]})]})})]})}):null}e.s(["ConfirmDialog",()=>n],69524);var d=e.i(71645);function c(){let[e,t]=(0,d.useState)(!1),[s,a]=(0,d.useState)(!1),[i,l]=(0,d.useState)({title:"",message:""}),[r,n]=(0,d.useState)(null),c=(0,d.useCallback)(e=>(l(e),t(!0),a(!1),new Promise(e=>{n({resolve:e})})),[]);return{confirm:c,isOpen:e,loading:s,options:i,handleConfirm:(0,d.useCallback)(async()=>{r&&(a(!0),await new Promise(e=>setTimeout(e,300)),r.resolve(!0),t(!1),a(!1),n(null))},[r]),handleCancel:(0,d.useCallback)(()=>{r&&(r.resolve(!1),t(!1),a(!1),n(null))},[r])}}e.s(["useConfirmDialog",()=>c],91900)},87690,e=>{"use strict";e.i(51651),e.i(5901),e.i(86633),e.s([])},18050,e=>{"use strict";var t=e.i(43476),s=e.i(73375),a=e.i(63059),i=e.i(26299);function l({currentPage:e,totalPages:l,onPageChange:r,className:n=""}){if(l<=1)return null;let d=(()=>{let t=[];if(l<=5)for(let e=1;e<=l;e++)t.push(e);else{t.push(1),e>3&&t.push("...");let s=Math.max(2,e-1),a=Math.min(l-1,e+1);for(let e=s;e<=a;e++)t.push(e);e<l-2&&t.push("..."),t.push(l)}return t})();return(0,t.jsxs)("div",{className:`flex items-center justify-center gap-2 ${n}`,children:[(0,t.jsx)(i.Button,{onClick:()=>r(e-1),disabled:1===e,variant:"outline",className:"h-10 w-10 p-0 border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed hidden sm:flex items-center justify-center",children:(0,t.jsx)(s.ChevronLeft,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{className:"flex sm:hidden items-center gap-2",children:[(0,t.jsx)(i.Button,{onClick:()=>r(e-1),disabled:1===e,variant:"outline",className:"h-10 px-3 border-gray-300 hover:bg-gray-50 disabled:opacity-50",children:(0,t.jsx)(s.ChevronLeft,{className:"w-4 h-4"})}),(0,t.jsxs)("span",{className:"text-sm text-gray-700 min-w-[80px] text-center",children:[e," / ",l]}),(0,t.jsx)(i.Button,{onClick:()=>r(e+1),disabled:e===l,variant:"outline",className:"h-10 px-3 border-gray-300 hover:bg-gray-50 disabled:opacity-50",children:(0,t.jsx)(a.ChevronRight,{className:"w-4 h-4"})})]}),(0,t.jsx)("div",{className:"hidden sm:flex items-center gap-2",children:d.map((s,a)=>{if("..."===s)return(0,t.jsx)("span",{className:"px-2 text-gray-500",children:"..."},`ellipsis-${a}`);let l=s===e;return(0,t.jsx)(i.Button,{onClick:()=>r(s),variant:l?"default":"outline",className:`h-10 w-10 p-0 ${l?"bg-[#18A36C] hover:bg-[#18A36C]/90 text-white border-[#18A36C]":"border-gray-300 hover:bg-gray-50 text-gray-700"}`,children:s},s)})}),(0,t.jsx)(i.Button,{onClick:()=>r(e+1),disabled:e===l,variant:"outline",className:"h-10 w-10 p-0 border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed hidden sm:flex items-center justify-center",children:(0,t.jsx)(a.ChevronRight,{className:"w-5 h-5"})})]})}e.s(["Pagination",()=>l])},69074,e=>{"use strict";let t=(0,e.i(75254).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);e.s(["Upload",()=>t],69074)},1558,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(69074),i=e.i(37727),l=e.i(31278),r=e.i(69638),n=e.i(86633);function d({value:e,onChange:d,folder:c="smartmedical",placeholder:o="Загрузить фото",className:m="",maxSizeMB:x=10}){let[h,u]=(0,s.useState)("idle"),[g,p]=(0,s.useState)(e||""),f=(0,s.useRef)(null),{success:j,error:b}=(0,n.useAlert)();(0,s.useEffect)(()=>{void 0!==e&&p(e)},[e]);let v=(0,s.useCallback)(async t=>{if(!["image/jpeg","image/png","image/webp","image/gif"].includes(t.type)){b("Только JPG, PNG, WebP, GIF"),u("error");return}if(t.size>1024*x*1024){b(`Максимальный размер: ${x}MB`),u("error");return}u("uploading");let s=URL.createObjectURL(t);p(s);try{let e=new FormData;e.append("file",t),e.append("folder",c);let s=await fetch("/api/upload",{method:"POST",body:e}),a=await s.json();if(!s.ok)throw Error(a.error||"Ошибка загрузки");p(a.data.url),d(a.data.url),u("success"),j("Изображение успешно загружено"),setTimeout(()=>u("idle"),2e3)}catch(t){b(t instanceof Error?t.message:"Ошибка загрузки"),u("error"),p(e||"")}finally{URL.revokeObjectURL(s)}},[c,x,d,e,j,b]);return(0,t.jsxs)("div",{className:`flex items-start gap-4 ${m}`,children:[(0,t.jsx)("input",{ref:f,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",onChange:e=>{let t=e.target.files?.[0];t&&v(t)},className:"hidden"}),(0,t.jsxs)("div",{className:"relative",children:[g?(0,t.jsxs)("div",{className:"relative w-48 h-48 rounded-2xl overflow-hidden bg-gray-100 shadow-sm border border-gray-200",children:[(0,t.jsx)("img",{src:g,alt:"Preview",className:"w-full h-full object-cover"}),"uploading"===h&&(0,t.jsx)("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center",children:(0,t.jsx)(l.Loader2,{className:"w-10 h-10 text-white animate-spin"})}),"success"===h&&(0,t.jsx)("div",{className:"absolute bottom-2 right-2 w-8 h-8 rounded-full bg-green-500 flex items-center justify-center shadow-lg",children:(0,t.jsx)(r.CheckCircle,{className:"w-5 h-5 text-white"})})]}):(0,t.jsxs)("div",{onClick:()=>"uploading"!==h&&f.current?.click(),className:"w-48 h-48 rounded-2xl bg-gray-100 border-2 border-dashed border-gray-300 flex flex-col items-center justify-center cursor-pointer hover:border-[#18A36C] hover:bg-gray-50 transition-colors",children:[(0,t.jsx)(a.Upload,{className:"w-10 h-10 text-gray-400 mb-2"}),(0,t.jsx)("span",{className:"text-sm text-gray-500 text-center px-4",children:"Нажмите для загрузки"})]}),g&&"uploading"!==h&&(0,t.jsx)("button",{type:"button",onClick:()=>{p(""),d(""),u("idle"),f.current&&(f.current.value="")},className:"absolute -top-3 -right-3 w-8 h-8 rounded-full bg-red-500 hover:bg-red-600 flex items-center justify-center shadow-lg transition-colors z-10",children:(0,t.jsx)(i.X,{className:"w-4 h-4 text-white"})})]}),(0,t.jsxs)("div",{className:"flex-1 pt-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>"uploading"!==h&&f.current?.click(),disabled:"uploading"===h,className:"px-5 py-2.5 bg-[#18A36C] hover:bg-[#149259] disabled:bg-gray-300 rounded-xl text-sm font-medium text-white transition-colors flex items-center gap-2 shadow-sm",children:"uploading"===h?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.Loader2,{className:"w-4 h-4 animate-spin"}),"Загрузка..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.Upload,{className:"w-4 h-4"}),g?"Заменить фото":o]})}),(0,t.jsxs)("p",{className:"text-xs text-gray-400 mt-3",children:["JPG, PNG, WebP, GIF до ",x,"MB"]})]})]})}e.s(["ImageUploader",()=>d])},94662,e=>{"use strict";e.i(1558),e.s([])},68707,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(17255),i=e.i(88653),l=e.i(46932),r=e.i(86311),n=e.i(31278),d=e.i(70273),c=e.i(87316),o=e.i(69638),m=e.i(3116),x=e.i(78745),x=x,h=e.i(86536),u=e.i(37727),g=e.i(18050);e.i(94662);var p=e.i(1558),f=e.i(75961),j=e.i(4125),b=e.i(29306),v=e.i(18026),y=e.i(45347),w=e.i(73250),N=e.i(69524),C=e.i(91900);e.i(87690);var k=e.i(86633),S=e.i(42002);function A(){let{status:e}=(0,a.useSession)(),{sessionVerified:A,isLoading:P,verifySession:F}=(0,y.useAdminSession)(),[T,_]=(0,s.useState)(null),[$,U]=(0,s.useState)(!0),L=(0,C.useConfirmDialog)(),{success:B,error:M}=(0,k.useAlert)(),{refetch:O}=(0,S.useUnreadCountsContext)(),[D,E]=(0,s.useState)([]),[R,I]=(0,s.useState)([]),[q,z]=(0,s.useState)(!1),[G,X]=(0,s.useState)(""),[J,K]=(0,s.useState)(1),[W,H]=(0,s.useState)("pending"),[V,Q]=(0,s.useState)(null),[Y,Z]=(0,s.useState)(null),[ee,et]=(0,s.useState)({service_id:"",verified:!0}),[es,ea]=(0,s.useState)(!1),[ei,el]=(0,s.useState)(!1),[er,en]=(0,s.useState)(null),[ed,ec]=(0,s.useState)(!1),[eo,em]=(0,s.useState)({name:"",text:"",date:"",grade:"5",image_url:"",verified:!1,service_id:""});(0,s.useEffect)(()=>{"authenticated"===e?ex():"unauthenticated"===e&&_(!1)},[e]),(0,s.useEffect)(()=>{A&&T&&eh()},[A,T]);let ex=async()=>{U(!0);try{let e=await fetch("/api/admin/auth"),t=await e.json();_(t.isAdmin)}catch(e){_(!1)}finally{U(!1)}},eh=async()=>{z(!0);try{let[e,t]=await Promise.all([fetch("/api/admin/feedbacks"),fetch("/api/services")]);if(e.ok){let t=await e.json();E(t)}if(t.ok){let e=await t.json();I(e)}}catch(e){console.error("Error loading data:",e)}finally{z(!1)}},eu=(0,s.useMemo)(()=>{let e=D;if(e="pending"===W?e.filter(e=>!e.verified):e.filter(e=>e.verified),G){let t=G.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t)||e.text.toLowerCase().includes(t)||e.service?.title.toLowerCase().includes(t))}return e},[D,G,W]),eg=(0,s.useMemo)(()=>D.filter(e=>!e.verified).length,[D]);(0,s.useEffect)(()=>{K(1)},[G,W]);let ep=Math.ceil(eu.length/12),ef=(0,s.useMemo)(()=>{let e=(J-1)*12;return eu.slice(e,e+12)},[eu,J]),ej=()=>{em({name:"",text:"",date:"",grade:"5",image_url:"",verified:!1,service_id:""}),en(null),el(!1)},eb=()=>{ej(),em(e=>({...e,date:new Date().toISOString().split("T")[0],verified:!0})),el(!0)},ev=async()=>{ec(!0);try{let e=er?`/api/admin/feedbacks/${er.id}`:"/api/admin/feedbacks",t=er?"PUT":"POST",s=await fetch(e,{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify(eo)});if(s.ok)await eh(),ej(),B(er?"Отзыв обновлен":"Отзыв создан");else{let e=await s.json();M(e.error||"Ошибка сохранения")}}catch(e){M("Ошибка сохранения")}finally{ec(!1)}},ey=e=>{Z(e),et({service_id:"",verified:!0})},ew=async()=>{if(Y){ea(!0);try{let e=await fetch(`/api/admin/feedbacks/${Y.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({verified:ee.verified,service_id:ee.service_id||null})});if(e.ok)await eh(),Z(null),B("Отзыв одобрен"),await O();else{let t=await e.json();M(t.error||"Ошибка одобрения")}}catch(e){M("Ошибка одобрения")}finally{ea(!1)}}},eN=async(e,t)=>{if(await L.confirm({title:"Удаление отзыва",message:`Вы уверены, что хотите удалить отзыв от "${t}"? Это действие нельзя отменить.`,confirmText:"Удалить",cancelText:"Отмена",variant:"danger"}))try{let t=await fetch(`/api/admin/feedbacks/${e}`,{method:"DELETE"});if(t.ok)await eh(),B("Отзыв удален"),await O();else{let e=await t.json();M(e.error||"Ошибка удаления")}}catch(e){M("Ошибка удаления")}},eC=e=>(0,t.jsx)("div",{className:"flex items-center gap-0.5",children:[1,2,3,4,5].map(s=>(0,t.jsx)(d.Star,{className:`w-4 h-4 ${s<=e?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},s))});return"loading"===e||null===T||P||$?(0,t.jsx)(w.AdminAccessSkeleton,{}):"unauthenticated"===e||!1===T?(0,t.jsx)(b.default,{}):A?(0,t.jsxs)("div",{className:"flex min-h-screen bg-gray-50",children:[(0,t.jsx)(f.AdminMenu,{}),(0,t.jsx)("div",{className:"flex-1 p-4 lg:p-8 overflow-auto",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsxs)(j.AdminSection,{title:"Отзывы",icon:r.MessageSquare,count:D.length,loading:q,searchValue:G,onSearchChange:X,onAdd:eb,addButtonText:"Добавить отзыв",loadingSkeleton:(0,t.jsx)(w.AdminFeedbacksGridSkeleton,{count:12}),children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,t.jsxs)("button",{onClick:()=>H("pending"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-2 ${"pending"===W?"bg-amber-500 text-white shadow-md":"bg-white text-gray-600 hover:bg-gray-100 border border-gray-200"}`,children:[(0,t.jsx)(m.Clock,{className:"w-4 h-4"}),"На модерации",eg>0&&(0,t.jsx)("span",{className:`px-2 py-0.5 rounded-full text-xs font-bold ${"pending"===W?"bg-white/20 text-white":"bg-amber-100 text-amber-700"}`,children:eg})]}),(0,t.jsxs)("button",{onClick:()=>H("approved"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-2 ${"approved"===W?"bg-[#18A36C] text-white shadow-md":"bg-white text-gray-600 hover:bg-gray-100 border border-gray-200"}`,children:[(0,t.jsx)(o.CheckCircle,{className:"w-4 h-4"}),"Одобренные"]})]}),0===eu.length?(0,t.jsx)(j.EmptyState,{icon:r.MessageSquare,title:"Отзывы не найдены",description:G?"Попробуйте изменить поисковый запрос":"Добавьте первый отзыв",actionText:G?void 0:"Добавить отзыв",onAction:G?void 0:eb}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(0,t.jsx)(i.AnimatePresence,{children:ef.map(e=>{var s;let a;return(0,t.jsxs)(j.ItemCard,{children:[(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)("div",{className:"w-14 h-14 rounded-full overflow-hidden flex-shrink-0 bg-gray-100 flex items-center justify-center",children:e.image_url?(0,t.jsx)("img",{src:e.image_url,alt:e.name,className:"w-full h-full object-cover"}):(0,t.jsx)("span",{className:"text-lg font-semibold text-gray-500",children:(a=(s=e.name).trim().split(/\s+/)).length>=2?(a[0][0]+a[1][0]).toUpperCase():s.slice(0,2).toUpperCase()})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-800",children:e.name}),e.verified&&(0,t.jsx)(o.CheckCircle,{className:"w-4 h-4 text-[#18A36C]"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[eC(e.grade),(0,t.jsxs)("span",{className:"text-xs text-gray-400 flex items-center gap-1",children:[(0,t.jsx)(c.Calendar,{className:"w-3 h-3"}),new Date(e.date).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"})]})]}),(0,t.jsx)("p",{className:"text-sm text-gray-500 line-clamp-2",children:e.text})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-3",children:[e.service&&(0,t.jsx)(j.Badge,{variant:"secondary",children:e.service.title}),!e.service&&(0,t.jsx)(j.Badge,{variant:"primary",children:"Без услуги"}),e.verified?(0,t.jsx)(j.Badge,{variant:"success",children:"Опубликован"}):(0,t.jsx)(j.Badge,{variant:"warning",children:"На модерации"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-gray-100",children:[e.verified?(0,t.jsx)("div",{}):(0,t.jsxs)("button",{onClick:()=>ey(e),className:"flex items-center gap-1.5 px-3 py-1.5 bg-[#18A36C] text-white text-sm font-medium rounded-lg hover:bg-[#15905f] transition-colors",children:[(0,t.jsx)(x.default,{className:"w-4 h-4"}),"Одобрить"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[e.verified?(0,t.jsx)(j.CardActions,{onEdit:()=>{en(e),em({name:e.name,text:e.text,date:new Date(e.date).toISOString().split("T")[0],grade:e.grade.toString(),image_url:e.image_url,verified:e.verified,service_id:e.service_id?.toString()||""}),el(!0)},onDelete:()=>eN(e.id,e.name)}):(0,t.jsx)("button",{onClick:()=>Q(e),className:"p-2 text-gray-400 hover:text-[#18A36C] hover:bg-[#18A36C]/10 rounded-lg transition-colors",title:"Просмотреть",children:(0,t.jsx)(h.Eye,{className:"w-4 h-4"})}),!e.verified&&(0,t.jsx)("button",{onClick:()=>eN(e.id,e.name),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"Удалить",children:(0,t.jsx)(u.X,{className:"w-4 h-4"})})]})]})]},e.id)})})}),ep>1&&(0,t.jsx)(g.Pagination,{currentPage:J,totalPages:ep,onPageChange:K,className:"mt-6"})]})]}),(0,t.jsx)(j.FormModal,{isOpen:ei,onClose:ej,title:er?"Редактирование отзыва":"Новый отзыв",onSubmit:ev,loading:ed,disabled:!eo.name||!eo.text,children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(j.FormField,{label:"Имя автора",required:!0,children:(0,t.jsx)(j.FormInput,{type:"text",value:eo.name,onChange:e=>em({...eo,name:e.target.value}),placeholder:"Иван Иванов"})}),(0,t.jsx)(j.FormField,{label:"Дата",required:!0,children:(0,t.jsx)(j.FormDateInput,{value:eo.date,onChange:e=>em({...eo,date:e})})})]}),(0,t.jsx)(j.FormField,{label:"Текст отзыва",required:!0,children:(0,t.jsx)(j.FormTextarea,{value:eo.text,onChange:e=>em({...eo,text:e.target.value}),rows:4,placeholder:"Текст отзыва"})}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(j.FormField,{label:"Оценка (1-5)",required:!0,children:(0,t.jsxs)(j.FormSelect,{value:eo.grade,onChange:e=>em({...eo,grade:e.target.value}),children:[(0,t.jsx)("option",{value:"5",children:"5 - Отлично"}),(0,t.jsx)("option",{value:"4",children:"4 - Хорошо"}),(0,t.jsx)("option",{value:"3",children:"3 - Нормально"}),(0,t.jsx)("option",{value:"2",children:"2 - Плохо"}),(0,t.jsx)("option",{value:"1",children:"1 - Ужасно"})]})}),(0,t.jsx)(j.FormField,{label:"Привязка к услуге",children:(0,t.jsxs)(j.FormSelect,{value:eo.service_id,onChange:e=>em({...eo,service_id:e.target.value}),children:[(0,t.jsx)("option",{value:"",children:"Без привязки к услуге"}),R.map(e=>(0,t.jsx)("option",{value:e.id,children:e.title},e.id))]})})]}),(0,t.jsx)(j.FormField,{label:"Фото автора",children:(0,t.jsx)(p.ImageUploader,{value:eo.image_url,onChange:e=>em({...eo,image_url:e}),folder:"smartmedical/feedbacks",placeholder:"Загрузите фото автора отзыва",maxSizeMB:5})}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("button",{type:"button",onClick:()=>em({...eo,verified:!eo.verified}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${eo.verified?"bg-[#18A36C]":"bg-gray-300"}`,children:(0,t.jsx)("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${eo.verified?"translate-x-6":"translate-x-1"}`})}),(0,t.jsx)("span",{className:"text-sm text-gray-700",children:eo.verified?"Показывать в общих отзывах клиники":"Не показывать в общих отзывах клиники"})]})]})}),(0,t.jsx)(i.AnimatePresence,{children:V&&(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,t.jsx)(l.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>Q(null),className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),(0,t.jsxs)(l.motion.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"relative w-full max-w-lg mx-4 bg-white rounded-2xl shadow-2xl overflow-hidden",children:[(0,t.jsx)("div",{className:"bg-[#18A36C] px-6 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Просмотр отзыва"}),(0,t.jsx)("button",{onClick:()=>Q(null),className:"p-1.5 hover:bg-white/20 rounded-lg transition-colors",children:(0,t.jsx)(u.X,{className:"w-5 h-5 text-white"})})]})}),(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-start gap-4 mb-4",children:[(0,t.jsx)("div",{className:"w-14 h-14 rounded-full overflow-hidden flex-shrink-0 bg-gray-100 flex items-center justify-center",children:V.image_url?(0,t.jsx)("img",{src:V.image_url,alt:V.name,className:"w-full h-full object-cover"}):(0,t.jsx)("span",{className:"text-lg font-semibold text-gray-500",children:V.name.trim().split(/\s+/).length>=2?(V.name.trim().split(/\s+/)[0][0]+V.name.trim().split(/\s+/)[1][0]).toUpperCase():V.name.slice(0,2).toUpperCase()})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-800 text-lg",children:V.name}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[eC(V.grade),(0,t.jsx)("span",{className:"text-sm text-gray-500",children:new Date(V.date).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"})})]})]})]}),(0,t.jsx)("div",{className:"bg-gray-50 rounded-xl p-4 mb-4",children:(0,t.jsx)("p",{className:"text-gray-700 whitespace-pre-wrap",children:V.text})}),V.service&&(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"Услуга: "}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:V.service.title})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 pt-4 border-t border-gray-100",children:[(0,t.jsxs)("button",{onClick:()=>{ey(V),Q(null)},className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 bg-[#18A36C] text-white font-medium rounded-xl hover:bg-[#15905f] transition-colors",children:[(0,t.jsx)(x.default,{className:"w-4 h-4"}),"Одобрить"]}),(0,t.jsxs)("button",{onClick:()=>{eN(V.id,V.name),Q(null)},className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 bg-red-500 text-white font-medium rounded-xl hover:bg-red-600 transition-colors",children:[(0,t.jsx)(u.X,{className:"w-4 h-4"}),"Отклонить"]})]})]})]})]})}),(0,t.jsx)(i.AnimatePresence,{children:Y&&(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,t.jsx)(l.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>!es&&Z(null),className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),(0,t.jsxs)(l.motion.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"relative w-full max-w-md bg-white rounded-2xl shadow-2xl overflow-hidden",children:[(0,t.jsx)("div",{className:"bg-[#18A36C] px-6 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Одобрение отзыва"}),(0,t.jsx)("button",{onClick:()=>!es&&Z(null),className:"p-1.5 hover:bg-white/20 rounded-lg transition-colors",children:(0,t.jsx)(u.X,{className:"w-5 h-5 text-white"})})]})}),(0,t.jsxs)("div",{className:"p-6 space-y-5",children:[(0,t.jsxs)("div",{className:"p-4 bg-gray-50 rounded-xl",children:[(0,t.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Отзыв от"}),(0,t.jsx)("p",{className:"font-medium text-gray-800",children:Y.name}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-2 line-clamp-2",children:Y.text})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Привязка к услуге"}),(0,t.jsxs)("select",{value:ee.service_id,onChange:e=>et({...ee,service_id:e.target.value}),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-[#18A36C]/20 focus:border-[#18A36C] transition-all",children:[(0,t.jsx)("option",{value:"",children:"Без привязки к услуге"}),R.map(e=>(0,t.jsx)("option",{value:e.id,children:e.title},e.id))]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("button",{type:"button",onClick:()=>et({...ee,verified:!ee.verified}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${ee.verified?"bg-[#18A36C]":"bg-gray-300"}`,children:(0,t.jsx)("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${ee.verified?"translate-x-6":"translate-x-1"}`})}),(0,t.jsx)("span",{className:"text-sm text-gray-700",children:"Показывать в общих отзывах клиники"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 pt-2",children:[(0,t.jsx)("button",{onClick:()=>Z(null),disabled:es,className:"flex-1 px-4 py-2.5 border border-gray-200 text-gray-700 font-medium rounded-xl hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Отмена"}),(0,t.jsxs)("button",{onClick:ew,disabled:es,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 bg-[#18A36C] text-white font-medium rounded-xl hover:bg-[#15905f] transition-colors disabled:opacity-50",children:[es?(0,t.jsx)(n.Loader2,{className:"w-4 h-4 animate-spin"}):(0,t.jsx)(x.default,{className:"w-4 h-4"}),"Одобрить"]})]})]})]})]})}),(0,t.jsx)(N.ConfirmDialog,{isOpen:L.isOpen,onClose:L.handleCancel,onConfirm:L.handleConfirm,title:L.options.title,message:L.options.message,confirmText:L.options.confirmText,cancelText:L.options.cancelText,variant:L.options.variant,loading:L.loading})]})})]}):(0,t.jsx)(v.AdminAuthForm,{onSuccess:()=>{F()}})}e.s(["default",()=>A],68707)}]);