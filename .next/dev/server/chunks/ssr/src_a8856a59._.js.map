{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Study/commercial-projects/smartmedical/src/components/SMAdmin/SMAdminSkeleton.tsx"],"sourcesContent":["'use client';\r\n\r\n// Базовый компонент скелетона\r\nfunction Skeleton({ className = '' }: { className?: string }) {\r\n  return (\r\n    <div className={`animate-pulse bg-gray-200 rounded ${className}`} />\r\n  );\r\n}\r\n\r\n// Скелетон для карточки в админке\r\nexport function AdminItemCardSkeleton() {\r\n  return (\r\n    <div className=\"bg-white rounded-xl p-5 border border-gray-100 shadow-sm\">\r\n      <div className=\"flex gap-4 mb-4\">\r\n        {/* Изображение/Аватар */}\r\n        <Skeleton className=\"w-16 h-16 rounded-xl flex-shrink-0\" />\r\n\r\n        {/* Информация */}\r\n        <div className=\"flex-1 min-w-0 space-y-2\">\r\n          <Skeleton className=\"h-5 w-3/4\" />\r\n          <Skeleton className=\"h-4 w-full\" />\r\n          <Skeleton className=\"h-4 w-2/3\" />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Теги/Badges */}\r\n      <div className=\"flex items-center gap-2 mb-4\">\r\n        <Skeleton className=\"h-6 w-20 rounded-full\" />\r\n        <Skeleton className=\"h-6 w-16 rounded-full\" />\r\n      </div>\r\n\r\n      {/* Нижняя часть с кнопками */}\r\n      <div className=\"flex items-center justify-between pt-4 border-t border-gray-100\">\r\n        <Skeleton className=\"h-4 w-24\" />\r\n        <div className=\"flex gap-2\">\r\n          <Skeleton className=\"h-8 w-8 rounded-lg\" />\r\n          <Skeleton className=\"h-8 w-8 rounded-lg\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Скелетон для верхней части секции (заголовок + поиск + кнопка)\r\nexport function AdminSectionHeaderSkeleton() {\r\n  return (\r\n    <div className=\"bg-white rounded-2xl p-6 mb-6 border border-gray-100\">\r\n      <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4\">\r\n        {/* Заголовок с иконкой */}\r\n        <div className=\"flex items-center gap-3\">\r\n          <Skeleton className=\"w-10 h-10 rounded-xl\" />\r\n          <div>\r\n            <Skeleton className=\"h-7 w-40 mb-2\" />\r\n            <Skeleton className=\"h-4 w-32\" />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Поиск и кнопка */}\r\n        <div className=\"flex flex-col sm:flex-row gap-3 lg:w-auto w-full\">\r\n          <Skeleton className=\"h-11 w-full sm:w-64 rounded-xl\" />\r\n          <Skeleton className=\"h-11 w-full sm:w-48 rounded-xl\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Скелетон для сетки карточек\r\nexport function AdminGridSkeleton({ count = 12 }: { count?: number }) {\r\n  return (\r\n    <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4\">\r\n      {Array.from({ length: count }).map((_, i) => (\r\n        <AdminItemCardSkeleton key={i} />\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\n// Полный скелетон для секции админки\r\nexport function AdminSectionSkeleton({ itemCount = 12 }: { itemCount?: number }) {\r\n  return (\r\n    <>\r\n      <AdminSectionHeaderSkeleton />\r\n      <AdminGridSkeleton count={itemCount} />\r\n    </>\r\n  );\r\n}\r\n\r\n// Скелетон для списка (2 колонки, как в отзывах)\r\nexport function AdminListSkeleton({ count = 6 }: { count?: number }) {\r\n  return (\r\n    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n      {Array.from({ length: count }).map((_, i) => (\r\n        <AdminItemCardSkeleton key={i} />\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\n// Скелетон для карточки отзыва\r\nexport function AdminFeedbackCardSkeleton() {\r\n  return (\r\n    <div className=\"bg-white rounded-xl p-5 border border-gray-100 shadow-sm\">\r\n      <div className=\"flex gap-4 mb-3\">\r\n        {/* Круглое фото автора */}\r\n        <Skeleton className=\"w-14 h-14 rounded-full flex-shrink-0\" />\r\n\r\n        {/* Информация */}\r\n        <div className=\"flex-1 min-w-0 space-y-2\">\r\n          <Skeleton className=\"h-5 w-2/5\" />\r\n          {/* Звезды и дата */}\r\n          <div className=\"flex items-center gap-3\">\r\n            <Skeleton className=\"h-4 w-24\" />\r\n            <Skeleton className=\"h-3 w-20\" />\r\n          </div>\r\n          <Skeleton className=\"h-4 w-full\" />\r\n          <Skeleton className=\"h-4 w-4/5\" />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Badges */}\r\n      <div className=\"flex items-center gap-2 mb-4\">\r\n        <Skeleton className=\"h-6 w-32 rounded-full\" />\r\n        <Skeleton className=\"h-6 w-28 rounded-full\" />\r\n      </div>\r\n\r\n      {/* Actions */}\r\n      <div className=\"flex items-center justify-end pt-4 border-t border-gray-100\">\r\n        <div className=\"flex gap-2\">\r\n          <Skeleton className=\"h-8 w-8 rounded-lg\" />\r\n          <Skeleton className=\"h-8 w-8 rounded-lg\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Скелетон для сетки отзывов (2 колонки как в реальном компоненте)\r\nexport function AdminFeedbacksGridSkeleton({ count = 12 }: { count?: number }) {\r\n  return (\r\n    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n      {Array.from({ length: count }).map((_, i) => (\r\n        <AdminFeedbackCardSkeleton key={i} />\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\n// Скелетон для карточки вопроса (длинная карточка на всю ширину)\r\nexport function AdminQuestionCardSkeleton() {\r\n  return (\r\n    <div className=\"bg-white rounded-xl p-5 border border-gray-100 shadow-sm\">\r\n      <div className=\"flex items-start justify-between gap-4\">\r\n        <div className=\"flex-1\">\r\n          {/* Вопрос */}\r\n          <Skeleton className=\"h-5 w-3/4 mb-2\" />\r\n\r\n          {/* Ответ */}\r\n          <Skeleton className=\"h-4 w-full mb-2\" />\r\n          <Skeleton className=\"h-4 w-5/6 mb-3\" />\r\n\r\n          {/* Badges */}\r\n          <div className=\"flex items-center gap-2\">\r\n            <Skeleton className=\"h-6 w-24 rounded-full\" />\r\n            <Skeleton className=\"h-6 w-32 rounded-full\" />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Actions */}\r\n        <div className=\"flex gap-2\">\r\n          <Skeleton className=\"h-8 w-8 rounded-lg\" />\r\n          <Skeleton className=\"h-8 w-8 rounded-lg\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Скелетон для списка вопросов (вертикально, одна карточка в строку)\r\nexport function AdminQuestionsGridSkeleton({ count = 12 }: { count?: number }) {\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {Array.from({ length: count }).map((_, i) => (\r\n        <AdminQuestionCardSkeleton key={i} />\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\n// Скелетон для страницы контактов\r\nexport function AdminContactsSkeleton() {\r\n  return (\r\n    <div className=\"bg-white rounded-2xl p-6 lg:p-8 border border-gray-100\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center gap-3 mb-8\">\r\n        <Skeleton className=\"w-12 h-12 rounded-xl\" />\r\n        <div>\r\n          <Skeleton className=\"h-7 w-40 mb-2\" />\r\n          <Skeleton className=\"h-4 w-64\" />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Form fields */}\r\n      <div className=\"space-y-6\">\r\n        {Array.from({ length: 7 }).map((_, i) => (\r\n          <div key={i}>\r\n            <Skeleton className=\"h-4 w-32 mb-2\" />\r\n            <Skeleton className=\"h-11 w-full rounded-lg\" />\r\n          </div>\r\n        ))}\r\n\r\n        {/* Button */}\r\n        <div className=\"pt-4\">\r\n          <Skeleton className=\"h-11 w-48 rounded-lg\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Скелетон для загрузки доступа (начальная загрузка)\r\nexport function AdminAccessSkeleton() {\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-50 backdrop-blur-md\">\r\n      {/* Блюр оверлей */}\r\n      <div className=\"absolute inset-0 bg-white/50 backdrop-blur-sm\" />\r\n\r\n      {/* Центральный контент */}\r\n      <div className=\"relative z-10 text-center\">\r\n        {/* Анимированный спиннер */}\r\n        <div className=\"mb-6\">\r\n          <div className=\"w-16 h-16 mx-auto border-4 border-gray-200 border-t-[#18A36C] rounded-full animate-spin\" />\r\n        </div>\r\n\r\n        {/* Текст загрузки */}\r\n        <div className=\"space-y-3\">\r\n          <h2 className=\"text-xl font-semibold text-gray-800\">Проверка доступа...</h2>\r\n          <p className=\"text-sm text-gray-500\">Пожалуйста, подождите</p>\r\n        </div>\r\n\r\n        {/* Пульсирующие точки */}\r\n        <div className=\"flex justify-center gap-2 mt-6\">\r\n          <div className=\"w-2 h-2 bg-[#18A36C] rounded-full animate-pulse\" style={{ animationDelay: '0ms' }} />\r\n          <div className=\"w-2 h-2 bg-[#18A36C] rounded-full animate-pulse\" style={{ animationDelay: '150ms' }} />\r\n          <div className=\"w-2 h-2 bg-[#18A36C] rounded-full animate-pulse\" style={{ animationDelay: '300ms' }} />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AAEA,8BAA8B;AAC9B,SAAS,SAAS,EAAE,YAAY,EAAE,EAA0B;IAC1D,qBACE,8OAAC;QAAI,WAAW,CAAC,kCAAkC,EAAE,WAAW;;;;;;AAEpE;AAGO,SAAS;IACd,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCAEb,8OAAC;wBAAS,WAAU;;;;;;kCAGpB,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAS,WAAU;;;;;;0CACpB,8OAAC;gCAAS,WAAU;;;;;;0CACpB,8OAAC;gCAAS,WAAU;;;;;;;;;;;;;;;;;;0BAKxB,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAS,WAAU;;;;;;kCACpB,8OAAC;wBAAS,WAAU;;;;;;;;;;;;0BAItB,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAS,WAAU;;;;;;kCACpB,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAS,WAAU;;;;;;0CACpB,8OAAC;gCAAS,WAAU;;;;;;;;;;;;;;;;;;;;;;;;AAK9B;AAGO,SAAS;IACd,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BAEb,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAS,WAAU;;;;;;sCACpB,8OAAC;;8CACC,8OAAC;oCAAS,WAAU;;;;;;8CACpB,8OAAC;oCAAS,WAAU;;;;;;;;;;;;;;;;;;8BAKxB,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAS,WAAU;;;;;;sCACpB,8OAAC;4BAAS,WAAU;;;;;;;;;;;;;;;;;;;;;;;AAK9B;AAGO,SAAS,kBAAkB,EAAE,QAAQ,EAAE,EAAsB;IAClE,qBACE,8OAAC;QAAI,WAAU;kBACZ,MAAM,IAAI,CAAC;YAAE,QAAQ;QAAM,GAAG,GAAG,CAAC,CAAC,GAAG,kBACrC,8OAAC,2BAA2B;;;;;;;;;;AAIpC;AAGO,SAAS,qBAAqB,EAAE,YAAY,EAAE,EAA0B;IAC7E,qBACE;;0BACE,8OAAC;;;;;0BACD,8OAAC;gBAAkB,OAAO;;;;;;;;AAGhC;AAGO,SAAS,kBAAkB,EAAE,QAAQ,CAAC,EAAsB;IACjE,qBACE,8OAAC;QAAI,WAAU;kBACZ,MAAM,IAAI,CAAC;YAAE,QAAQ;QAAM,GAAG,GAAG,CAAC,CAAC,GAAG,kBACrC,8OAAC,2BAA2B;;;;;;;;;;AAIpC;AAGO,SAAS;IACd,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCAEb,8OAAC;wBAAS,WAAU;;;;;;kCAGpB,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAS,WAAU;;;;;;0CAEpB,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAS,WAAU;;;;;;kDACpB,8OAAC;wCAAS,WAAU;;;;;;;;;;;;0CAEtB,8OAAC;gCAAS,WAAU;;;;;;0CACpB,8OAAC;gCAAS,WAAU;;;;;;;;;;;;;;;;;;0BAKxB,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAS,WAAU;;;;;;kCACpB,8OAAC;wBAAS,WAAU;;;;;;;;;;;;0BAItB,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAS,WAAU;;;;;;sCACpB,8OAAC;4BAAS,WAAU;;;;;;;;;;;;;;;;;;;;;;;AAK9B;AAGO,SAAS,2BAA2B,EAAE,QAAQ,EAAE,EAAsB;IAC3E,qBACE,8OAAC;QAAI,WAAU;kBACZ,MAAM,IAAI,CAAC;YAAE,QAAQ;QAAM,GAAG,GAAG,CAAC,CAAC,GAAG,kBACrC,8OAAC,+BAA+B;;;;;;;;;;AAIxC;AAGO,SAAS;IACd,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAI,WAAU;;sCAEb,8OAAC;4BAAS,WAAU;;;;;;sCAGpB,8OAAC;4BAAS,WAAU;;;;;;sCACpB,8OAAC;4BAAS,WAAU;;;;;;sCAGpB,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAS,WAAU;;;;;;8CACpB,8OAAC;oCAAS,WAAU;;;;;;;;;;;;;;;;;;8BAKxB,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAS,WAAU;;;;;;sCACpB,8OAAC;4BAAS,WAAU;;;;;;;;;;;;;;;;;;;;;;;AAK9B;AAGO,SAAS,2BAA2B,EAAE,QAAQ,EAAE,EAAsB;IAC3E,qBACE,8OAAC;QAAI,WAAU;kBACZ,MAAM,IAAI,CAAC;YAAE,QAAQ;QAAM,GAAG,GAAG,CAAC,CAAC,GAAG,kBACrC,8OAAC,+BAA+B;;;;;;;;;;AAIxC;AAGO,SAAS;IACd,qBACE,8OAAC;QAAI,WAAU;;0BAEb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAS,WAAU;;;;;;kCACpB,8OAAC;;0CACC,8OAAC;gCAAS,WAAU;;;;;;0CACpB,8OAAC;gCAAS,WAAU;;;;;;;;;;;;;;;;;;0BAKxB,8OAAC;gBAAI,WAAU;;oBACZ,MAAM,IAAI,CAAC;wBAAE,QAAQ;oBAAE,GAAG,GAAG,CAAC,CAAC,GAAG,kBACjC,8OAAC;;8CACC,8OAAC;oCAAS,WAAU;;;;;;8CACpB,8OAAC;oCAAS,WAAU;;;;;;;2BAFZ;;;;;kCAOZ,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BAAS,WAAU;;;;;;;;;;;;;;;;;;;;;;;AAK9B;AAGO,SAAS;IACd,qBACE,8OAAC;QAAI,WAAU;;0BAEb,8OAAC;gBAAI,WAAU;;;;;;0BAGf,8OAAC;gBAAI,WAAU;;kCAEb,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BAAI,WAAU;;;;;;;;;;;kCAIjB,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAG,WAAU;0CAAsC;;;;;;0CACpD,8OAAC;gCAAE,WAAU;0CAAwB;;;;;;;;;;;;kCAIvC,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;gCAAkD,OAAO;oCAAE,gBAAgB;gCAAM;;;;;;0CAChG,8OAAC;gCAAI,WAAU;gCAAkD,OAAO;oCAAE,gBAAgB;gCAAQ;;;;;;0CAClG,8OAAC;gCAAI,WAAU;gCAAkD,OAAO;oCAAE,gBAAgB;gCAAQ;;;;;;;;;;;;;;;;;;;;;;;;AAK5G","debugId":null}},
    {"offset": {"line": 753, "column": 0}, "map": {"version":3,"sources":["file:///C:/Study/commercial-projects/smartmedical/src/components/common/SMBadge/SMBadge.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { Slot } from \"@radix-ui/react-slot\";\r\nimport { cva, type VariantProps } from \"class-variance-authority\";\r\n\r\nimport { cn } from \"../SMUtils/SMUtils\";\r\n\r\nconst badgeVariants = cva(\r\n  \"inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default:\r\n          \"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90\",\r\n        secondary:\r\n          \"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90\",\r\n        destructive:\r\n          \"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\r\n        outline:\r\n          \"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n    },\r\n  },\r\n);\r\n\r\nfunction Badge({\r\n  className,\r\n  variant,\r\n  asChild = false,\r\n  ...props\r\n}: React.ComponentProps<\"span\"> &\r\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\r\n  const Comp = asChild ? Slot : \"span\";\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"badge\"\r\n      className={cn(badgeVariants({ variant }), className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nexport { Badge, badgeVariants };\r\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,IAAA,uKAAG,EACvB,kZACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,EACb,SAAS,EACT,OAAO,EACP,UAAU,KAAK,EACf,GAAG,OAEuD;IAC1D,MAAM,OAAO,UAAU,wKAAI,GAAG;IAE9B,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,wJAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 799, "column": 0}, "map": {"version":3,"sources":["file:///C:/Study/commercial-projects/smartmedical/src/utils/chatNotifications.ts"],"sourcesContent":["const NOTIFIED_CHATS_KEY = 'chat-notifications-notified';\r\n\r\n/**\r\n * Clear notification flag for a specific chat\r\n * Call this when user opens and reads a chat\r\n */\r\nexport function clearChatNotification(chatId: number): void {\r\n  if (typeof window === 'undefined') return;\r\n\r\n  const notifiedChats = JSON.parse(\r\n    localStorage.getItem(NOTIFIED_CHATS_KEY) || '[]'\r\n  ) as number[];\r\n\r\n  const updated = notifiedChats.filter((id) => id !== chatId);\r\n  localStorage.setItem(NOTIFIED_CHATS_KEY, JSON.stringify(updated));\r\n}\r\n\r\n/**\r\n * Clear all chat notifications\r\n */\r\nexport function clearAllChatNotifications(): void {\r\n  if (typeof window === 'undefined') return;\r\n  localStorage.removeItem(NOTIFIED_CHATS_KEY);\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA,MAAM,qBAAqB;AAMpB,SAAS,sBAAsB,MAAc;IAClD,wCAAmC;;;IAEnC,MAAM;IAIN,MAAM;AAER;AAKO,SAAS;IACd,wCAAmC;;;AAErC","debugId":null}},
    {"offset": {"line": 822, "column": 0}, "map": {"version":3,"sources":["file:///C:/Study/commercial-projects/smartmedical/src/components/SMAdmin/ChatModal.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { X, Send, User, Bot, Clock, CheckCheck, Loader2, Ban, UserX, Trash2 } from 'lucide-react';\r\nimport { Button } from '../common/SMButton/SMButton';\r\nimport { Badge } from '../common/SMBadge/SMBadge';\r\nimport { useAlert } from '../common/SMAlert/AlertProvider';\r\nimport { clearChatNotification } from '@/utils/chatNotifications';\r\n\r\ninterface ChatMessage {\r\n  id: number;\r\n  chat_id: number;\r\n  sender_id: number;\r\n  sender_type: 'patient' | 'operator';\r\n  content: string;\r\n  created_at: string;\r\n  is_read: boolean;\r\n  sender: {\r\n    id: number;\r\n    name: string;\r\n    avatar_url: string | null;\r\n  };\r\n}\r\n\r\ninterface Chat {\r\n  id: number;\r\n  patient_id: number;\r\n  operator_id: number | null;\r\n  status: 'WAITING' | 'ACTIVE' | 'CLOSED';\r\n  created_at: string;\r\n  updated_at: string;\r\n  last_message_at: string | null;\r\n  has_unread_operator: boolean;\r\n  has_unread_patient: boolean;\r\n  patient: {\r\n    id: number;\r\n    name: string;\r\n    email: string;\r\n    avatar_url: string | null;\r\n    is_messages_blocked: boolean;\r\n  };\r\n  operator: {\r\n    id: number;\r\n    name: string;\r\n  } | null;\r\n  messages: ChatMessage[];\r\n}\r\n\r\ninterface ChatModalProps {\r\n  chatId: number;\r\n  onClose: () => void;\r\n}\r\n\r\nexport function ChatModal({ chatId, onClose }: ChatModalProps) {\r\n  const [chat, setChat] = useState<Chat | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [message, setMessage] = useState('');\r\n  const [sending, setSending] = useState(false);\r\n  const [showBlockConfirm, setShowBlockConfirm] = useState(false);\r\n  const [blocking, setBlocking] = useState(false);\r\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\r\n  const [deleting, setDeleting] = useState(false);\r\n  const messagesEndRef = useRef<HTMLDivElement>(null);\r\n  const alert = useAlert();\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  const loadChat = useCallback(async () => {\r\n    try {\r\n      const response = await fetch(`/api/operator-chat/${chatId}`);\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setChat(data.chat);\r\n        // Clear notification when chat is opened and loaded\r\n        clearChatNotification(chatId);\r\n      } else {\r\n        alert.error('Не удалось загрузить чат', 'Ошибка');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading chat:', error);\r\n      alert.error('Ошибка при загрузке чата', 'Ошибка');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [chatId, alert]);\r\n\r\n  useEffect(() => {\r\n    loadChat();\r\n    // Автообновление убрано - обновляется только при отправке сообщения и открытии\r\n  }, [loadChat]);\r\n\r\n  useEffect(() => {\r\n    if (chat) {\r\n      scrollToBottom();\r\n    }\r\n  }, [chat?.messages]);\r\n\r\n  const handleTakeChat = async () => {\r\n    try {\r\n      const response = await fetch(`/api/operator-chat/${chatId}`, {\r\n        method: 'PATCH',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ action: 'take' }),\r\n      });\r\n\r\n      if (response.ok) {\r\n        alert.success('Вы взяли чат', 'Успех');\r\n        loadChat();\r\n      } else {\r\n        alert.error('Не удалось взять чат', 'Ошибка');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error taking chat:', error);\r\n      alert.error('Ошибка при взятии чата', 'Ошибка');\r\n    }\r\n  };\r\n\r\n  const handleCloseChat = async () => {\r\n    try {\r\n      const response = await fetch(`/api/operator-chat/${chatId}`, {\r\n        method: 'PATCH',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ status: 'CLOSED' }),\r\n      });\r\n\r\n      if (response.ok) {\r\n        alert.success('Чат закрыт', 'Успех');\r\n        onClose();\r\n      } else {\r\n        alert.error('Не удалось закрыть чат', 'Ошибка');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error closing chat:', error);\r\n      alert.error('Ошибка при закрытии чата', 'Ошибка');\r\n    }\r\n  };\r\n\r\n  const handleBlockUser = () => {\r\n    if (!chat) return;\r\n    setShowBlockConfirm(true);\r\n  };\r\n\r\n  const confirmBlockUser = async () => {\r\n    if (!chat || blocking) return;\r\n\r\n    const action = chat.patient.is_messages_blocked ? 'unblock' : 'block';\r\n    setBlocking(true);\r\n\r\n    try {\r\n      const response = await fetch(`/api/operator-chat/${chatId}/block`, {\r\n        method: 'PATCH',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ action }),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (response.ok) {\r\n        alert.success(\r\n          action === 'block' ? 'Пользователь заблокирован и все его чаты удалены' : 'Пользователь разблокирован',\r\n          'Успех'\r\n        );\r\n        if (action === 'block') {\r\n          // Чат удален, закрываем модалку\r\n          onClose();\r\n        } else {\r\n          await loadChat();\r\n          setShowBlockConfirm(false);\r\n        }\r\n      } else {\r\n        alert.error(data.error || 'Не удалось ' + (action === 'block' ? 'заблокировать' : 'разблокировать') + ' пользователя', 'Ошибка');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error blocking/unblocking user:', error);\r\n      alert.error('Ошибка при блокировке/разблокировке', 'Ошибка');\r\n    } finally {\r\n      setBlocking(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteChat = () => {\r\n    setShowDeleteConfirm(true);\r\n  };\r\n\r\n  const confirmDeleteChat = async () => {\r\n    if (!chat || deleting) return;\r\n\r\n    setDeleting(true);\r\n\r\n    try {\r\n      const response = await fetch(`/api/operator-chat/${chatId}`, {\r\n        method: 'DELETE',\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (response.ok) {\r\n        alert.success('Чат удален', 'Успех');\r\n        onClose();\r\n      } else {\r\n        alert.error(data.error || 'Не удалось удалить чат', 'Ошибка');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error deleting chat:', error);\r\n      alert.error('Ошибка при удалении чата', 'Ошибка');\r\n    } finally {\r\n      setDeleting(false);\r\n    }\r\n  };\r\n\r\n  const handleSendMessage = async () => {\r\n    if (!message.trim() || sending) return;\r\n\r\n    setSending(true);\r\n    try {\r\n      const response = await fetch(`/api/operator-chat/${chatId}`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ content: message.trim() }),\r\n      });\r\n\r\n      if (response.ok) {\r\n        setMessage('');\r\n        loadChat();\r\n      } else {\r\n        const data = await response.json();\r\n        alert.error(data.error || 'Не удалось отправить сообщение', 'Ошибка');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error sending message:', error);\r\n      alert.error('Ошибка при отправке сообщения', 'Ошибка');\r\n    } finally {\r\n      setSending(false);\r\n    }\r\n  };\r\n\r\n  const handleKeyPress = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSendMessage();\r\n    }\r\n  };\r\n\r\n  const getStatusBadge = (status: string) => {\r\n    switch (status) {\r\n      case 'WAITING':\r\n        return <Badge variant=\"outline\" className=\"border-amber-400 text-amber-700 bg-amber-50\">Ожидает</Badge>;\r\n      case 'ACTIVE':\r\n        return <Badge variant=\"default\" className=\"bg-emerald-500 text-white border-transparent shadow-sm\">Активный</Badge>;\r\n      case 'CLOSED':\r\n        return <Badge variant=\"secondary\" className=\"bg-gray-200 text-gray-700\">Закрыт</Badge>;\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  const formatTime = (date: string) => {\r\n    const d = new Date(date);\r\n    return d.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });\r\n  };\r\n\r\n  return (\r\n    <AnimatePresence>\r\n      <div className=\"fixed inset-0 z-[100] flex items-center justify-center p-4\">\r\n        {/* Overlay */}\r\n        <motion.div\r\n          initial={{ opacity: 0 }}\r\n          animate={{ opacity: 1 }}\r\n          exit={{ opacity: 0 }}\r\n          onClick={onClose}\r\n          className=\"absolute inset-0 bg-black/50 backdrop-blur-sm\"\r\n        />\r\n\r\n        {/* Modal */}\r\n        <motion.div\r\n          initial={{ opacity: 0, scale: 0.95, y: 20 }}\r\n          animate={{ opacity: 1, scale: 1, y: 0 }}\r\n          exit={{ opacity: 0, scale: 0.95, y: 20 }}\r\n          className=\"relative z-10 w-full max-w-3xl bg-white rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[80vh]\"\r\n        >\r\n          {loading ? (\r\n            <div className=\"flex items-center justify-center h-96\">\r\n              <Loader2 className=\"w-8 h-8 text-[#18A36C] animate-spin\" />\r\n            </div>\r\n          ) : chat ? (\r\n            <>\r\n              {/* Header */}\r\n              <div className=\"bg-white border-b border-gray-200 p-6 flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-4\">\r\n                  {chat.patient.avatar_url ? (\r\n                    <img\r\n                      src={chat.patient.avatar_url}\r\n                      alt={chat.patient.name}\r\n                      className=\"w-14 h-14 rounded-full object-cover border-2 border-gray-200\"\r\n                    />\r\n                  ) : (\r\n                    <div className=\"w-14 h-14 bg-gradient-to-br from-[#18A36C] to-[#15905f] rounded-full flex items-center justify-center shadow-md\">\r\n                      <User className=\"w-7 h-7 text-white\" />\r\n                    </div>\r\n                  )}\r\n                  <div>\r\n                    <h2 className=\"text-xl font-bold text-gray-900\">{chat.patient.name}</h2>\r\n                    <p className=\"text-gray-600 text-sm\">{chat.patient.email}</p>\r\n                    <div className=\"mt-1.5 flex items-center gap-2\">\r\n                      {getStatusBadge(chat.status)}\r\n                      {chat.patient.is_messages_blocked && (\r\n                        <Badge variant=\"secondary\" className=\"bg-gray-700 text-white\">\r\n                          <Ban className=\"w-3 h-3 mr-1\" />\r\n                          Заблокирован\r\n                        </Badge>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  {chat.status !== 'CLOSED' && (\r\n                    <>\r\n                      {chat.status === 'WAITING' && (\r\n                        <Button\r\n                          onClick={handleTakeChat}\r\n                          className=\"bg-[#18A36C] text-white hover:bg-[#15905f] shadow-sm\"\r\n                        >\r\n                          Взять чат\r\n                        </Button>\r\n                      )}\r\n                      {chat.status === 'ACTIVE' && (\r\n                        <Button\r\n                          onClick={handleCloseChat}\r\n                          variant=\"outline\"\r\n                          className=\"text-gray-700 border-gray-300 hover:bg-gray-50\"\r\n                        >\r\n                          Закрыть чат\r\n                        </Button>\r\n                      )}\r\n                    </>\r\n                  )}\r\n                  <button\r\n                    onClick={handleDeleteChat}\r\n                    title=\"Удалить чат\"\r\n                    className=\"w-10 h-10 rounded-lg flex items-center justify-center transition-all bg-red-50 text-red-600 hover:bg-red-100\"\r\n                  >\r\n                    <Trash2 className=\"w-5 h-5\" />\r\n                  </button>\r\n                  <button\r\n                    onClick={handleBlockUser}\r\n                    title={chat.patient.is_messages_blocked ? 'Разблокировать' : 'Заблокировать'}\r\n                    className={`w-10 h-10 rounded-lg flex items-center justify-center transition-all ${chat.patient.is_messages_blocked\r\n                      ? 'bg-blue-50 text-blue-600 hover:bg-blue-100'\r\n                      : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\r\n                      }`}\r\n                  >\r\n                    {chat.patient.is_messages_blocked ? (\r\n                      <UserX className=\"w-5 h-5\" />\r\n                    ) : (\r\n                      <Ban className=\"w-5 h-5\" />\r\n                    )}\r\n                  </button>\r\n                  <button\r\n                    onClick={onClose}\r\n                    className=\"w-10 h-10 rounded-lg bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600 transition-colors\"\r\n                  >\r\n                    <X className=\"w-5 h-5\" />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Messages */}\r\n              <div className=\"flex-1 overflow-y-auto p-6 space-y-4 bg-gradient-to-b from-gray-50 to-white\">\r\n                {chat.messages.map((msg) => (\r\n                  <motion.div\r\n                    key={msg.id}\r\n                    initial={{ opacity: 0, y: 10 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    className={`flex gap-3 ${msg.sender_type === 'operator' ? 'flex-row-reverse' : ''}`}\r\n                  >\r\n                    {msg.sender.avatar_url ? (\r\n                      <img\r\n                        src={msg.sender.avatar_url}\r\n                        alt={msg.sender.name}\r\n                        className=\"w-10 h-10 rounded-full object-cover flex-shrink-0 shadow-sm\"\r\n                      />\r\n                    ) : (\r\n                      <div\r\n                        className={`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 shadow-sm ${msg.sender_type === 'operator'\r\n                          ? 'bg-gradient-to-br from-emerald-500 to-emerald-600'\r\n                          : 'bg-gradient-to-br from-gray-400 to-gray-500'\r\n                          }`}\r\n                      >\r\n                        {msg.sender_type === 'operator' ? (\r\n                          <Bot className=\"w-5 h-5 text-white\" />\r\n                        ) : (\r\n                          <User className=\"w-5 h-5 text-white\" />\r\n                        )}\r\n                      </div>\r\n                    )}\r\n                    <div className={`max-w-[70%] ${msg.sender_type === 'operator' ? 'items-end' : 'items-start'} flex flex-col`}>\r\n                      <div\r\n                        className={`rounded-2xl p-4 shadow-sm ${msg.sender_type === 'operator'\r\n                          ? 'bg-gradient-to-br from-emerald-500 to-emerald-600 text-white'\r\n                          : 'bg-white text-gray-800 border border-gray-200'\r\n                          }`}\r\n                      >\r\n                        <p className=\"text-sm leading-relaxed whitespace-pre-wrap\">{msg.content}</p>\r\n                      </div>\r\n                      <div className=\"flex items-center gap-2 mt-1.5 px-2\">\r\n                        <Clock className=\"w-3 h-3 text-gray-400\" />\r\n                        <span className=\"text-xs text-gray-500\">{formatTime(msg.created_at)}</span>\r\n                        {msg.sender_type === 'operator' && msg.is_read && (\r\n                          <CheckCheck className=\"w-4 h-4 text-emerald-500\" />\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </motion.div>\r\n                ))}\r\n                <div ref={messagesEndRef} />\r\n              </div>\r\n\r\n              {/* Input */}\r\n              {chat.status !== 'CLOSED' && (\r\n                <div className=\"p-4 bg-white border-t border-gray-200\">\r\n                  <div className=\"flex gap-3\">\r\n                    <input\r\n                      type=\"text\"\r\n                      value={message}\r\n                      onChange={(e) => setMessage(e.target.value)}\r\n                      onKeyPress={handleKeyPress}\r\n                      placeholder=\"Напишите сообщение...\"\r\n                      disabled={sending}\r\n                      className=\"flex-1 px-4 py-3 bg-gray-50 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all disabled:opacity-50\"\r\n                    />\r\n                    <button\r\n                      onClick={handleSendMessage}\r\n                      disabled={sending || !message.trim()}\r\n                      className=\"w-12 h-12 bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-xl flex items-center justify-center text-white hover:shadow-md hover:scale-105 transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100\"\r\n                    >\r\n                      {sending ? (\r\n                        <Loader2 className=\"w-5 h-5 animate-spin\" />\r\n                      ) : (\r\n                        <Send className=\"w-5 h-5\" />\r\n                      )}\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </>\r\n          ) : (\r\n            <div className=\"flex items-center justify-center h-96\">\r\n              <p className=\"text-gray-600\">Чат не найден</p>\r\n            </div>\r\n          )}\r\n        </motion.div>\r\n\r\n        {/* Block Confirmation Modal */}\r\n        {showBlockConfirm && chat && (\r\n          <motion.div\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            className=\"absolute inset-0 z-20 flex items-center justify-center bg-black/40 backdrop-blur-sm\"\r\n            onClick={() => setShowBlockConfirm(false)}\r\n          >\r\n            <motion.div\r\n              initial={{ opacity: 0, scale: 0.9, y: 20 }}\r\n              animate={{ opacity: 1, scale: 1, y: 0 }}\r\n              exit={{ opacity: 0, scale: 0.9, y: 20 }}\r\n              onClick={(e) => e.stopPropagation()}\r\n              className=\"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 overflow-hidden\"\r\n            >\r\n              {/* Header */}\r\n              <div className={`p-6 ${chat.patient.is_messages_blocked\r\n                ? 'bg-gradient-to-r from-[#18A36C] to-[#15905f]'\r\n                : 'bg-gradient-to-r from-[#18A36C] to-[#15905f]'\r\n                }`}>\r\n                <div className=\"flex items-center gap-3\">\r\n                  <div className=\"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center\">\r\n                    {chat.patient.is_messages_blocked ? (\r\n                      <UserX className=\"w-6 h-6 text-white\" />\r\n                    ) : (\r\n                      <Ban className=\"w-6 h-6 text-white\" />\r\n                    )}\r\n                  </div>\r\n                  <div>\r\n                    <h3 className=\"text-lg font-bold text-white\">\r\n                      {chat.patient.is_messages_blocked ? 'Разблокировать пользователя?' : 'Заблокировать пользователя?'}\r\n                    </h3>\r\n                    <p className=\"text-sm text-white/80\">{chat.patient.name}</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Content */}\r\n              <div className=\"p-6\">\r\n                <p className=\"text-gray-700 leading-relaxed\">\r\n                  {chat.patient.is_messages_blocked\r\n                    ? 'Пользователь сможет снова создавать новые чаты и отправлять сообщения.'\r\n                    : 'Пользователь не сможет создавать новые чаты и отправлять сообщения. Все его чаты будут удалены.'}\r\n                </p>\r\n              </div>\r\n\r\n              {/* Actions */}\r\n              <div className=\"px-6 pb-6 flex gap-3 justify-end\">\r\n                <Button\r\n                  variant=\"outline\"\r\n                  onClick={() => setShowBlockConfirm(false)}\r\n                  disabled={blocking}\r\n                  className=\"border-gray-300 text-gray-700 hover:bg-gray-50\"\r\n                >\r\n                  Отмена\r\n                </Button>\r\n                <Button\r\n                  onClick={confirmBlockUser}\r\n                  disabled={blocking}\r\n                  className={\r\n                    chat.patient.is_messages_blocked\r\n                      ? 'bg-blue-500 hover:bg-blue-600 text-white shadow-md flex items-center gap-2'\r\n                      : 'bg-gray-700 hover:bg-gray-800 text-white shadow-md flex items-center gap-2'\r\n                  }\r\n                >\r\n                  {blocking && <Loader2 className=\"w-4 h-4 animate-spin\" />}\r\n                  {chat.patient.is_messages_blocked ? 'Разблокировать' : 'Заблокировать'}\r\n                </Button>\r\n              </div>\r\n            </motion.div>\r\n          </motion.div>\r\n        )}\r\n\r\n        {/* Delete Confirmation Modal */}\r\n        {showDeleteConfirm && chat && (\r\n          <motion.div\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            className=\"absolute inset-0 z-20 flex items-center justify-center bg-black/40 backdrop-blur-sm\"\r\n            onClick={() => setShowDeleteConfirm(false)}\r\n          >\r\n            <motion.div\r\n              initial={{ opacity: 0, scale: 0.9, y: 20 }}\r\n              animate={{ opacity: 1, scale: 1, y: 0 }}\r\n              exit={{ opacity: 0, scale: 0.9, y: 20 }}\r\n              onClick={(e) => e.stopPropagation()}\r\n              className=\"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 overflow-hidden\"\r\n            >\r\n              {/* Header */}\r\n              <div className=\"p-6 bg-gradient-to-r from-red-500 to-red-600\">\r\n                <div className=\"flex items-center gap-3\">\r\n                  <div className=\"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center\">\r\n                    <Trash2 className=\"w-6 h-6 text-white\" />\r\n                  </div>\r\n                  <div>\r\n                    <h3 className=\"text-lg font-bold text-white\">\r\n                      Удалить чат?\r\n                    </h3>\r\n                    <p className=\"text-sm text-white/80\">{chat.patient.name}</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Content */}\r\n              <div className=\"p-6\">\r\n                <p className=\"text-gray-700 leading-relaxed\">\r\n                  Все сообщения в этом чате будут удалены безвозвратно. Это действие нельзя отменить.\r\n                </p>\r\n              </div>\r\n\r\n              {/* Actions */}\r\n              <div className=\"px-6 pb-6 flex gap-3 justify-end\">\r\n                <Button\r\n                  variant=\"outline\"\r\n                  onClick={() => setShowDeleteConfirm(false)}\r\n                  disabled={deleting}\r\n                  className=\"border-gray-300 text-gray-700 hover:bg-gray-50\"\r\n                >\r\n                  Отмена\r\n                </Button>\r\n                <Button\r\n                  onClick={confirmDeleteChat}\r\n                  disabled={deleting}\r\n                  className=\"bg-red-500 hover:bg-red-600 text-white shadow-md flex items-center gap-2\"\r\n                >\r\n                  {deleting && <Loader2 className=\"w-4 h-4 animate-spin\" />}\r\n                  Удалить\r\n                </Button>\r\n              </div>\r\n            </motion.div>\r\n          </motion.div>\r\n        )}\r\n      </div>\r\n    </AnimatePresence>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}