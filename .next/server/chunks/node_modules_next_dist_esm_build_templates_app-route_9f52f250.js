module.exports=[62518,e=>{"use strict";var t=e.i(47909),i=e.i(74017),n=e.i(96250),a=e.i(59756),r=e.i(61916),s=e.i(14444),o=e.i(37092),c=e.i(69741),l=e.i(16795),d=e.i(87718),u=e.i(95169),p=e.i(47587),h=e.i(66012),m=e.i(70101),v=e.i(26937),y=e.i(10372),f=e.i(93695);e.i(52474);var g=e.i(220),R=e.i(89171),w=e.i(98043),E=e.i(57660),C=e.i(27157),x=e.i(62143);async function $(e){try{let t=e.nextUrl.searchParams.get("q");if(!t||t.trim().length<3)return R.NextResponse.json({results:[]},{status:200});let i=t.trim(),n=await (0,E.getServerSession)(C.authOptions),a=!!n?.user,[r,s,o,c,l,d,u]=await Promise.all([w.prisma.service.findMany({where:{OR:[{title:{contains:i,mode:"insensitive"}},{subtitle:{contains:i,mode:"insensitive"}},{description:{contains:i,mode:"insensitive"}}]},include:{category:!0,serviceCategory:!0},take:50}),w.prisma.specialist.findMany({where:{OR:[{name:{contains:i,mode:"insensitive"}},{specialization:{contains:i,mode:"insensitive"}},{qualification:{contains:i,mode:"insensitive"}}]},include:{category:!0},take:50}),w.prisma.vacancy.findMany({where:{OR:[{name:{contains:i,mode:"insensitive"}},{category:{contains:i,mode:"insensitive"}},{description:{contains:i,mode:"insensitive"}},{requirements:{contains:i,mode:"insensitive"}}]},take:50}),w.prisma.question.findMany({where:{OR:[{question:{contains:i,mode:"insensitive"}},{answer:{contains:i,mode:"insensitive"}}]},take:50}),a?w.prisma.material.findMany({where:{AND:[{is_active:!0},{OR:[{title:{contains:i,mode:"insensitive"}},{content:{contains:i,mode:"insensitive"}}]}]},take:50}):Promise.resolve([]),w.prisma.partner.findMany({where:{OR:[{name:{contains:i,mode:"insensitive"}},{description:{contains:i,mode:"insensitive"}}]},include:{category:!0},take:50}),w.prisma.contacts.findMany({where:{OR:[{address:{contains:i,mode:"insensitive"}},{phone_number:{contains:i,mode:"insensitive"}},{phone_number_sec:{contains:i,mode:"insensitive"}},{email:{contains:i,mode:"insensitive"}}]},take:10})]),p=[];r.forEach(e=>{let t=e.serviceCategory?.slug||e.category?.slug||"services",i=e.serviceCategory?.name||e.category?.name||"Услуги";p.push({id:`service-${e.id}`,title:e.title,description:e.description,category:i,url:`/services/${t}/${e.id}`,type:"service"})}),s.forEach(e=>{let t=e.category?.slug||"doctors",i=e.category?.name||"Специалисты";p.push({id:`specialist-${e.id}`,title:e.name,description:`${e.specialization} • Стаж: ${e.experience} лет • ${e.qualification}`,category:i,url:`/doctors/${t}/${e.id}`,type:"specialist"})}),o.forEach(e=>{p.push({id:`vacancy-${e.id}`,title:e.name,description:e.description,category:e.category,url:"/clinic/vacancies",type:"vacancy"})}),c.forEach(e=>{let t=e.category||"general";p.push({id:`faq-${e.id}`,title:e.question,description:e.answer||"Ответ скоро будет добавлен",category:e.category||"Общие вопросы",url:`/clinic/faq/${t}#faq-${e.id}`,type:"faq"})}),l.forEach(e=>{p.push({id:`material-${e.id}`,title:e.title,description:e.content,category:`Материалы ${e.year}`,url:"/account",type:"material"})}),d.forEach(e=>{p.push({id:`partner-${e.id}`,title:e.name,description:e.description,category:e.category?.name||"Партнёры",url:"/clinic/partners",type:"partner"})}),u.forEach(e=>{p.push({id:`contact-${e.id}`,title:"Контакты клиники",description:`${e.address} • Тел: ${e.phone_number} • Email: ${e.email}`,category:"Контактная информация",url:"/contacts",type:"contact"})}),[{keywords:["запись","приём","прием","записаться","визит"],title:"Запись на приём",description:"Узнайте, как записаться на приём к специалисту, что взять с собой и правила посещения клиники"},{keywords:["подготовка","анализ","кровь","моча","экг","узи","обследование","сдать"],title:"Подготовка к анализам и обследованиям",description:"Рекомендации по подготовке к анализам крови, мочи, ЭКГ, УЗИ и другим обследованиям"},{keywords:["документ","договор","согласие","политика","конфиденциальность","защита данных"],title:"Документы и согласия",description:"Договор оказания услуг, политика конфиденциальности, защита персональных данных и информированное согласие"},{keywords:["оплата","цена","стоимость","тариф","страховка","страхование","оплатить"],title:"Способы оплаты",description:"Информация о способах оплаты услуг: наличные, банковские карты, рассрочка и медицинское страхование"}].forEach((e,t)=>{e.keywords.some(e=>e.includes(i.toLowerCase())||i.toLowerCase().includes(e))&&p.push({id:`patient-info-${t}`,title:e.title,description:e.description,category:"Информация для пациентов",url:"/patient",type:"patient-info"})});let h=function e(t,i,n=[]){let a=[],r=i.toLowerCase();for(let s of t){let t=s.title.toLowerCase().includes(r),o=s.description?.toLowerCase().includes(r);if(t||o){let e=n.length>0?n[0]:"Услуги";a.push({id:`service-menu-${s.id}`,title:s.title,description:s.description||`Раздел услуг: ${s.title}`,category:e,url:`/services/${s.id}`,type:"service"})}if(s.children&&s.children.length>0){let t=0===n.length?[s.title]:n,r=e(s.children,i,t);a.push(...r)}}return a}(x.default.menuData,i);return p.push(...h),R.NextResponse.json({results:p},{status:200})}catch(e){return R.NextResponse.json({error:"Ошибка при поиске",results:[]},{status:500})}}e.s(["GET",()=>$],73415);var A=e.i(73415);let O=new t.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/search/route",pathname:"/api/search",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/search/route.ts",nextConfigOutput:"",userland:A}),{workAsyncStorage:N,workUnitAsyncStorage:P,serverHooks:b}=O;function k(){return(0,n.patchFetch)({workAsyncStorage:N,workUnitAsyncStorage:P})}async function q(e,t,n){O.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let R="/api/search/route";R=R.replace(/\/index$/,"")||"/";let w=await O.prepare(e,t,{srcPage:R,multiZoneDraftMode:!1});if(!w)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:E,params:C,nextConfig:x,parsedUrl:$,isDraftMode:A,prerenderManifest:N,routerServerContext:P,isOnDemandRevalidate:b,revalidateOnlyGenerated:k,resolvedPathname:q,clientReferenceManifest:T,serverActionsManifest:_}=w,M=(0,c.normalizeAppPath)(R),S=!!(N.dynamicRoutes[M]||N.routes[q]),H=async()=>((null==P?void 0:P.render404)?await P.render404(e,t,$,!1):t.end("This page could not be found"),null);if(S&&!A){let e=!!N.routes[q],t=N.dynamicRoutes[M];if(t&&!1===t.fallback&&!e){if(x.experimental.adapterPath)return await H();throw new f.NoFallbackError}}let U=null;!S||O.isDev||A||(U="/index"===(U=q)?"/":U);let D=!0===O.isDev||!S,I=S&&!D;_&&T&&(0,s.setReferenceManifestsSingleton)({page:R,clientReferenceManifest:T,serverActionsManifest:_,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:_})});let j=e.method||"GET",L=(0,r.getTracer)(),F=L.getActiveScopeSpan(),K={params:C,prerenderManifest:N,renderOpts:{experimental:{authInterrupts:!!x.experimental.authInterrupts},cacheComponents:!!x.cacheComponents,supportsDynamicResponse:D,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:x.cacheLife,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,i,n)=>O.onRequestError(e,t,n,P)},sharedContext:{buildId:E}},B=new l.NodeNextRequest(e),G=new l.NodeNextResponse(t),z=d.NextRequestAdapter.fromNodeNextRequest(B,(0,d.signalFromNodeResponse)(t));try{let s=async e=>O.handle(z,K).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let i=L.getRootSpanAttributes();if(!i)return;if(i.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${i.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=i.get("next.route");if(n){let t=`${j} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${j} ${R}`)}),o=!!(0,a.getRequestMeta)(e,"minimalMode"),c=async a=>{var r,c;let l=async({previousCacheEntry:i})=>{try{if(!o&&b&&k&&!i)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let r=await s(a);e.fetchMetrics=K.renderOpts.fetchMetrics;let c=K.renderOpts.pendingWaitUntil;c&&n.waitUntil&&(n.waitUntil(c),c=void 0);let l=K.renderOpts.collectedTags;if(!S)return await (0,h.sendResponse)(B,G,r,K.renderOpts.pendingWaitUntil),null;{let e=await r.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(r.headers);l&&(t[y.NEXT_CACHE_TAGS_HEADER]=l),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let i=void 0!==K.renderOpts.collectedRevalidate&&!(K.renderOpts.collectedRevalidate>=y.INFINITE_CACHE)&&K.renderOpts.collectedRevalidate,n=void 0===K.renderOpts.collectedExpire||K.renderOpts.collectedExpire>=y.INFINITE_CACHE?void 0:K.renderOpts.collectedExpire;return{value:{kind:g.CachedRouteKind.APP_ROUTE,status:r.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:i,expire:n}}}}catch(t){throw(null==i?void 0:i.isStale)&&await O.onRequestError(e,t,{routerKind:"App Router",routePath:R,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:I,isOnDemandRevalidate:b})},P),t}},d=await O.handleResponse({req:e,nextConfig:x,cacheKey:U,routeKind:i.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:N,isRoutePPREnabled:!1,isOnDemandRevalidate:b,revalidateOnlyGenerated:k,responseGenerator:l,waitUntil:n.waitUntil,isMinimalMode:o});if(!S)return null;if((null==d||null==(r=d.value)?void 0:r.kind)!==g.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(c=d.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",b?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),A&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let u=(0,m.fromNodeOutgoingHttpHeaders)(d.value.headers);return o&&S||u.delete(y.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||u.get("Cache-Control")||u.set("Cache-Control",(0,v.getCacheControlHeader)(d.cacheControl)),await (0,h.sendResponse)(B,G,new Response(d.value.body,{headers:u,status:d.value.status||200})),null};F?await c(F):await L.withPropagatedContext(e.headers,()=>L.trace(u.BaseServerSpan.handleRequest,{spanName:`${j} ${R}`,kind:r.SpanKind.SERVER,attributes:{"http.method":j,"http.target":e.url}},c))}catch(t){if(t instanceof f.NoFallbackError||await O.onRequestError(e,t,{routerKind:"App Router",routePath:M,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:I,isOnDemandRevalidate:b})}),S)throw t;return await (0,h.sendResponse)(B,G,new Response(null,{status:500})),null}}e.s(["handler",()=>q,"patchFetch",()=>k,"routeModule",()=>O,"serverHooks",()=>b,"workAsyncStorage",()=>N,"workUnitAsyncStorage",()=>P],62518)}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_app-route_9f52f250.js.map