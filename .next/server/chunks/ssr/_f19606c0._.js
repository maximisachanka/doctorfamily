module.exports=[38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},72549,a=>{"use strict";var b=a.i(72131);function c(){let[a,c]=(0,b.useState)(!1),[d,e]=(0,b.useState)(!1),[f,g]=(0,b.useState)({title:"",message:""}),[h,i]=(0,b.useState)(null),j=(0,b.useCallback)(a=>(g(a),c(!0),e(!1),new Promise(a=>{i({resolve:a})})),[]);return{confirm:j,isOpen:a,loading:d,options:f,handleConfirm:(0,b.useCallback)(async()=>{h&&(e(!0),await new Promise(a=>setTimeout(a,300)),h.resolve(!0),c(!1),e(!1),i(null))},[h]),handleCancel:(0,b.useCallback)(()=>{h&&(h.resolve(!1),c(!1),e(!1),i(null))},[h])}}a.s(["useConfirmDialog",()=>c])},37210,a=>{"use strict";var b=a.i(87924),c=a.i(46271),d=a.i(62036),e=a.i(73570),f=a.i(33508),g=a.i(9526);function h({isOpen:a,onClose:h,onConfirm:i,title:j,message:k,confirmText:l="Удалить",cancelText:m="Отмена",variant:n="danger",loading:o=!1}){return a?(0,b.jsx)(d.AnimatePresence,{children:a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(c.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:h,className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[9998]"}),(0,b.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",children:(0,b.jsxs)(c.motion.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",duration:.3},className:"bg-white rounded-2xl shadow-2xl max-w-md w-full overflow-hidden",onClick:a=>a.stopPropagation(),children:[(0,b.jsx)("div",{className:`px-6 py-5 border-b border-gray-100 ${"danger"===n?"bg-red-50":"bg-yellow-50"}`,children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${"danger"===n?"bg-red-100":"bg-yellow-100"}`,children:(0,b.jsx)(e.AlertTriangle,{className:`w-6 h-6 ${"danger"===n?"text-red-600":"text-yellow-600"}`})}),(0,b.jsx)("div",{children:(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:j})})]}),(0,b.jsx)("button",{onClick:h,disabled:o,className:"text-gray-400 hover:text-gray-600 transition-colors disabled:opacity-50 cursor-pointer",children:(0,b.jsx)(f.X,{className:"w-5 h-5"})})]})}),(0,b.jsx)("div",{className:"px-6 py-5",children:(0,b.jsx)("p",{className:"text-gray-600 leading-relaxed",children:k})}),(0,b.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-100 flex items-center justify-end gap-3",children:[(0,b.jsx)(g.Button,{onClick:h,disabled:o,variant:"ghost",className:"px-5 py-2.5 cursor-pointer",children:m}),(0,b.jsx)("button",{onClick:()=>{i()},disabled:o,className:`px-5 py-2.5 rounded-xl font-medium transition-all disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer ${"danger"===n?"bg-red-600 hover:bg-red-700 text-white shadow-lg shadow-red-600/30":"bg-yellow-600 hover:bg-yellow-700 text-white shadow-lg shadow-yellow-600/30"}`,children:o?(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),(0,b.jsx)("span",{children:"Удаление..."})]}):l})]})]})})]})}):null}a.s(["ConfirmDialog",()=>h])},4699,a=>{"use strict";let b=(0,a.i(70106).default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);a.s(["default",()=>b])},5784,a=>{"use strict";var b=a.i(4699);a.s(["ChevronDown",()=>b.default])},71748,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(75003);let e=(0,a.i(70106).default)("folder-tree",[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]]);var f=a.i(50522),g=a.i(5784),h=a.i(62036),i=a.i(72663),j=a.i(4297),k=a.i(52913),l=a.i(55220),m=a.i(79212),n=a.i(25170),o=a.i(96215),p=a.i(72549),q=a.i(37210),r=a.i(33699);let s=["Baby","Smile","Heart","Activity","Eye","Brain","Users","Stethoscope","ShieldPlus","Syringe","Pill","Microscope","Hospital","Dna"];function t(){let a,{status:t}=(0,d.useSession)(),{sessionVerified:u,isLoading:v,verifySession:w}=(0,m.useAdminSession)(),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)(!0),{success:B,error:C}=(0,n.useAlert)(),D=(0,p.useConfirmDialog)(),[E,F]=(0,c.useState)([]),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)(new Set),[K,L]=(0,c.useState)(""),[M,N]=(0,c.useState)(!1),[O,P]=(0,c.useState)(null),[Q,R]=(0,c.useState)(!1),[S,T]=(0,c.useState)({name:"",slug:"",icon:"",description:"",parent_id:"",order:"0",is_active:!0});(0,c.useEffect)(()=>{"authenticated"===t?U():"unauthenticated"===t&&y(!1)},[t]),(0,c.useEffect)(()=>{u&&x&&V()},[u,x]);let U=async()=>{A(!0);try{let a=await fetch("/api/admin/auth"),b=await a.json();y(b.isAdmin)}catch(a){y(!1)}finally{A(!1)}},V=async()=>{H(!0);try{let a=await fetch("/api/admin/service-categories");if(a.ok){let b=await a.json();F(b)}}catch(a){C("Ошибка загрузки данных")}finally{H(!1)}},W=(0,c.useMemo)(()=>{let a=(b,c=0)=>{let d=[];for(let e of b)d.push({...e,level:c}),e.children&&e.children.length>0&&d.push(...a(e.children,c+1));return d};return a(E)},[E]),X=async()=>{R(!0);try{let a=O?`/api/admin/service-categories/${O.id}`:"/api/admin/service-categories",b=O?"PUT":"POST",c=await fetch(a,{method:b,headers:{"Content-Type":"application/json"},body:JSON.stringify({...S,parent_id:S.parent_id?parseInt(S.parent_id):null,order:parseInt(S.order)})});if(c.ok)await V(),Z(),B(O?"Категория обновлена":"Категория создана");else{let a=await c.json();C(a.error||"Ошибка сохранения")}}catch(a){C("Ошибка сохранения")}finally{R(!1)}},Y=async(a,b)=>{if(await D.confirm({title:"Удаление категории",message:`Вы уверены, что хотите удалить категорию "${b}"? Это также удалит все вложенные подкатегории. Это действие нельзя отменить.`,confirmText:"Удалить",cancelText:"Отмена",variant:"danger"}))try{let b=await fetch(`/api/admin/service-categories/${a}`,{method:"DELETE"});if(b.ok)await V(),B("Категория удалена");else{let a=await b.json();C(a.error||"Ошибка удаления")}}catch(a){C("Ошибка удаления")}},Z=()=>{T({name:"",slug:"",icon:"",description:"",parent_id:"",order:"0",is_active:!0}),P(null),N(!1)},$=()=>{Z(),N(!0)},_=(a,c=0)=>{let d=a.icon?r.iconMap[a.icon]:null,e=a.children&&a.children.length>0,h=I.has(a.id);return(0,b.jsxs)("div",{className:"mb-2 relative",style:{marginLeft:`${24*c}px`},children:[(0,b.jsxs)(j.ItemCard,{children:[e&&(0,b.jsx)("button",{onClick:()=>{var b;let c;return b=a.id,void((c=new Set(I)).has(b)?c.delete(b):c.add(b),J(c))},className:"absolute left-2 top-1/2 -translate-y-1/2 p-1 hover:bg-gray-100 rounded transition-colors",children:h?(0,b.jsx)(g.ChevronDown,{className:"w-4 h-4 text-gray-600"}):(0,b.jsx)(f.ChevronRight,{className:"w-4 h-4 text-gray-600"})}),(0,b.jsxs)("div",{className:e?"ml-8":"ml-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[d&&(0,b.jsx)("div",{className:"w-10 h-10 bg-[#18A36C]/10 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,b.jsx)(d,{className:"w-5 h-5 text-[#18A36C]"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-800",children:a.name}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:["/",a.slug]})]})]}),a.description&&(0,b.jsx)("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap mb-3",children:[(0,b.jsxs)(j.Badge,{variant:"secondary",children:["Порядок: ",a.order]}),(0,b.jsx)(j.Badge,{variant:a.is_active?"success":"danger",children:a.is_active?"Активна":"Неактивна"}),e&&(0,b.jsxs)(j.Badge,{variant:"primary",children:["Подкатегорий: ",a.children.length]})]}),(0,b.jsx)("div",{className:"flex items-center justify-end pt-3 border-t border-gray-100",children:(0,b.jsx)(j.CardActions,{onEdit:()=>{P(a),T({name:a.name,slug:a.slug,icon:a.icon||"",description:a.description||"",parent_id:a.parent_id?.toString()||"",order:a.order.toString(),is_active:a.is_active}),N(!0)},onDelete:()=>Y(a.id,a.name)})})]})]}),e&&h&&(0,b.jsx)("div",{className:"mt-2",children:a.children.map(a=>_(a,c+1))})]},a.id)};return"loading"===t||null===x||v||z?(0,b.jsx)(o.AdminAccessSkeleton,{}):"unauthenticated"===t||!1===x?(0,b.jsx)(k.default,{}):u?(0,b.jsxs)("div",{className:"flex min-h-screen bg-gray-50",children:[(0,b.jsx)(i.AdminMenu,{}),(0,b.jsx)("div",{className:"flex-1 p-4 lg:p-8 overflow-auto",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,b.jsx)(j.AdminSection,{title:"Категории услуг",icon:e,count:W.length,loading:G,onAdd:$,addButtonText:"Добавить категорию",searchValue:K,onSearchChange:L,children:0===E.length?(0,b.jsx)(j.EmptyState,{icon:e,title:"Категории не найдены",description:"Добавьте первую категорию услуг",actionText:"Добавить категорию",onAction:$}):(0,b.jsx)("div",{className:"space-y-2",children:(0,b.jsx)(h.AnimatePresence,{children:E.map(a=>_(a))})})}),(0,b.jsx)(j.FormModal,{isOpen:M,onClose:Z,title:O?"Редактирование категории":"Новая категория",onSubmit:X,loading:Q,disabled:!S.name||!S.slug,children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsx)(j.FormField,{label:"Название",required:!0,children:(0,b.jsx)(j.FormInput,{type:"text",value:S.name,onChange:a=>{let b=a.target.value;T({...S,name:b,slug:O?S.slug:b.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")})},placeholder:"Детская стоматология"})}),(0,b.jsx)(j.FormField,{label:"Slug (URL)",required:!0,children:(0,b.jsx)(j.FormInput,{type:"text",value:S.slug,onChange:a=>T({...S,slug:a.target.value}),placeholder:"detskaya-stomatologiya"})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)(j.FormField,{label:"Иконка",children:[(0,b.jsxs)(j.FormSelect,{value:S.icon,onChange:a=>T({...S,icon:a.target.value}),children:[(0,b.jsx)("option",{value:"",children:"Без иконки"}),s.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]}),S.icon&&r.iconMap[S.icon]&&(0,b.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-8 h-8 bg-[#18A36C]/10 rounded flex items-center justify-center",children:(a=r.iconMap[S.icon],(0,b.jsx)(a,{className:"w-4 h-4 text-[#18A36C]"}))}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:"Предпросмотр"})]})]}),(0,b.jsx)(j.FormField,{label:"Родительская категория",children:(0,b.jsxs)(j.FormSelect,{value:S.parent_id,onChange:a=>T({...S,parent_id:a.target.value}),children:[(0,b.jsx)("option",{value:"",children:"Корневая категория"}),W.filter(a=>!O||a.id!==O.id).map(a=>(0,b.jsxs)("option",{value:a.id,children:["—".repeat(a.level)," ",a.name]},a.id))]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsx)(j.FormField,{label:"Порядок сортировки",children:(0,b.jsx)(j.FormInput,{type:"number",value:S.order,onChange:a=>T({...S,order:a.target.value}),placeholder:"0"})}),(0,b.jsx)(j.FormField,{label:"Статус",children:(0,b.jsxs)(j.FormSelect,{value:S.is_active?"true":"false",onChange:a=>T({...S,is_active:"true"===a.target.value}),children:[(0,b.jsx)("option",{value:"true",children:"Активна"}),(0,b.jsx)("option",{value:"false",children:"Неактивна"})]})})]}),(0,b.jsx)(j.FormField,{label:"Описание",children:(0,b.jsx)(j.FormTextarea,{value:S.description,onChange:a=>T({...S,description:a.target.value}),rows:3,placeholder:"Краткое описание категории..."})})]})}),(0,b.jsx)(q.ConfirmDialog,{isOpen:D.isOpen,onClose:D.handleCancel,onConfirm:D.handleConfirm,title:D.options.title,message:D.options.message,confirmText:D.options.confirmText,cancelText:D.options.cancelText,variant:D.options.variant,loading:D.loading})]})})]}):(0,b.jsx)(l.AdminAuthForm,{onSuccess:()=>{w()}})}a.s(["default",()=>t],71748)}];

//# sourceMappingURL=_f19606c0._.js.map