{"version":3,"sources":["turbopack:///[project]/src/utils/chatNotifications.ts","turbopack:///[project]/src/components/SMAdmin/ChatModal.tsx","turbopack:///[project]/src/app/admin/chat/page.tsx","turbopack:///[project]/node_modules/lucide-react/src/icons/user-x.ts"],"sourcesContent":["const NOTIFIED_CHATS_KEY = 'chat-notifications-notified';\n\n/**\n * Clear notification flag for a specific chat\n * Call this when user opens and reads a chat\n */\nexport function clearChatNotification(chatId: number): void {\n  if (typeof window === 'undefined') return;\n\n  const notifiedChats = JSON.parse(\n    localStorage.getItem(NOTIFIED_CHATS_KEY) || '[]'\n  ) as number[];\n\n  const updated = notifiedChats.filter((id) => id !== chatId);\n  localStorage.setItem(NOTIFIED_CHATS_KEY, JSON.stringify(updated));\n}\n\n/**\n * Clear all chat notifications\n */\nexport function clearAllChatNotifications(): void {\n  if (typeof window === 'undefined') return;\n  localStorage.removeItem(NOTIFIED_CHATS_KEY);\n}\n","'use client';\n\nimport { useState, useEffect, useRef, useCallback } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { X, Send, User, Bot, Clock, CheckCheck, Loader2, Ban, UserX, Trash2 } from 'lucide-react';\nimport { Button } from '../common/SMButton/SMButton';\nimport { Badge } from '../common/SMBadge/SMBadge';\nimport { useAlert } from '../common/SMAlert/AlertProvider';\nimport { clearChatNotification } from '@/utils/chatNotifications';\n\ninterface ChatMessage {\n  id: number;\n  chat_id: number;\n  sender_id: number;\n  sender_type: 'patient' | 'operator';\n  content: string;\n  created_at: string;\n  is_read: boolean;\n  sender: {\n    id: number;\n    name: string;\n    avatar_url: string | null;\n  };\n}\n\ninterface Chat {\n  id: number;\n  patient_id: number;\n  operator_id: number | null;\n  status: 'WAITING' | 'ACTIVE' | 'CLOSED';\n  created_at: string;\n  updated_at: string;\n  last_message_at: string | null;\n  has_unread_operator: boolean;\n  has_unread_patient: boolean;\n  patient: {\n    id: number;\n    name: string;\n    email: string;\n    avatar_url: string | null;\n    is_messages_blocked: boolean;\n  };\n  operator: {\n    id: number;\n    name: string;\n  } | null;\n  messages: ChatMessage[];\n}\n\ninterface ChatModalProps {\n  chatId: number;\n  onClose: () => void;\n}\n\nexport function ChatModal({ chatId, onClose }: ChatModalProps) {\n  const [chat, setChat] = useState<Chat | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [message, setMessage] = useState('');\n  const [sending, setSending] = useState(false);\n  const [showBlockConfirm, setShowBlockConfirm] = useState(false);\n  const [blocking, setBlocking] = useState(false);\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\n  const [deleting, setDeleting] = useState(false);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const alert = useAlert();\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  const loadChat = useCallback(async () => {\n    try {\n      const response = await fetch(`/api/operator-chat/${chatId}`);\n      if (response.ok) {\n        const data = await response.json();\n        setChat(data.chat);\n        // Clear notification when chat is opened and loaded\n        clearChatNotification(chatId);\n      } else {\n        alert.error('Не удалось загрузить чат', 'Ошибка');\n      }\n    } catch (error) {\n      alert.error('Ошибка при загрузке чата', 'Ошибка');\n    } finally {\n      setLoading(false);\n    }\n  }, [chatId, alert]);\n\n  useEffect(() => {\n    loadChat();\n    // Автообновление убрано - обновляется только при отправке сообщения и открытии\n  }, [loadChat]);\n\n  useEffect(() => {\n    if (chat) {\n      scrollToBottom();\n    }\n  }, [chat?.messages]);\n\n  const handleTakeChat = async () => {\n    try {\n      const response = await fetch(`/api/operator-chat/${chatId}`, {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ action: 'take' }),\n      });\n\n      if (response.ok) {\n        alert.success('Вы взяли чат', 'Успех');\n        loadChat();\n      } else {\n        alert.error('Не удалось взять чат', 'Ошибка');\n      }\n    } catch (error) {\n      alert.error('Ошибка при взятии чата', 'Ошибка');\n    }\n  };\n\n  const handleCloseChat = async () => {\n    try {\n      const response = await fetch(`/api/operator-chat/${chatId}`, {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ status: 'CLOSED' }),\n      });\n\n      if (response.ok) {\n        alert.success('Чат закрыт', 'Успех');\n        onClose();\n      } else {\n        alert.error('Не удалось закрыть чат', 'Ошибка');\n      }\n    } catch (error) {\n      alert.error('Ошибка при закрытии чата', 'Ошибка');\n    }\n  };\n\n  const handleBlockUser = () => {\n    if (!chat) return;\n    setShowBlockConfirm(true);\n  };\n\n  const confirmBlockUser = async () => {\n    if (!chat || blocking) return;\n\n    const action = chat.patient.is_messages_blocked ? 'unblock' : 'block';\n    setBlocking(true);\n\n    try {\n      const response = await fetch(`/api/operator-chat/${chatId}/block`, {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ action }),\n      });\n\n      const data = await response.json();\n\n      if (response.ok) {\n        alert.success(\n          action === 'block' ? 'Пользователь заблокирован и все его чаты удалены' : 'Пользователь разблокирован',\n          'Успех'\n        );\n        if (action === 'block') {\n          // Чат удален, закрываем модалку\n          onClose();\n        } else {\n          await loadChat();\n          setShowBlockConfirm(false);\n        }\n      } else {\n        alert.error(data.error || 'Не удалось ' + (action === 'block' ? 'заблокировать' : 'разблокировать') + ' пользователя', 'Ошибка');\n      }\n    } catch (error) {\n      alert.error('Ошибка при блокировке/разблокировке', 'Ошибка');\n    } finally {\n      setBlocking(false);\n    }\n  };\n\n  const handleDeleteChat = () => {\n    setShowDeleteConfirm(true);\n  };\n\n  const confirmDeleteChat = async () => {\n    if (!chat || deleting) return;\n\n    setDeleting(true);\n\n    try {\n      const response = await fetch(`/api/operator-chat/${chatId}`, {\n        method: 'DELETE',\n      });\n\n      const data = await response.json();\n\n      if (response.ok) {\n        alert.success('Чат удален', 'Успех');\n        onClose();\n      } else {\n        alert.error(data.error || 'Не удалось удалить чат', 'Ошибка');\n      }\n    } catch (error) {\n      alert.error('Ошибка при удалении чата', 'Ошибка');\n    } finally {\n      setDeleting(false);\n    }\n  };\n\n  const handleSendMessage = async () => {\n    if (!message.trim() || sending) return;\n\n    setSending(true);\n    try {\n      const response = await fetch(`/api/operator-chat/${chatId}`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ content: message.trim() }),\n      });\n\n      if (response.ok) {\n        setMessage('');\n        loadChat();\n      } else {\n        const data = await response.json();\n        alert.error(data.error || 'Не удалось отправить сообщение', 'Ошибка');\n      }\n    } catch (error) {\n      alert.error('Ошибка при отправке сообщения', 'Ошибка');\n    } finally {\n      setSending(false);\n    }\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  const getStatusBadge = (status: string) => {\n    switch (status) {\n      case 'WAITING':\n        return <Badge variant=\"outline\" className=\"border-amber-400 text-amber-700 bg-amber-50\">Ожидает</Badge>;\n      case 'ACTIVE':\n        return <Badge variant=\"default\" className=\"bg-[#18A36C] text-white border-transparent shadow-sm\">Активный</Badge>;\n      case 'CLOSED':\n        return <Badge variant=\"secondary\" className=\"bg-gray-200 text-gray-700\">Закрыт</Badge>;\n      default:\n        return null;\n    }\n  };\n\n  const formatTime = (date: string) => {\n    const d = new Date(date);\n    return d.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });\n  };\n\n  return (\n    <AnimatePresence>\n      <div className=\"fixed inset-0 z-[100] flex items-center justify-center p-4\">\n        {/* Overlay */}\n        <motion.div\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          exit={{ opacity: 0 }}\n          onClick={onClose}\n          className=\"absolute inset-0 bg-black/50 backdrop-blur-sm\"\n        />\n\n        {/* Modal */}\n        <motion.div\n          initial={{ opacity: 0, scale: 0.95, y: 20 }}\n          animate={{ opacity: 1, scale: 1, y: 0 }}\n          exit={{ opacity: 0, scale: 0.95, y: 20 }}\n          className=\"relative z-10 w-full max-w-3xl bg-white rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[80vh]\"\n        >\n          {loading ? (\n            <div className=\"flex items-center justify-center h-96\">\n              <Loader2 className=\"w-8 h-8 text-[#18A36C] animate-spin\" />\n            </div>\n          ) : chat ? (\n            <>\n              {/* Header */}\n              <div className=\"bg-white border-b border-gray-200 p-4 sm:p-6 flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n                <div className=\"flex items-center gap-3 sm:gap-4 min-w-0\">\n                  {chat.patient.avatar_url ? (\n                    <img\n                      src={chat.patient.avatar_url}\n                      alt={chat.patient.name}\n                      className=\"w-12 h-12 sm:w-14 sm:h-14 rounded-full object-cover border-2 border-gray-200 flex-shrink-0\"\n                    />\n                  ) : (\n                    <div className=\"w-12 h-12 sm:w-14 sm:h-14 bg-gradient-to-br from-[#18A36C] to-[#15905f] rounded-full flex items-center justify-center shadow-md flex-shrink-0\">\n                      <User className=\"w-6 h-6 sm:w-7 sm:h-7 text-white\" />\n                    </div>\n                  )}\n                  <div className=\"min-w-0 flex-1\">\n                    <h2 className=\"text-lg sm:text-xl font-bold text-gray-900 truncate\">{chat.patient.name}</h2>\n                    <p className=\"text-gray-600 text-xs sm:text-sm truncate\">{chat.patient.email}</p>\n                    <div className=\"mt-1.5 flex items-center gap-2 flex-wrap\">\n                      {getStatusBadge(chat.status)}\n                      {chat.patient.is_messages_blocked && (\n                        <Badge variant=\"secondary\" className=\"bg-gray-700 text-white text-xs\">\n                          <Ban className=\"w-3 h-3 mr-1\" />\n                          Заблокирован\n                        </Badge>\n                      )}\n                    </div>\n                  </div>\n                </div>\n                <div className=\"flex items-center gap-2 flex-shrink-0\">\n                  {chat.status !== 'CLOSED' && (\n                    <>\n                      {chat.status === 'WAITING' && (\n                        <Button\n                          onClick={handleTakeChat}\n                          className=\"bg-[#18A36C] text-white hover:bg-[#15905f] shadow-sm cursor-pointer\"\n                        >\n                          Взять чат\n                        </Button>\n                      )}\n                      {chat.status === 'ACTIVE' && (\n                        <Button\n                          onClick={handleCloseChat}\n                          variant=\"outline\"\n                          className=\"text-gray-700 border-gray-300 cursor-pointer\"\n                        >\n                          Закрыть чат\n                        </Button>\n                      )}\n                    </>\n                  )}\n                  <button\n                    onClick={handleDeleteChat}\n                    title=\"Удалить чат\"\n                    className=\"w-10 h-10 rounded-lg flex items-center justify-center transition-all bg-red-50 text-red-600 hover:bg-red-100 cursor-pointer\"\n                  >\n                    <Trash2 className=\"w-5 h-5\" />\n                  </button>\n                  <button\n                    onClick={handleBlockUser}\n                    title={chat.patient.is_messages_blocked ? 'Разблокировать' : 'Заблокировать'}\n                    className={`w-10 h-10 rounded-lg flex items-center justify-center transition-all cursor-pointer ${chat.patient.is_messages_blocked\n                      ? 'bg-[#18A36C]/10 text-[#18A36C] hover:bg-[#18A36C]/20'\n                      : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\n                      }`}\n                  >\n                    {chat.patient.is_messages_blocked ? (\n                      <UserX className=\"w-5 h-5\" />\n                    ) : (\n                      <Ban className=\"w-5 h-5\" />\n                    )}\n                  </button>\n                  <button\n                    onClick={onClose}\n                    className=\"w-10 h-10 rounded-lg bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600 transition-colors cursor-pointer\"\n                  >\n                    <X className=\"w-5 h-5\" />\n                  </button>\n                </div>\n              </div>\n\n              {/* Messages */}\n              <div className=\"flex-1 overflow-y-auto p-6 space-y-4 bg-gradient-to-b from-gray-50 to-white\">\n                {chat.messages.map((msg) => (\n                  <motion.div\n                    key={msg.id}\n                    initial={{ opacity: 0, y: 10 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    className={`flex gap-3 ${msg.sender_type === 'operator' ? 'flex-row-reverse' : ''}`}\n                  >\n                    {msg.sender.avatar_url ? (\n                      <img\n                        src={msg.sender.avatar_url}\n                        alt={msg.sender.name}\n                        className=\"w-10 h-10 rounded-full object-cover flex-shrink-0 shadow-sm\"\n                      />\n                    ) : (\n                      <div\n                        className={`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 shadow-sm ${msg.sender_type === 'operator'\n                          ? 'bg-gradient-to-br from-[#18A36C] to-[#15905f]'\n                          : 'bg-gradient-to-br from-gray-400 to-gray-500'\n                          }`}\n                      >\n                        {msg.sender_type === 'operator' ? (\n                          <Bot className=\"w-5 h-5 text-white\" />\n                        ) : (\n                          <User className=\"w-5 h-5 text-white\" />\n                        )}\n                      </div>\n                    )}\n                    <div className={`max-w-[70%] ${msg.sender_type === 'operator' ? 'items-end' : 'items-start'} flex flex-col`}>\n                      <div\n                        className={`rounded-2xl p-4 shadow-sm ${msg.sender_type === 'operator'\n                          ? 'bg-gradient-to-br from-[#18A36C] to-[#15905f] text-white'\n                          : 'bg-white text-gray-800 border border-gray-200'\n                          }`}\n                      >\n                        <p className=\"text-sm leading-relaxed whitespace-pre-wrap\">{msg.content}</p>\n                      </div>\n                      <div className=\"flex items-center gap-2 mt-1.5 px-2\">\n                        <Clock className=\"w-3 h-3 text-gray-400\" />\n                        <span className=\"text-xs text-gray-500\">{formatTime(msg.created_at)}</span>\n                        {msg.sender_type === 'operator' && msg.is_read && (\n                          <CheckCheck className=\"w-4 h-4 text-[#18A36C]\" />\n                        )}\n                      </div>\n                    </div>\n                  </motion.div>\n                ))}\n                <div ref={messagesEndRef} />\n              </div>\n\n              {/* Input */}\n              {chat.status !== 'CLOSED' && (\n                <div className=\"p-4 bg-white border-t border-gray-200\">\n                  <div className=\"flex gap-3\">\n                    <input\n                      type=\"text\"\n                      value={message}\n                      onChange={(e) => setMessage(e.target.value)}\n                      onKeyPress={handleKeyPress}\n                      placeholder=\"Напишите сообщение...\"\n                      disabled={sending}\n                      className=\"flex-1 px-4 py-3 bg-gray-50 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#18A36C] focus:border-transparent transition-all disabled:opacity-50\"\n                    />\n                    <button\n                      onClick={handleSendMessage}\n                      disabled={sending || !message.trim()}\n                      className=\"w-12 h-12 bg-gradient-to-br from-[#18A36C] to-[#15905f] rounded-xl flex items-center justify-center text-white hover:shadow-md hover:scale-105 transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 cursor-pointer\"\n                    >\n                      {sending ? (\n                        <Loader2 className=\"w-5 h-5 animate-spin\" />\n                      ) : (\n                        <Send className=\"w-5 h-5\" />\n                      )}\n                    </button>\n                  </div>\n                </div>\n              )}\n            </>\n          ) : (\n            <div className=\"flex items-center justify-center h-96\">\n              <p className=\"text-gray-600\">Чат не найден</p>\n            </div>\n          )}\n        </motion.div>\n\n        {/* Block Confirmation Modal */}\n        {showBlockConfirm && chat && (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            className=\"absolute inset-0 z-20 flex items-center justify-center bg-black/40 backdrop-blur-sm\"\n            onClick={() => setShowBlockConfirm(false)}\n          >\n            <motion.div\n              initial={{ opacity: 0, scale: 0.9, y: 20 }}\n              animate={{ opacity: 1, scale: 1, y: 0 }}\n              exit={{ opacity: 0, scale: 0.9, y: 20 }}\n              onClick={(e) => e.stopPropagation()}\n              className=\"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 overflow-hidden\"\n            >\n              {/* Header */}\n              <div className={`p-6 ${chat.patient.is_messages_blocked\n                ? 'bg-gradient-to-r from-[#18A36C] to-[#15905f]'\n                : 'bg-gradient-to-r from-[#18A36C] to-[#15905f]'\n                }`}>\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center\">\n                    {chat.patient.is_messages_blocked ? (\n                      <UserX className=\"w-6 h-6 text-white\" />\n                    ) : (\n                      <Ban className=\"w-6 h-6 text-white\" />\n                    )}\n                  </div>\n                  <div>\n                    <h3 className=\"text-lg font-bold text-white\">\n                      {chat.patient.is_messages_blocked ? 'Разблокировать пользователя?' : 'Заблокировать пользователя?'}\n                    </h3>\n                    <p className=\"text-sm text-white/80\">{chat.patient.name}</p>\n                  </div>\n                </div>\n              </div>\n\n              {/* Content */}\n              <div className=\"p-6\">\n                <p className=\"text-gray-700 leading-relaxed\">\n                  {chat.patient.is_messages_blocked\n                    ? 'Пользователь сможет снова создавать новые чаты и отправлять сообщения.'\n                    : 'Пользователь не сможет создавать новые чаты и отправлять сообщения. Все его чаты будут удалены.'}\n                </p>\n              </div>\n\n              {/* Actions */}\n              <div className=\"px-6 pb-6 flex gap-3 justify-end\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => setShowBlockConfirm(false)}\n                  disabled={blocking}\n                  className=\"border-gray-300 text-gray-700 hover:bg-gray-50 cursor-pointer\"\n                >\n                  Отмена\n                </Button>\n                <Button\n                  onClick={confirmBlockUser}\n                  disabled={blocking}\n                  className={\n                    chat.patient.is_messages_blocked\n                      ? 'bg-[#18A36C] hover:bg-[#15905f] text-white shadow-md flex items-center gap-2 cursor-pointer'\n                      : 'bg-gray-700 hover:bg-gray-800 text-white shadow-md flex items-center gap-2 cursor-pointer'\n                  }\n                >\n                  {blocking && <Loader2 className=\"w-4 h-4 animate-spin\" />}\n                  {chat.patient.is_messages_blocked ? 'Разблокировать' : 'Заблокировать'}\n                </Button>\n              </div>\n            </motion.div>\n          </motion.div>\n        )}\n\n        {/* Delete Confirmation Modal */}\n        {showDeleteConfirm && chat && (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            className=\"absolute inset-0 z-20 flex items-center justify-center bg-black/40 backdrop-blur-sm\"\n            onClick={() => setShowDeleteConfirm(false)}\n          >\n            <motion.div\n              initial={{ opacity: 0, scale: 0.9, y: 20 }}\n              animate={{ opacity: 1, scale: 1, y: 0 }}\n              exit={{ opacity: 0, scale: 0.9, y: 20 }}\n              onClick={(e) => e.stopPropagation()}\n              className=\"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 overflow-hidden\"\n            >\n              {/* Header */}\n              <div className=\"p-6 bg-gradient-to-r from-red-500 to-red-600\">\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center\">\n                    <Trash2 className=\"w-6 h-6 text-white\" />\n                  </div>\n                  <div>\n                    <h3 className=\"text-lg font-bold text-white\">\n                      Удалить чат?\n                    </h3>\n                    <p className=\"text-sm text-white/80\">{chat.patient.name}</p>\n                  </div>\n                </div>\n              </div>\n\n              {/* Content */}\n              <div className=\"p-6\">\n                <p className=\"text-gray-700 leading-relaxed\">\n                  Все сообщения в этом чате будут удалены безвозвратно. Это действие нельзя отменить.\n                </p>\n              </div>\n\n              {/* Actions */}\n              <div className=\"px-6 pb-6 flex gap-3 justify-end\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => setShowDeleteConfirm(false)}\n                  disabled={deleting}\n                  className=\"border-gray-300 text-gray-700 hover:bg-gray-50 cursor-pointer\"\n                >\n                  Отмена\n                </Button>\n                <Button\n                  onClick={confirmDeleteChat}\n                  disabled={deleting}\n                  className=\"bg-red-500 hover:bg-red-600 text-white shadow-md flex items-center gap-2 cursor-pointer\"\n                >\n                  {deleting && <Loader2 className=\"w-4 h-4 animate-spin\" />}\n                  Удалить\n                </Button>\n              </div>\n            </motion.div>\n          </motion.div>\n        )}\n      </div>\n    </AnimatePresence>\n  );\n}\n","'use client';\n\nexport const dynamic = 'force-dynamic';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { useSession } from 'next-auth/react';\nimport { useRouter } from 'next/navigation';\nimport { AdminAccessSkeleton } from '@/components/SMAdmin/SMAdminSkeleton';\nimport { MessagesSquare, Clock, User, CheckCheck, MessageCircle, Ban, UserX, Loader2, ArrowLeft } from 'lucide-react';\nimport { Badge } from '@/components/common/SMBadge/SMBadge';\nimport { Button } from '@/components/common/SMButton/SMButton';\nimport { ChatModal } from '@/components/SMAdmin/ChatModal';\nimport { useAlert } from '@/components/common/SMAlert/AlertProvider';\nimport { Pagination } from '@/components/common/SMPagination/SMPagination';\nimport { useUrlPagination } from '@/hooks/useUrlPagination';\n\ninterface ChatMessage {\n  id: number;\n  chat_id: number;\n  sender_id: number;\n  sender_type: 'patient' | 'operator';\n  content: string;\n  created_at: string;\n  is_read: boolean;\n}\n\ninterface Chat {\n  id: number;\n  patient_id: number;\n  operator_id: number | null;\n  status: 'WAITING' | 'ACTIVE' | 'CLOSED';\n  created_at: string;\n  updated_at: string;\n  last_message_at: string | null;\n  has_unread_operator: boolean;\n  has_unread_patient: boolean;\n  patient: {\n    id: number;\n    name: string;\n    email: string;\n    avatar_url: string | null;\n    is_messages_blocked: boolean;\n  };\n  operator: {\n    id: number;\n    name: string;\n  } | null;\n  messages: ChatMessage[];\n}\n\ninterface BlockedUser {\n  id: number;\n  name: string;\n  email: string;\n  avatar_url: string | null;\n  phone: string | null;\n  registration_date: string;\n}\n\nexport default function AdminChatPage() {\n  const { data: session, status } = useSession();\n  const router = useRouter();\n  const alert = useAlert();\n\n  const [hasAdminRole, setHasAdminRole] = useState<boolean | null>(null);\n  const [isCheckingRole, setIsCheckingRole] = useState(true);\n  const [chats, setChats] = useState<Chat[]>([]);\n  const [blockedUsers, setBlockedUsers] = useState<BlockedUser[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedChatId, setSelectedChatId] = useState<number | null>(null);\n  const [filterStatus, setFilterStatus] = useState<'ALL' | 'WAITING' | 'ACTIVE' | 'CLOSED' | 'BLOCKED'>('ALL');\n  const [unblockingUserId, setUnblockingUserId] = useState<number | null>(null);\n  // Pagination hook\n  const { currentPage, setPage, paginateData } = useUrlPagination(9);\n  const ITEMS_PER_PAGE = 9;\n\n  // Check admin role\n  const checkAdminRole = useCallback(async () => {\n    setIsCheckingRole(true);\n    try {\n      const res = await fetch('/api/admin/auth');\n      const data = await res.json();\n      setHasAdminRole(data.isAdmin || false);\n    } catch (error) {\n      setHasAdminRole(false);\n    } finally {\n      setIsCheckingRole(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (status === 'authenticated') {\n      checkAdminRole();\n    } else if (status === 'unauthenticated') {\n      setIsCheckingRole(false);\n      setHasAdminRole(false);\n    }\n  }, [status, checkAdminRole]);\n\n  // Load chats\n  const loadChats = useCallback(async () => {\n    try {\n      setLoading(true);\n      const response = await fetch('/api/operator-chat');\n      if (response.ok) {\n        const data = await response.json();\n        setChats(data.chats || []);\n      } else {\n        alert.error('Не удалось загрузить чаты', 'Ошибка');\n      }\n    } catch (error) {\n      alert.error('Ошибка при загрузке чатов', 'Ошибка');\n    } finally {\n      setLoading(false);\n    }\n  }, [alert]);\n\n  // Load blocked users\n  const loadBlockedUsers = useCallback(async () => {\n    try {\n      const response = await fetch('/api/admin/blocked-users');\n      if (response.ok) {\n        const data = await response.json();\n        setBlockedUsers(data.users || []);\n      } else {\n        alert.error('Не удалось загрузить заблокированных пользователей', 'Ошибка');\n      }\n    } catch (error) {\n      alert.error('Ошибка при загрузке заблокированных пользователей', 'Ошибка');\n    }\n  }, [alert]);\n\n  // Unblock user\n  const handleUnblockUser = async (userId: number) => {\n    setUnblockingUserId(userId);\n    try {\n      const response = await fetch('/api/admin/blocked-users', {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ patientId: userId }),\n      });\n\n      if (response.ok) {\n        alert.success('Пользователь разблокирован', 'Успех');\n        loadBlockedUsers(); // Reload blocked users\n      } else {\n        const data = await response.json();\n        alert.error(data.error || 'Не удалось разблокировать пользователя', 'Ошибка');\n      }\n    } catch (error) {\n      alert.error('Ошибка при разблокировке пользователя', 'Ошибка');\n    } finally {\n      setUnblockingUserId(null);\n    }\n  };\n\n  useEffect(() => {\n    if (hasAdminRole) {\n      loadChats();\n      loadBlockedUsers();\n      // Автообновление убрано - список обновляется через уведомления и при закрытии модалки\n    }\n  }, [hasAdminRole, loadChats, loadBlockedUsers]);\n\n  // Redirect if not authenticated\n  useEffect(() => {\n    if (status === 'unauthenticated') {\n      router.push('/account?section=login');\n    }\n  }, [status, router]);\n\n  // Reset page when filter changes\n  useEffect(() => {\n    setPage(1);\n  }, [filterStatus]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  // Show loading skeleton while checking role\n  if (status === 'loading' || hasAdminRole === null || isCheckingRole) {\n    return <AdminAccessSkeleton />;\n  }\n\n  // Redirect to home if no admin access\n  if (!hasAdminRole) {\n    router.push('/');\n    return <AdminAccessSkeleton />;\n  }\n\n  const getStatusBadge = (status: string) => {\n    switch (status) {\n      case 'WAITING':\n        return <Badge variant=\"outline\" className=\"border-amber-400 text-amber-700 bg-amber-50\">Ожидает</Badge>;\n      case 'ACTIVE':\n        return <Badge variant=\"default\" className=\"bg-[#18A36C] text-white border-transparent shadow-sm\">Активный</Badge>;\n      case 'CLOSED':\n        return <Badge variant=\"secondary\" className=\"bg-gray-200 text-gray-700\">Закрыт</Badge>;\n      default:\n        return null;\n    }\n  };\n\n  const getTimeAgo = (date: string) => {\n    const now = new Date();\n    const messageDate = new Date(date);\n    const diffInMinutes = Math.floor((now.getTime() - messageDate.getTime()) / 60000);\n\n    if (diffInMinutes < 1) return 'только что';\n    if (diffInMinutes < 60) return `${diffInMinutes} мин назад`;\n    const diffInHours = Math.floor(diffInMinutes / 60);\n    if (diffInHours < 24) return `${diffInHours} ч назад`;\n    const diffInDays = Math.floor(diffInHours / 24);\n    return `${diffInDays} д назад`;\n  };\n\n  // Фильтрация - исключаем заблокированных из обычных чатов\n  let filteredChats = filterStatus === 'ALL'\n    ? chats\n    : chats.filter(chat => chat.status === filterStatus);\n\n  const waitingCount = chats.filter(c => c.status === 'WAITING').length;\n  const activeCount = chats.filter(c => c.status === 'ACTIVE').length;\n  const blockedCount = blockedUsers.length;\n\n  // Pagination for chats\n  const totalChatPages = Math.ceil(filteredChats.length / ITEMS_PER_PAGE);\n  const paginatedChats = filteredChats.slice(\n    (currentPage - 1) * ITEMS_PER_PAGE,\n    currentPage * ITEMS_PER_PAGE\n  );\n\n  // Pagination for blocked users\n  const totalBlockedPages = Math.ceil(blockedUsers.length / ITEMS_PER_PAGE);\n  const paginatedBlockedUsers = blockedUsers.slice(\n    (currentPage - 1) * ITEMS_PER_PAGE,\n    currentPage * ITEMS_PER_PAGE\n  );\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <div className=\"max-w-7xl mx-auto px-4 py-6 lg:py-8\">\n        {/* Header */}\n        <div className=\"mb-6\">\n          <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-br from-[#18A36C] to-[#15905f] rounded-xl flex items-center justify-center shadow-md\">\n                <MessagesSquare className=\"w-5 h-5 sm:w-6 sm:h-6 text-white\" />\n              </div>\n              <div>\n                <h1 className=\"text-xl sm:text-2xl font-bold text-gray-900\">Чат с пациентами</h1>\n                <p className=\"text-xs sm:text-sm text-gray-600\">Управление обращениями</p>\n              </div>\n            </div>\n            <Button\n              variant=\"outline\"\n              onClick={() => router.push('/admin')}\n              className=\"flex items-center gap-2 hover:bg-gray-50 self-start sm:self-auto cursor-pointer\"\n            >\n              <ArrowLeft className=\"w-4 h-4\" />\n              <span className=\"hidden sm:inline\">Назад в админ-панель</span>\n              <span className=\"sm:hidden\">Назад</span>\n            </Button>\n          </div>\n\n          {/* Filters */}\n          <div className=\"flex flex-wrap gap-2\">\n            <Button\n              variant={filterStatus === 'ALL' ? 'default' : 'outline'}\n              onClick={() => setFilterStatus('ALL')}\n              className={filterStatus === 'ALL' ? 'bg-[#18A36C] hover:bg-[#15905f] shadow-sm text-white cursor-pointer' : 'hover:bg-gray-50 cursor-pointer'}\n            >\n              Все ({chats.length})\n            </Button>\n            <Button\n              variant={filterStatus === 'WAITING' ? 'default' : 'outline'}\n              onClick={() => setFilterStatus('WAITING')}\n              className={filterStatus === 'WAITING' ? 'bg-[#18A36C] hover:bg-[#15905f] shadow-sm text-white cursor-pointer' : 'hover:bg-gray-50 cursor-pointer'}\n            >\n              Ожидают ({waitingCount})\n            </Button>\n            <Button\n              variant={filterStatus === 'ACTIVE' ? 'default' : 'outline'}\n              onClick={() => setFilterStatus('ACTIVE')}\n              className={filterStatus === 'ACTIVE' ? 'bg-[#18A36C] hover:bg-[#15905f] shadow-sm text-white cursor-pointer' : 'hover:bg-gray-50 cursor-pointer'}\n            >\n              Активные ({activeCount})\n            </Button>\n            <Button\n              variant={filterStatus === 'CLOSED' ? 'default' : 'outline'}\n              onClick={() => setFilterStatus('CLOSED')}\n              className={filterStatus === 'CLOSED' ? 'bg-[#18A36C] hover:bg-[#15905f] shadow-sm text-white cursor-pointer' : 'hover:bg-gray-50 cursor-pointer'}\n            >\n              Закрытые\n            </Button>\n            <Button\n              variant={filterStatus === 'BLOCKED' ? 'default' : 'outline'}\n              onClick={() => setFilterStatus('BLOCKED')}\n              className={filterStatus === 'BLOCKED' ? 'bg-red-500 hover:bg-red-600 shadow-sm text-white cursor-pointer' : 'hover:bg-gray-50 text-red-600 border-red-300 cursor-pointer'}\n            >\n              Заблокированные ({blockedCount})\n            </Button>\n          </div>\n        </div>\n\n        {/* Content */}\n        {loading ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n            {[1, 2, 3, 4, 5, 6].map((i) => (\n              <div key={i} className=\"bg-white rounded-lg p-6 border border-gray-200 animate-pulse\">\n                <div className=\"h-4 bg-gray-200 rounded w-3/4 mb-4\" />\n                <div className=\"h-3 bg-gray-200 rounded w-1/2\" />\n              </div>\n            ))}\n          </div>\n        ) : filterStatus === 'BLOCKED' ? (\n          // Blocked Users Cards\n          blockedUsers.length === 0 ? (\n            <div className=\"bg-white rounded-lg p-12 text-center border border-gray-200\">\n              <MessageCircle className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">\n                Нет заблокированных пользователей\n              </h3>\n              <p className=\"text-gray-600\">\n                Заблокированные пользователи появятся здесь\n              </p>\n            </div>\n          ) : (\n            <>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {paginatedBlockedUsers.map((user) => (\n                <div\n                  key={user.id}\n                  className=\"bg-white rounded-xl p-5 border-2 border-red-300 bg-red-50/20 shadow-sm\"\n                >\n                  {/* Header */}\n                  <div className=\"flex items-start justify-between mb-4\">\n                    <div className=\"flex items-center gap-3\">\n                      {user.avatar_url ? (\n                        <img\n                          src={user.avatar_url}\n                          alt={user.name}\n                          className=\"w-12 h-12 rounded-full object-cover shadow-sm\"\n                        />\n                      ) : (\n                        <div className=\"w-12 h-12 bg-gradient-to-br from-gray-400 to-gray-500 rounded-full flex items-center justify-center shadow-sm\">\n                          <User className=\"w-6 h-6 text-white\" />\n                        </div>\n                      )}\n                      <div>\n                        <h3 className=\"font-semibold text-gray-900\">{user.name}</h3>\n                        <p className=\"text-xs text-gray-500\">{user.email}</p>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Info */}\n                  <div className=\"mb-4\">\n                    <Badge variant=\"secondary\" className=\"bg-red-100 text-red-700 border-red-300 mb-2\">\n                      <Ban className=\"w-3 h-3 mr-1\" />\n                      Заблокирован\n                    </Badge>\n                    {user.phone && (\n                      <p className=\"text-sm text-gray-600 mt-2\">{user.phone}</p>\n                    )}\n                  </div>\n\n                  {/* Footer */}\n                  <div className=\"flex items-center justify-between pt-4 border-t border-gray-200\">\n                    <div className=\"flex items-center gap-1.5 text-xs text-gray-500\">\n                      <Clock className=\"w-3.5 h-3.5\" />\n                      <span>{new Date(user.registration_date).toLocaleDateString('ru-RU')}</span>\n                    </div>\n                    <Button\n                      onClick={() => handleUnblockUser(user.id)}\n                      disabled={unblockingUserId === user.id}\n                      className=\"bg-[#18A36C] hover:bg-[#15905f] text-white text-xs px-3 py-1.5 flex items-center gap-1.5 cursor-pointer\"\n                    >\n                      {unblockingUserId === user.id ? (\n                        <Loader2 className=\"w-3.5 h-3.5 animate-spin\" />\n                      ) : (\n                        <UserX className=\"w-3.5 h-3.5\" />\n                      )}\n                      Разблокировать\n                    </Button>\n                  </div>\n                </div>\n              ))}\n            </div>\n\n            {/* Pagination for blocked users */}\n            {totalBlockedPages > 1 && (\n              <Pagination\n                currentPage={currentPage}\n                totalPages={totalBlockedPages}\n                onPageChange={setPage}\n                className=\"mt-6\"\n              />\n            )}\n          </>\n          )\n        ) : (\n          // Chat Cards\n          filteredChats.length === 0 ? (\n            <div className=\"bg-white rounded-lg p-12 text-center border border-gray-200\">\n              <MessageCircle className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">\n                {filterStatus === 'ALL' && 'Нет чатов'}\n                {filterStatus === 'WAITING' && 'Нет ожидающих чатов'}\n                {filterStatus === 'ACTIVE' && 'Нет активных чатов'}\n                {filterStatus === 'CLOSED' && 'Нет закрытых чатов'}\n              </h3>\n              <p className=\"text-gray-600\">\n                {filterStatus === 'WAITING' && 'Когда пациенты напишут, их чаты появятся здесь'}\n                {filterStatus === 'ACTIVE' && 'Нет активных чатов в данный момент'}\n                {filterStatus === 'CLOSED' && 'Нет закрытых чатов'}\n                {filterStatus === 'ALL' && 'Чаты появятся когда пациенты начнут писать'}\n              </p>\n            </div>\n          ) : (\n            <>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {paginatedChats.map((chat) => (\n                <div\n                  key={chat.id}\n                  className={`bg-white rounded-xl p-5 border-2 transition-all cursor-pointer ${\n                    chat.has_unread_operator\n                      ? 'border-[#18A36C] bg-[#18A36C]/5 shadow-sm hover:shadow-md'\n                      : 'border-gray-200 hover:border-[#18A36C]/50 hover:shadow-md'\n                  }`}\n                  onClick={() => setSelectedChatId(chat.id)}\n                >\n                  {/* Header */}\n                  <div className=\"flex items-start justify-between mb-4\">\n                    <div className=\"flex items-center gap-3\">\n                      {chat.patient.avatar_url ? (\n                        <img\n                          src={chat.patient.avatar_url}\n                          alt={chat.patient.name}\n                          className=\"w-12 h-12 rounded-full object-cover shadow-sm\"\n                        />\n                      ) : (\n                        <div className=\"w-12 h-12 bg-gradient-to-br from-[#18A36C] to-[#15905f] rounded-full flex items-center justify-center shadow-sm\">\n                          <User className=\"w-6 h-6 text-white\" />\n                        </div>\n                      )}\n                      <div>\n                        <h3 className=\"font-semibold text-gray-900\">{chat.patient.name}</h3>\n                        <p className=\"text-xs text-gray-500\">{chat.patient.email}</p>\n                      </div>\n                    </div>\n                    {chat.has_unread_operator && (\n                      <div className=\"w-2.5 h-2.5 bg-red-500 rounded-full animate-pulse\" />\n                    )}\n                  </div>\n\n                  {/* Status */}\n                  <div className=\"flex items-center gap-2 mb-3 flex-wrap\">\n                    {getStatusBadge(chat.status)}\n                    {chat.operator && (\n                      <span className=\"text-xs text-gray-500\">\n                        Оператор: {chat.operator.name}\n                      </span>\n                    )}\n                  </div>\n\n                  {/* Last Message */}\n                  {chat.messages.length > 0 && (\n                    <div className=\"mb-3\">\n                      <p className=\"text-sm text-gray-700 line-clamp-2\">\n                        {chat.messages[0].content}\n                      </p>\n                    </div>\n                  )}\n\n                  {/* Footer */}\n                  <div className=\"flex items-center justify-between text-xs text-gray-500 pt-3 border-t border-gray-100\">\n                    <div className=\"flex items-center gap-1.5\">\n                      <Clock className=\"w-3.5 h-3.5\" />\n                      <span>{chat.last_message_at ? getTimeAgo(chat.last_message_at) : 'Нет сообщений'}</span>\n                    </div>\n                    {chat.has_unread_operator ? (\n                      <span className=\"text-[#18A36C] font-semibold\">Новое</span>\n                    ) : (\n                      <CheckCheck className=\"w-4 h-4 text-gray-400\" />\n                    )}\n                  </div>\n                </div>\n              ))}\n            </div>\n\n            {/* Pagination for chats */}\n            {totalChatPages > 1 && (\n              <Pagination\n                currentPage={currentPage}\n                totalPages={totalChatPages}\n                onPageChange={setPage}\n                className=\"mt-6\"\n              />\n            )}\n          </>\n          )\n        )}\n      </div>\n\n      {/* Chat Modal */}\n      {selectedChatId && (\n        <ChatModal\n          chatId={selectedChatId}\n          onClose={() => {\n            setSelectedChatId(null);\n            loadChats(); // Перезагружаем список чатов после закрытия\n            loadBlockedUsers(); // Перезагружаем заблокированных пользователей\n          }}\n        />\n      )}\n    </div>\n  );\n}\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2', key: '1yyitq' }],\n  ['circle', { cx: '9', cy: '7', r: '4', key: 'nufk8' }],\n  ['line', { x1: '17', x2: '22', y1: '8', y2: '13', key: '3nzzx3' }],\n  ['line', { x1: '22', x2: '17', y1: '8', y2: '13', key: '1swrse' }],\n];\n\n/**\n * @component @name UserX\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTYgMjF2LTJhNCA0IDAgMCAwLTQtNEg2YTQgNCAwIDAgMC00IDR2MiIgLz4KICA8Y2lyY2xlIGN4PSI5IiBjeT0iNyIgcj0iNCIgLz4KICA8bGluZSB4MT0iMTciIHgyPSIyMiIgeTE9IjgiIHkyPSIxMyIgLz4KICA8bGluZSB4MT0iMjIiIHgyPSIxNyIgeTE9IjgiIHkyPSIxMyIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/user-x\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst UserX = createLucideIcon('user-x', __iconNode);\n\nexport default UserX;\n"],"names":[],"mappings":"wDEIA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OCaA,CAAA,CAAA,CAAA,CAAA,AAAM,CAAN,CAAM,CAAA,EAAQ,AAAR,CAAQ,AAAR,CAAA,AAAQ,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,GAAA,EAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAlBK,CAClC,AAiBuC,CAjBtC,AAiBsC,CAjBtC,AAiBsC,CAjBtC,AAiBsC,CAjBtC,AAiBsC,CAjBtC,AAiBsC,CAjBtC,AAiBsC,CAjBtC,AAiBsC,CAjBtC,AAAQ,AAiB8B,CAjB5B,AAAF,AAiB8B,CAAU,CAAA,AAjBnC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAA6C,CAAA,CAAA,CAAA,CAAA,AAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA,CAC1E,CAAC,QAAA,CAAA,AAAU,CAAA,AAAE,EAAA,CAAA,AAAI,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,AAAI,GAAA,CAAA,AAAK,CAAA,CAAG,CAAA,CAAA,CAAA,CAAK,AAAL,GAAK,CAAA,AAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAS,CAAA,CACrD,CAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAQ,CAAA,AAAE,CAAA,CAAA,CAAI,CAAA,CAAA,CAAA,CAAA,CAAA,AAAM,CAAA,CAAA,CAAA,AAAI,CAAA,CAAA,CAAA,CAAA,CAAA,AAAM,EAAA,CAAA,AAAI,CAAA,CAAA,CAAA,CAAA,AAAK,CAAA,CAAA,CAAI,AAAJ,CAAI,CAAA,CAAA,CAAA,CAAM,CAAA,CAAA,CAAA,CAAA,AAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA,EAChE,OAAQ,CAAA,AAAE,EAAA,CAAA,AAAI,CAAA,CAAA,CAAA,CAAA,CAAA,AAAM,CAAA,CAAA,CAAA,AAAI,CAAA,CAAA,CAAA,CAAA,CAAM,CAAA,CAAA,CAAA,AAAI,CAAA,CAAA,CAAA,CAAA,AAAK,CAAA,CAAA,CAAA,AAAI,IAAA,CAAM,AAAN,CAAM,CAAA,CAAA,CAAA,AAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA,CACnE,EDAA,IAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,KACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,MDPA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OAGA,EAAA,EAAA,CAAA,CAAA,OA+CO,SAAS,EAAU,QAAE,CAAM,SAAE,CAAO,CAAkB,EAC3D,GAAM,CAAC,EAAM,EAAQ,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAc,MACxC,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjC,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACjC,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjC,CAAC,EAAkB,EAAoB,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,GAAS,GACnD,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACnC,CAAC,EAAmB,EAAqB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACrD,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACnC,EAAiB,CAAA,EAAA,EAAA,MAAA,AAAM,EAAiB,MACxC,EAAQ,CAAA,EAAA,EAAA,QAAA,AAAQ,IAMhB,EAAW,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,UAC3B,GAAI,CACF,IAAM,EAAW,MAAM,MAAM,CAAC,mBAAmB,EAAE,EAAA,CAAQ,EAC3D,GAAI,EAAS,EAAE,CAAE,CACf,IAAM,EAAO,MAAM,EAAS,IAAI,GAChC,EAAQ,EAAK,IAAI,CAGnB,MACE,CADK,CACC,KAAK,CAAC,2BAA4B,SAE5C,CAAE,MAAO,EAAO,CACd,EAAM,KAAK,CAAC,2BAA4B,SAC1C,QAAU,CACR,GAAW,EACb,CACF,EAAG,CAAC,EAAQ,EAAM,EAElB,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,GAEF,EAAG,CAAC,EAAS,EAEb,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACJ,GA3BJ,EAAe,CA2BL,MA3BY,EAAE,eAAe,CAAE,SAAU,QAAS,EA8B9D,EAAG,CAAC,GAAM,SAAS,EAEnB,IAAM,EAAiB,UACrB,GAAI,CACe,AAMb,OANmB,MAAM,CAAC,mBAAmB,EAAE,EAAA,CAAQ,CAAE,CAC3D,OAAQ,QACR,QAAS,CAAE,eAAgB,kBAAmB,EAC9C,KAAM,KAAK,SAAS,CAAC,CAAE,OAAQ,MAAO,EACxC,EAAA,EAEa,EAAE,EAAE,AACf,EAAM,OAAO,CAAC,eAAgB,SAC9B,KAEA,EAAM,KAAK,CAAC,uBAAwB,SAExC,CAAE,MAAO,EAAO,CACd,EAAM,KAAK,CAAC,yBAA0B,SACxC,CACF,EAEM,EAAkB,UACtB,GAAI,CACe,AAMb,OANmB,MAAM,CAAC,mBAAmB,EAAE,EAAA,CAAQ,CAAE,CAC3D,OAAQ,QACR,QAAS,CAAE,eAAgB,kBAAmB,EAC9C,KAAM,KAAK,SAAS,CAAC,CAAE,OAAQ,QAAS,EAC1C,EAAA,EAEa,EAAE,EAAE,AACf,EAAM,OAAO,CAAC,aAAc,SAC5B,KAEA,EAAM,KAAK,CAAC,yBAA0B,SAE1C,CAAE,MAAO,EAAO,CACd,EAAM,KAAK,CAAC,2BAA4B,SAC1C,CACF,EAOM,EAAmB,UACvB,GAAI,CAAC,GAAQ,EAAU,OAEvB,IAAM,EAAS,EAAK,OAAO,CAAC,mBAAmB,CAAG,UAAY,QAC9D,GAAY,GAEZ,GAAI,CACF,IAAM,EAAW,MAAM,MAAM,CAAC,mBAAmB,EAAE,EAAO,MAAM,CAAC,CAAE,CACjE,OAAQ,QACR,QAAS,CAAE,eAAgB,kBAAmB,EAC9C,KAAM,KAAK,SAAS,CAAC,QAAE,CAAO,EAChC,GAEM,EAAO,MAAM,EAAS,IAAI,GAE5B,EAAS,EAAE,EAAE,AACf,EAAM,OAAO,CACX,AAAW,YAAU,mDAAqD,6BAC1E,SAEa,SAAS,CAApB,EAEF,KAEA,MAAM,IACN,GAAoB,KAGtB,EAAM,KAAK,CAAC,EAAK,KAAK,EAAI,eAA4B,CAAZ,SAAC,EAAqB,gBAAkB,gBAAA,CAAgB,CAAI,gBAAiB,SAE3H,CAAE,MAAO,EAAO,CACd,EAAM,KAAK,CAAC,sCAAuC,SACrD,QAAU,CACR,GAAY,EACd,CACF,EAMM,EAAoB,UACxB,GAAI,AAAC,IAAQ,GAEb,GAAY,GAEZ,CAJuB,EAInB,CACF,IAAM,EAAW,MAAM,MAAM,CAAC,mBAAmB,EAAE,EAAA,CAAQ,CAAE,CAC3D,OAAQ,QACV,GAEM,EAAO,MAAM,EAAS,IAAI,GAE5B,EAAS,EAAE,EAAE,AACf,EAAM,OAAO,CAAC,aAAc,SAC5B,KAEA,EAAM,KAAK,CAAC,EAAK,KAAK,EAAI,yBAA0B,SAExD,CAAE,MAAO,EAAO,CACd,EAAM,KAAK,CAAC,2BAA4B,SAC1C,QAAU,CACR,GAAY,EACd,EACF,EAEM,EAAoB,UACxB,GAAI,AAAC,EAAQ,IAAI,KAAM,GAEvB,GAAW,GAFqB,AAGhC,GAAI,CACF,IAAM,EAAW,MAAM,MAAM,CAAC,mBAAmB,EAAE,EAAA,CAAQ,CAAE,CAC3D,OAAQ,OACR,QAAS,CAAE,eAAgB,kBAAmB,EAC9C,KAAM,KAAK,SAAS,CAAC,CAAE,QAAS,EAAQ,IAAI,EAAG,EACjD,GAEA,GAAI,EAAS,EAAE,CACb,CADe,CACJ,IACX,QACK,CACL,IAAM,EAAO,MAAM,EAAS,IAAI,GAChC,EAAM,KAAK,CAAC,EAAK,KAAK,EAAI,iCAAkC,SAC9D,CACF,CAAE,MAAO,EAAO,CACd,EAAM,KAAK,CAAC,gCAAiC,SAC/C,QAAU,CACR,GAAW,EACb,EACF,EA2BA,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,UACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uEAEb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,QAAS,CAAE,QAAS,CAAE,EACtB,QAAS,CAAE,QAAS,CAAE,EACtB,KAAM,CAAE,QAAS,CAAE,EACnB,QAAS,EACT,UAAU,kDAIZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,QAAS,CAAE,QAAS,EAAG,MAAO,IAAM,EAAG,EAAG,EAC1C,QAAS,CAAE,QAAS,EAAG,MAAO,EAAG,EAAG,CAAE,EACtC,KAAM,CAAE,QAAS,EAAG,MAAO,IAAM,EAAG,EAAG,EACvC,UAAU,qHAET,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,0CAEnB,EACF,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WAEE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yHACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,qDACZ,EAAK,OAAO,CAAC,UAAU,CACtB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,IAAK,EAAK,OAAO,CAAC,UAAU,CAC5B,IAAK,EAAK,OAAO,CAAC,IAAI,CACtB,UAAU,+FAGZ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yJACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,uCAGpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,+DAAuD,EAAK,OAAO,CAAC,IAAI,GACtF,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,qDAA6C,EAAK,OAAO,CAAC,KAAK,GAC5E,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,qDA5DV,AA6DF,CA7DG,IACtB,OAAQ,GACN,IAAK,UACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,UAAU,UAAU,uDAA8C,WAC1F,KAAK,SACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,UAAU,UAAU,gEAAuD,YACnG,KAAK,SACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,YAAY,UAAU,qCAA4B,UAC1E,SACE,OAAO,IACX,EACF,EAkDoC,EAAK,MAAM,EAC1B,EAAK,OAAO,CAAC,mBAAmB,EAC/B,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,YAAY,UAAU,2CACnC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,GAAG,CAAA,CAAC,UAAU,iBAAiB,2BAO1C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACI,WAAhB,EAAK,MAAM,EACV,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACmB,YAAhB,EAAK,MAAM,EACV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAS,EACT,UAAU,+EACX,cAIc,WAAhB,EAAK,MAAM,EACV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAS,EACT,QAAQ,UACR,UAAU,wDACX,mBAMP,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QA3JO,CA2JE,IA1JzB,GAAqB,EACvB,EA0JkB,MAAM,cACN,UAAU,uIAEV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,cAEpB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QA5MM,CA4MG,IA3MpB,GACL,GADW,AACS,EACtB,EA0MkB,MAAO,EAAK,OAAO,CAAC,mBAAmB,CAAG,iBAAmB,gBAC7D,UAAW,CAAC,oFAAoF,EAAE,EAAK,OAAO,CAAC,mBAAmB,CAC9H,uDACA,8CAAA,CACA,UAEH,EAAK,OAAO,CAAC,mBAAmB,CAC/B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAM,UAAU,YAEjB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,GAAG,CAAA,CAAC,UAAU,cAGnB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,EACT,UAAU,8IAEV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAC,CAAA,CAAC,UAAU,oBAMnB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wFACZ,EAAK,QAAQ,CAAC,GAAG,CAAC,AAAC,GAClB,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CAET,QAAS,CAAE,QAAS,EAAG,EAAG,EAAG,EAC7B,QAAS,CAAE,QAAS,EAAG,EAAG,CAAE,EAC5B,UAAW,CAAC,WAAW,EAAsB,aAApB,EAAI,WAAW,CAAkB,mBAAqB,GAAA,CAAI,WAElF,EAAI,MAAM,CAAC,UAAU,CACpB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,IAAK,EAAI,MAAM,CAAC,UAAU,CAC1B,IAAK,EAAI,MAAM,CAAC,IAAI,CACpB,UAAU,gEAGZ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,UAAW,CAAC,gFAAgF,EAAsB,aAApB,EAAI,WAAW,CACzG,gDACA,8CAAA,CACA,UAEiB,aAApB,EAAI,WAAW,CACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,GAAG,CAAA,CAAC,UAAU,uBAEf,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,yBAItB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,CAAC,YAAY,EAAsB,aAApB,EAAI,WAAW,CAAkB,YAAc,cAAc,cAAc,CAAC,WACzG,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,UAAW,CAAC,0BAA0B,EAAE,AAAoB,eAAhB,WAAW,CACnD,2DACA,gDAAA,CACA,UAEJ,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,uDAA+C,EAAI,OAAO,KAEzE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,0BACjB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,iCApJ7B,AADG,CAqJmD,GArJ/C,KAAK,AAqJqD,EAAI,UAAU,EApJ7E,kBAAkB,CAAC,QAAS,CAAE,KAAM,UAAW,OAAQ,SAAU,KAqJjC,aAApB,EAAI,WAAW,EAAmB,EAAI,OAAO,EAC5C,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,UAAU,mCAtCvB,EAAI,EAAE,GA4Cf,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,IAAK,OAIK,WAAhB,EAAK,MAAM,EACV,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,OACL,MAAO,EACP,SAAU,AAAC,GAAM,EAAW,EAAE,MAAM,CAAC,KAAK,EAC1C,WA7LG,AAAC,CA6LQ,GA5LhB,UAAV,CAAqB,CAAnB,GAAG,EAAiB,EAAE,QAAQ,EAAE,CACpC,EAAE,cAAc,GAChB,IAEJ,EAyLoB,YAAY,wBACZ,SAAU,EACV,UAAU,mLAEZ,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,EACT,SAAU,GAAW,CAAC,EAAQ,IAAI,GAClC,UAAU,iQAET,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,yBAEnB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,sBAQ5B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iDACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yBAAgB,sBAMlC,GAAoB,GACnB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,QAAS,CAAE,QAAS,CAAE,EACtB,QAAS,CAAE,QAAS,CAAE,EACtB,KAAM,CAAE,QAAS,CAAE,EACnB,UAAU,sFACV,QAAS,IAAM,GAAoB,YAEnC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,QAAS,CAAE,QAAS,EAAG,MAAO,GAAK,EAAG,EAAG,EACzC,QAAS,CAAE,QAAS,EAAG,MAAO,EAAG,EAAG,CAAE,EACtC,KAAM,CAAE,QAAS,EAAG,MAAO,GAAK,EAAG,EAAG,EACtC,QAAS,AAAC,GAAM,EAAE,eAAe,GACjC,UAAU,iFAGV,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,IAAI,GAAE,EAAK,OAAO,CAAC,mBAAmB,CACnD,gDACA,CAAA,AACA,UACF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,+EACZ,EAAK,OAAO,CAAC,mBAAmB,CAC/B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAM,UAAU,uBAEjB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,GAAG,CAAA,CAAC,UAAU,yBAGnB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,wCACX,EAAK,OAAO,CAAC,mBAAmB,CAAG,+BAAiC,gCAEvE,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,iCAAyB,EAAK,OAAO,CAAC,IAAI,WAM7D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,eACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yCACV,EAAK,OAAO,CAAC,mBAAmB,CAC7B,yEACA,sGAKR,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6CACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,UACR,QAAS,IAAM,GAAoB,GACnC,SAAU,EACV,UAAU,yEACX,WAGD,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAS,EACT,SAAU,EACV,UACE,EAAK,OAAO,CAAC,mBAAmB,CAC5B,8FACA,sGAGL,GAAY,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,yBAC/B,EAAK,OAAO,CAAC,mBAAmB,CAAG,iBAAmB,2BAQhE,GAAqB,GACpB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,QAAS,CAAE,QAAS,CAAE,EACtB,QAAS,CAAE,QAAS,CAAE,EACtB,KAAM,CAAE,QAAS,CAAE,EACnB,UAAU,sFACV,QAAS,IAAM,EAAqB,aAEpC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,QAAS,CAAE,QAAS,EAAG,MAAO,GAAK,EAAG,EAAG,EACzC,QAAS,CAAE,QAAS,EAAG,MAAO,EAAG,EAAG,CAAE,EACtC,KAAM,CAAE,QAAS,EAAG,MAAO,GAAK,EAAG,EAAG,EACtC,QAAS,AAAC,GAAM,EAAE,eAAe,GACjC,UAAU,iFAGV,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,wDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,+EACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,yBAEpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,wCAA+B,iBAG7C,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,iCAAyB,EAAK,OAAO,CAAC,IAAI,WAM7D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,eACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yCAAgC,0FAM/C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6CACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,UACR,QAAS,IAAM,GAAqB,GACpC,SAAU,EACV,UAAU,yEACX,WAGD,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAS,EACT,SAAU,EACV,UAAU,oGAET,GAAY,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,yBAA0B,yBAU5E,CC7jBA,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OA6Ce,SAAS,IACtB,GAAM,CAAE,KAAM,CAAO,QAAE,CAAM,CAAE,CAAG,CAAA,EAAA,EAAA,UAAU,AAAV,IAC5B,EAAS,CAAA,EAAA,EAAA,SAAA,AAAS,IAClB,EAAQ,CAAA,EAAA,EAAA,QAAA,AAAQ,IAEhB,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAiB,MAC3D,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC/C,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAS,EAAE,EACvC,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,EAAE,EAC5D,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjC,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAwB,MAC9D,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAsD,OAChG,CAAC,EAAkB,EAAoB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAElE,aAAE,CAAW,SAAE,CAAO,cAAE,CAAY,CAAE,CAAG,CAAA,EAAA,EAAA,gBAAgB,AAAhB,EAAiB,GAI1D,EAAiB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,UACjC,GAAkB,GAClB,GAAI,CACF,IAAM,EAAM,MAAM,MAAM,mBAClB,EAAO,MAAM,EAAI,IAAI,GAC3B,EAAgB,EAAK,OAAO,GAAI,EAClC,CAAE,MAAO,EAAO,CACd,GAAgB,EAClB,QAAU,CACR,GAAkB,EACpB,CACF,EAAG,EAAE,EAEL,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACO,iBAAiB,CAA5B,EACF,IACoB,mBAAmB,CAA9B,IACT,GAAkB,GAClB,GAAgB,GAEpB,EAAG,CAAC,EAAQ,EAAe,EAG3B,IAAM,EAAY,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,UAC5B,GAAI,CACF,GAAW,GACX,IAAM,EAAW,MAAM,MAAM,sBAC7B,GAAI,EAAS,EAAE,CAAE,CACf,IAAM,EAAO,MAAM,EAAS,IAAI,GAChC,EAAS,EAAK,KAAK,EAAI,EAAE,CAC3B,MACE,CADK,CACC,KAAK,CAAC,4BAA6B,SAE7C,CAAE,MAAO,EAAO,CACd,EAAM,KAAK,CAAC,4BAA6B,SAC3C,QAAU,CACR,GAAW,EACb,CACF,EAAG,CAAC,EAAM,EAGJ,EAAmB,CAAA,EAAA,EAAA,WAAW,AAAX,EAAY,UACnC,GAAI,CACF,IAAM,EAAW,MAAM,MAAM,4BAC7B,GAAI,EAAS,EAAE,CAAE,CACf,IAAM,EAAO,MAAM,EAAS,IAAI,GAChC,EAAgB,EAAK,KAAK,EAAI,EAAE,CAClC,MACE,CADK,CACC,KAAK,CAAC,qDAAsD,SAEtE,CAAE,MAAO,EAAO,CACd,EAAM,KAAK,CAAC,oDAAqD,SACnE,CACF,EAAG,CAAC,EAAM,EAGJ,EAAoB,MAAO,IAC/B,EAAoB,GACpB,GAAI,CACF,IAAM,EAAW,MAAM,MAAM,2BAA4B,CACvD,OAAQ,QACR,QAAS,CAAE,eAAgB,kBAAmB,EAC9C,KAAM,KAAK,SAAS,CAAC,CAAE,UAAW,CAAO,EAC3C,GAEA,GAAI,EAAS,EAAE,CACb,CADe,CACT,OAAO,CAAC,6BAA8B,SAC5C,QACK,CACL,IAAM,EAAO,KAFO,CAED,EAAS,IAAI,GAChC,EAAM,KAAK,CAAC,EAAK,GAH0B,EAGrB,EAAI,yCAA0C,SACtE,CACF,CAAE,MAAO,EAAO,CACd,EAAM,KAAK,CAAC,wCAAyC,SACvD,QAAU,CACR,EAAoB,KACtB,CACF,EAuBA,GArBA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACJ,IACF,IACA,IAGJ,EALoB,AAKjB,CAAC,EAAc,EAAW,EAAiB,EAG9C,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACO,mBAAmB,CAA9B,GACF,EAAO,IAAI,CAAC,yBAEhB,EAAG,CAAC,EAAQ,EAAO,EAGnB,CAAA,EAAA,EAAA,SAAS,AAAT,EAAU,KACR,EAAQ,EACV,EAAG,CAAC,EAAa,EAGF,CAHK,WAGhB,GAAyC,OAAjB,GAAyB,EACnD,MAAO,CAAA,EAAA,EAAA,GAAA,AAD4D,AAC5D,EAAC,EAAA,MAJ4D,aAIzC,CAAA,CAAA,GAI7B,GAAI,CAAC,EAEH,OADA,EAAO,GADU,CACN,CAAC,KACL,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,mBAAmB,CAAA,CAAA,GA8B7B,IAAI,EAAiC,QAAjB,EAChB,EACA,EAAM,MAAM,CAAC,GAAQ,EAAK,MAAM,GAAK,GAEnC,EAAe,EAAM,MAAM,CAAC,GAAkB,YAAb,EAAE,MAAM,EAAgB,MAAM,CAC/D,EAAc,EAAM,MAAM,CAAC,GAAK,AAAa,aAAX,MAAM,EAAe,MAAM,CAC7D,EAAe,EAAa,MAAM,CAGlC,EAAiB,KAAK,IAAI,CAAC,EAAc,MAAM,GAAG,CAClD,EAAiB,EAAc,KAAK,CACxC,CAAC,GAAc,CAAC,GAChB,CADoB,IAKhB,EAAoB,KAAK,EAJf,EAImB,CAAC,EAAa,MAAM,GAAG,CACpD,GAAwB,EAAa,KAAK,CAC9C,CAAC,GAAc,CAAC,GA9JK,CA8JD,CACpB,GAGF,MACE,CAAA,EAAA,EAJc,AAId,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gDAEb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iFACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yIACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,cAAc,CAAA,CAAC,UAAU,uCAE5B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,uDAA8C,qBAC5D,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,4CAAmC,iCAGpD,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,UACR,QAAS,IAAM,EAAO,IAAI,CAAC,UAC3B,UAAU,4FAEV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,YACrB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,4BAAmB,yBACnC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,qBAAY,gBAKhC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iCACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAS,AAAiB,UAAQ,UAAY,UAC9C,QAAS,IAAM,EAAgB,OAC/B,UAA4B,QAAjB,EAAyB,sEAAwE,4CAC7G,QACO,EAAM,MAAM,CAAC,OAErB,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAA0B,YAAjB,EAA6B,UAAY,UAClD,QAAS,IAAM,EAAgB,WAC/B,UAAW,AAAiB,cAAY,sEAAwE,4CACjH,YACW,EAAa,OAEzB,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAA0B,WAAjB,EAA4B,UAAY,UACjD,QAAS,IAAM,EAAgB,UAC/B,UAA4B,WAAjB,EAA4B,sEAAwE,4CAChH,aACY,EAAY,OAEzB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAA0B,WAAjB,EAA4B,UAAY,UACjD,QAAS,IAAM,EAAgB,UAC/B,UAA4B,WAAjB,EAA4B,sEAAwE,2CAChH,aAGD,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAA0B,YAAjB,EAA6B,UAAY,UAClD,QAAS,IAAM,EAAgB,WAC/B,UAA4B,YAAjB,EAA6B,kEAAoE,wEAC7G,oBACmB,EAAa,aAMpC,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gEACZ,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAE,CAAC,GAAG,CAAC,AAAC,GACvB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAY,UAAU,yEACrB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uCACf,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oCAFP,MAMK,YAAjB,AACF,EACwB,IAAxB,EAAa,MAAM,CACjB,CAAA,EAAA,EAAA,EAFoB,EAEpB,EAAC,MAAA,CAAI,UAAU,wEACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,aAAa,CAAA,CAAC,UAAU,yCACzB,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,oDAA2C,sCAGzD,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yBAAgB,mDAK/B,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gEACZ,GAAsB,GAAG,CAAC,AAAC,GAC5B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAEC,UAAU,mFAGV,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACZ,EAAK,UAAU,CACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,IAAK,EAAK,UAAU,CACpB,IAAK,EAAK,IAAI,CACd,UAAU,kDAGZ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yHACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,yBAGpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,uCAA+B,EAAK,IAAI,GACtD,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,iCAAyB,EAAK,KAAK,WAMtD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iBACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,YAAY,UAAU,wDACnC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,GAAG,CAAA,CAAC,UAAU,iBAAiB,kBAGjC,EAAK,KAAK,EACT,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,sCAA8B,EAAK,KAAK,MAKzD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4EACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4DACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,gBACjB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAM,IAAI,KAAK,EAAK,iBAAiB,EAAE,kBAAkB,CAAC,cAE7D,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAS,IAAM,EAAkB,EAAK,EAAE,EACxC,SAAU,IAAqB,EAAK,EAAE,CACtC,UAAU,oHAET,IAAqB,EAAK,EAAE,CAC3B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,6BAEnB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAM,UAAU,gBACjB,yBAlDD,EAAK,EAAE,KA2DjB,EAAoB,GACnB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CACT,YAAa,EACb,WAAY,EACZ,aAAc,EACd,UAAU,YAOS,EADzB,EACA,EAAc,MAAM,CAClB,CAAA,CAFW,CAEX,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wEACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,aAAa,CAAA,CAAC,UAAU,yCACzB,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAG,UAAU,qDACM,QAAjB,GAA0B,YACT,YAAjB,GAA8B,sBACb,WAAjB,GAA6B,qBACZ,WAAjB,GAA6B,wBAEhC,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,0BACO,YAAjB,GAA8B,iDACb,WAAjB,GAA6B,qCACZ,WAAjB,GAA6B,qBACZ,QAAjB,GAA0B,mDAI/B,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gEACZ,EAAe,GAAG,CAAC,AAAC,GACrB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAEC,UAAW,CAAC,+DAA+D,EACzE,EAAK,mBAAmB,CACpB,4DACA,4DAAA,CACJ,CACF,QAAS,IAAM,EAAkB,EAAK,EAAE,YAGxC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACZ,EAAK,OAAO,CAAC,UAAU,CACtB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,IAAK,EAAK,OAAO,CAAC,UAAU,CAC5B,IAAK,EAAK,OAAO,CAAC,IAAI,CACtB,UAAU,kDAGZ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,2HACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,yBAGpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,uCAA+B,EAAK,OAAO,CAAC,IAAI,GAC9D,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,iCAAyB,EAAK,OAAO,CAAC,KAAK,SAG3D,EAAK,mBAAmB,EACvB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yDAKnB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACZ,CA5QK,AAAD,IACrB,OAAQ,GACN,IAAK,UACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,UAAU,UAAU,uDAA8C,WAC1F,KAAK,SACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,UAAU,UAAU,gEAAuD,YACnG,KAAK,SACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,YAAY,UAAU,qCAA4B,UAC1E,SACE,OAAO,IACX,EACF,EAiQkC,EAAK,MAAM,EAC1B,EAAK,QAAQ,EACZ,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,kCAAwB,aAC3B,EAAK,QAAQ,CAAC,IAAI,OAMlC,EAAK,QAAQ,CAAC,MAAM,CAAG,GACtB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gBACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,8CACV,EAAK,QAAQ,CAAC,EAAE,CAAC,OAAO,KAM/B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kGACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,gBACjB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAM,EAAK,eAAe,CAAG,CApR/B,AAAC,IAClB,IAAM,EAAM,IAAI,KACV,EAAc,IAAI,KAAK,GACvB,EAAgB,KAAK,KAAK,CAAC,CAAC,EAAI,OAAO,GAAK,EAAY,OAAO,EAAA,CAAE,CAAI,KAE3E,GAAI,EAAgB,EAAG,MAAO,aAC9B,GAAI,EAAgB,GAAI,MAAO,CAAA,EAAG,EAAc,UAAU,CAAC,CAC3D,IAAM,EAAc,KAAK,KAAK,CAAC,EAAgB,IAC/C,GAAI,EAAc,GAAI,MAAO,CAAA,EAAG,EAAY,QAAQ,CAAC,CACrD,IAAM,EAAa,KAAK,KAAK,CAAC,EAAc,IAC5C,MAAO,CAAA,EAAG,EAAW,QAAQ,CAAC,AAChC,GAyQ6D,EAAK,eAAe,EAAI,qBAElE,EAAK,mBAAmB,CACvB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,wCAA+B,UAE/C,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,UAAU,+BA5DrB,EAAK,EAAE,KAoEjB,EAAiB,GAChB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CACT,YAAa,EACb,WAAY,EACZ,aAAc,EACd,UAAU,eASnB,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CACC,OAAQ,EACR,QAAS,KACP,EAAkB,MAClB,IACA,GACF,MAFe,AAOzB,WANgC,uBA3fT,UA0f8C,aACS","ignoreList":[3]}