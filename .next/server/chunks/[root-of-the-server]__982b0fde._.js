module.exports=[64348,(e,t,r)=>{t.exports=function(e){return e&&e.__esModule?e:{default:e}},t.exports.__esModule=!0,t.exports.default=t.exports},874,(e,t,r)=>{t.exports=e.x("buffer",()=>require("buffer"))},39684,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=e.r(54799);r.default=(e,t)=>(0,a.createHash)(e).update(t).digest()},979,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.concatKdf=r.lengthAndInput=r.uint32be=r.uint64be=r.p2s=r.concat=r.decoder=r.encoder=void 0;let a=e.r(39684);function n(...e){let t=new Uint8Array(e.reduce((e,{length:t})=>e+t,0)),r=0;return e.forEach(e=>{t.set(e,r),r+=e.length}),t}function i(e,t,r){if(t<0||t>=0x100000000)throw RangeError(`value must be >= 0 and <= ${0x100000000-1}. Received ${t}`);e.set([t>>>24,t>>>16,t>>>8,255&t],r)}function o(e){let t=new Uint8Array(4);return i(t,e),t}r.encoder=new TextEncoder,r.decoder=new TextDecoder,r.concat=n,r.p2s=function(e,t){return n(r.encoder.encode(e),new Uint8Array([0]),t)},r.uint64be=function(e){let t=Math.floor(e/0x100000000),r=new Uint8Array(8);return i(r,t,0),i(r,e%0x100000000,4),r},r.uint32be=o,r.lengthAndInput=function(e){return n(o(e.length),e)},r.concatKdf=async function(e,t,r){let n=Math.ceil((t>>3)/32),i=new Uint8Array(32*n);for(let t=0;t<n;t++){let n=new Uint8Array(4+e.length+r.length);n.set(o(t+1)),n.set(e,4),n.set(r,4+e.length),i.set(await (0,a.default)("sha256",n),32*t)}return i.slice(0,t>>3)}},14882,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decode=r.encode=r.encodeBase64=r.decodeBase64=void 0;let a=e.r(874),n=e.r(979);a.Buffer.isEncoding("base64url")?r.encode=e=>a.Buffer.from(e).toString("base64url"):r.encode=e=>a.Buffer.from(e).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),r.decodeBase64=e=>a.Buffer.from(e,"base64"),r.encodeBase64=e=>a.Buffer.from(e).toString("base64"),r.decode=e=>{let t;return a.Buffer.from(((t=e)instanceof Uint8Array&&(t=n.decoder.decode(t)),t),"base64")}},86325,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.JWSSignatureVerificationFailed=r.JWKSTimeout=r.JWKSMultipleMatchingKeys=r.JWKSNoMatchingKey=r.JWKSInvalid=r.JWKInvalid=r.JWTInvalid=r.JWSInvalid=r.JWEInvalid=r.JWEDecompressionFailed=r.JWEDecryptionFailed=r.JOSENotSupported=r.JOSEAlgNotAllowed=r.JWTExpired=r.JWTClaimValidationFailed=r.JOSEError=void 0;class a extends Error{static get code(){return"ERR_JOSE_GENERIC"}constructor(e){var t;super(e),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,null==(t=Error.captureStackTrace)||t.call(Error,this,this.constructor)}}r.JOSEError=a,r.JWTClaimValidationFailed=class extends a{static get code(){return"ERR_JWT_CLAIM_VALIDATION_FAILED"}constructor(e,t="unspecified",r="unspecified"){super(e),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=t,this.reason=r}},r.JWTExpired=class extends a{static get code(){return"ERR_JWT_EXPIRED"}constructor(e,t="unspecified",r="unspecified"){super(e),this.code="ERR_JWT_EXPIRED",this.claim=t,this.reason=r}},r.JOSEAlgNotAllowed=class extends a{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}static get code(){return"ERR_JOSE_ALG_NOT_ALLOWED"}},r.JOSENotSupported=class extends a{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}static get code(){return"ERR_JOSE_NOT_SUPPORTED"}},r.JWEDecryptionFailed=class extends a{constructor(){super(...arguments),this.code="ERR_JWE_DECRYPTION_FAILED",this.message="decryption operation failed"}static get code(){return"ERR_JWE_DECRYPTION_FAILED"}},r.JWEDecompressionFailed=class extends a{constructor(){super(...arguments),this.code="ERR_JWE_DECOMPRESSION_FAILED",this.message="decompression operation failed"}static get code(){return"ERR_JWE_DECOMPRESSION_FAILED"}},r.JWEInvalid=class extends a{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}static get code(){return"ERR_JWE_INVALID"}},r.JWSInvalid=class extends a{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}static get code(){return"ERR_JWS_INVALID"}},r.JWTInvalid=class extends a{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}static get code(){return"ERR_JWT_INVALID"}},r.JWKInvalid=class extends a{constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}static get code(){return"ERR_JWK_INVALID"}},r.JWKSInvalid=class extends a{constructor(){super(...arguments),this.code="ERR_JWKS_INVALID"}static get code(){return"ERR_JWKS_INVALID"}},r.JWKSNoMatchingKey=class extends a{constructor(){super(...arguments),this.code="ERR_JWKS_NO_MATCHING_KEY",this.message="no applicable key found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_NO_MATCHING_KEY"}},r.JWKSMultipleMatchingKeys=class extends a{constructor(){super(...arguments),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS",this.message="multiple matching keys found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_MULTIPLE_MATCHING_KEYS"}},r.JWKSTimeout=class extends a{constructor(){super(...arguments),this.code="ERR_JWKS_TIMEOUT",this.message="request timed out"}static get code(){return"ERR_JWKS_TIMEOUT"}},r.JWSSignatureVerificationFailed=class extends a{constructor(){super(...arguments),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED",this.message="signature verification failed"}static get code(){return"ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}}},69874,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=e.r(54799);Object.defineProperty(r,"default",{enumerable:!0,get:function(){return a.randomFillSync}})},3049,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.bitLength=void 0;let a=e.r(86325),n=e.r(69874);function i(e){switch(e){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new a.JOSENotSupported(`Unsupported JWE Algorithm: ${e}`)}}r.bitLength=i,r.default=e=>(0,n.default)(new Uint8Array(i(e)>>3))},96442,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=e.r(86325),n=e.r(3049);r.default=(e,t)=>{if(t.length<<3!==(0,n.bitLength)(e))throw new a.JWEInvalid("Invalid Initialization Vector length")}},55548,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=e.r(54799),n=e.r(24361);r.default=n.types.isKeyObject?e=>n.types.isKeyObject(e):e=>null!=e&&e instanceof a.KeyObject},60120,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=e.r(86325),n=e.r(55548);r.default=(e,t)=>{let r;switch(e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":r=parseInt(e.slice(-3),10);break;case"A128GCM":case"A192GCM":case"A256GCM":r=parseInt(e.slice(1,4),10);break;default:throw new a.JOSENotSupported(`Content Encryption Algorithm ${e} is not supported either by JOSE or your javascript runtime`)}if(t instanceof Uint8Array){let e=t.byteLength<<3;if(e!==r)throw new a.JWEInvalid(`Invalid Content Encryption Key length. Expected ${r} bits, got ${e} bits`);return}if((0,n.default)(t)&&"secret"===t.type){let e=t.symmetricKeySize<<3;if(e!==r)throw new a.JWEInvalid(`Invalid Content Encryption Key length. Expected ${r} bits, got ${e} bits`);return}throw TypeError("Invalid Content Encryption Key type")}},37404,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=e.r(54799).timingSafeEqual},86369,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=e.r(54799),n=e.r(979);r.default=function(e,t,r,i,o,s){let c=(0,n.concat)(e,t,r,(0,n.uint64be)(e.length<<3)),d=(0,a.createHmac)(`sha${i}`,o);return d.update(c),d.digest().slice(0,s>>3)}},9412,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isCryptoKey=void 0;let a=e.r(54799),n=e.r(24361);r.default=a.webcrypto,r.isCryptoKey=n.types.isCryptoKey?e=>n.types.isCryptoKey(e):e=>!1},77109,(e,t,r)=>{"use strict";function a(e,t="algorithm.name"){return TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function n(e,t){return e.name===t}function i(e){return parseInt(e.name.slice(4),10)}function o(e,t){if(t.length&&!t.some(t=>e.usages.includes(t))){let e="CryptoKey does not support this operation, its usages must include ";if(t.length>2){let r=t.pop();e+=`one of ${t.join(", ")}, or ${r}.`}else 2===t.length?e+=`one of ${t[0]} or ${t[1]}.`:e+=`${t[0]}.`;throw TypeError(e)}}Object.defineProperty(r,"__esModule",{value:!0}),r.checkEncCryptoKey=r.checkSigCryptoKey=void 0,r.checkSigCryptoKey=function(e,t,...r){switch(t){case"HS256":case"HS384":case"HS512":{if(!n(e.algorithm,"HMAC"))throw a("HMAC");let r=parseInt(t.slice(2),10);if(i(e.algorithm.hash)!==r)throw a(`SHA-${r}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!n(e.algorithm,"RSASSA-PKCS1-v1_5"))throw a("RSASSA-PKCS1-v1_5");let r=parseInt(t.slice(2),10);if(i(e.algorithm.hash)!==r)throw a(`SHA-${r}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!n(e.algorithm,"RSA-PSS"))throw a("RSA-PSS");let r=parseInt(t.slice(2),10);if(i(e.algorithm.hash)!==r)throw a(`SHA-${r}`,"algorithm.hash");break}case"EdDSA":if("Ed25519"!==e.algorithm.name&&"Ed448"!==e.algorithm.name)throw a("Ed25519 or Ed448");break;case"ES256":case"ES384":case"ES512":{if(!n(e.algorithm,"ECDSA"))throw a("ECDSA");let r=function(e){switch(e){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw Error("unreachable")}}(t);if(e.algorithm.namedCurve!==r)throw a(r,"algorithm.namedCurve");break}default:throw TypeError("CryptoKey does not support this operation")}o(e,r)},r.checkEncCryptoKey=function(e,t,...r){switch(t){case"A128GCM":case"A192GCM":case"A256GCM":{if(!n(e.algorithm,"AES-GCM"))throw a("AES-GCM");let r=parseInt(t.slice(1,4),10);if(e.algorithm.length!==r)throw a(r,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!n(e.algorithm,"AES-KW"))throw a("AES-KW");let r=parseInt(t.slice(1,4),10);if(e.algorithm.length!==r)throw a(r,"algorithm.length");break}case"ECDH":switch(e.algorithm.name){case"ECDH":case"X25519":case"X448":break;default:throw a("ECDH, X25519, or X448")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!n(e.algorithm,"PBKDF2"))throw a("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!n(e.algorithm,"RSA-OAEP"))throw a("RSA-OAEP");let r=parseInt(t.slice(9),10)||1;if(i(e.algorithm.hash)!==r)throw a(`SHA-${r}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}o(e,r)}},26859,(e,t,r)=>{"use strict";function a(e,t,...r){if(r.length>2){let t=r.pop();e+=`one of type ${r.join(", ")}, or ${t}.`}else 2===r.length?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return null==t?e+=` Received ${t}`:"function"==typeof t&&t.name?e+=` Received function ${t.name}`:"object"==typeof t&&null!=t&&t.constructor&&t.constructor.name&&(e+=` Received an instance of ${t.constructor.name}`),e}Object.defineProperty(r,"__esModule",{value:!0}),r.withAlg=void 0,r.default=(e,...t)=>a("Key must be ",e,...t),r.withAlg=function(e,t,...r){return a(`Key for the ${e} algorithm must be `,t,...r)}},4111,(e,t,r)=>{"use strict";let a;Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(54799);r.default=e=>(a||(a=new Set((0,n.getCiphers)())),a.has(e))},65893,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.types=void 0;let a=e.r(9412),n=e.r(55548);r.default=e=>(0,n.default)(e)||(0,a.isCryptoKey)(e);let i=["KeyObject"];r.types=i,(globalThis.CryptoKey||(null===a.default||void 0===a.default?void 0:a.default.CryptoKey))&&i.push("CryptoKey")},97899,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=e.r(54799),n=e.r(96442),i=e.r(60120),o=e.r(979),s=e.r(86325),c=e.r(37404),d=e.r(86369),l=e.r(9412),u=e.r(77109),p=e.r(55548),f=e.r(26859),y=e.r(4111),h=e.r(65893);r.default=(e,t,r,m,w,g)=>{let v;if((0,l.isCryptoKey)(t))(0,u.checkEncCryptoKey)(t,e,"decrypt"),v=a.KeyObject.from(t);else if(t instanceof Uint8Array||(0,p.default)(t))v=t;else throw TypeError((0,f.default)(t,...h.types,"Uint8Array"));switch((0,i.default)(e,v),(0,n.default)(e,m),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return function(e,t,r,n,i,l){let u,f,h=parseInt(e.slice(1,4),10);(0,p.default)(t)&&(t=t.export());let m=t.subarray(h>>3),w=t.subarray(0,h>>3),g=parseInt(e.slice(-3),10),v=`aes-${h}-cbc`;if(!(0,y.default)(v))throw new s.JOSENotSupported(`alg ${e} is not supported by your javascript runtime`);let E=(0,d.default)(l,n,r,g,w,h);try{u=(0,c.default)(i,E)}catch{}if(!u)throw new s.JWEDecryptionFailed;try{let e=(0,a.createDecipheriv)(v,m,n);f=(0,o.concat)(e.update(r),e.final())}catch{}if(!f)throw new s.JWEDecryptionFailed;return f}(e,v,r,m,w,g);case"A128GCM":case"A192GCM":case"A256GCM":var E=v;let S=parseInt(e.slice(1,4),10),b=`aes-${S}-gcm`;if(!(0,y.default)(b))throw new s.JOSENotSupported(`alg ${e} is not supported by your javascript runtime`);try{let e=(0,a.createDecipheriv)(b,E,m,{authTagLength:16});e.setAuthTag(w),g.byteLength&&e.setAAD(g,{plaintextLength:r.length});let t=e.update(r);return e.final(),t}catch{throw new s.JWEDecryptionFailed}default:throw new s.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}}},6461,(e,t,r)=>{t.exports=e.x("zlib",()=>require("zlib"))},96825,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.deflate=r.inflate=void 0;let a=e.r(24361),n=e.r(6461),i=e.r(86325),o=(0,a.promisify)(n.inflateRaw),s=(0,a.promisify)(n.deflateRaw);r.inflate=e=>o(e,{maxOutputLength:25e4}).catch(()=>{throw new i.JWEDecompressionFailed}),r.deflate=e=>s(e)},78410,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=(...e)=>{let t,r=e.filter(Boolean);if(0===r.length||1===r.length)return!0;for(let e of r){let r=Object.keys(e);if(!t||0===t.size){t=new Set(r);continue}for(let e of r){if(t.has(e))return!1;t.add(e)}}return!0}},80275,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){if("object"!=typeof e||null===e||"[object Object]"!==Object.prototype.toString.call(e))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}},66389,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.unwrap=r.wrap=void 0;let a=e.r(874),n=e.r(54799),i=e.r(86325),o=e.r(979),s=e.r(9412),c=e.r(77109),d=e.r(55548),l=e.r(26859),u=e.r(4111),p=e.r(65893);function f(e,t){if(e.symmetricKeySize<<3!==parseInt(t.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${t}`)}function y(e,t,r){if((0,d.default)(e))return e;if(e instanceof Uint8Array)return(0,n.createSecretKey)(e);if((0,s.isCryptoKey)(e))return(0,c.checkEncCryptoKey)(e,t,r),n.KeyObject.from(e);throw TypeError((0,l.default)(e,...p.types,"Uint8Array"))}r.wrap=(e,t,r)=>{let s=parseInt(e.slice(1,4),10),c=`aes${s}-wrap`;if(!(0,u.default)(c))throw new i.JOSENotSupported(`alg ${e} is not supported either by JOSE or your javascript runtime`);let d=y(t,e,"wrapKey");f(d,e);let l=(0,n.createCipheriv)(c,d,a.Buffer.alloc(8,166));return(0,o.concat)(l.update(r),l.final())},r.unwrap=(e,t,r)=>{let s=parseInt(e.slice(1,4),10),c=`aes${s}-wrap`;if(!(0,u.default)(c))throw new i.JOSENotSupported(`alg ${e} is not supported either by JOSE or your javascript runtime`);let d=y(t,e,"unwrapKey");f(d,e);let l=(0,n.createDecipheriv)(c,d,a.Buffer.alloc(8,166));return(0,o.concat)(l.update(r),l.final())}},7586,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.setCurve=r.weakMap=void 0;let a=e.r(874),n=e.r(54799),i=e.r(86325),o=e.r(9412),s=e.r(55548),c=e.r(26859),d=e.r(65893),l=a.Buffer.from([42,134,72,206,61,3,1,7]),u=a.Buffer.from([43,129,4,0,34]),p=a.Buffer.from([43,129,4,0,35]),f=a.Buffer.from([43,129,4,0,10]);r.weakMap=new WeakMap;let y=(e,t)=>{var a;let h;if((0,o.isCryptoKey)(e))h=n.KeyObject.from(e);else if((0,s.default)(e))h=e;else throw TypeError((0,c.default)(e,...d.types));if("secret"===h.type)throw TypeError('only "private" or "public" type keys can be used for this operation');switch(h.asymmetricKeyType){case"ed25519":case"ed448":return`Ed${h.asymmetricKeyType.slice(2)}`;case"x25519":case"x448":return`X${h.asymmetricKeyType.slice(1)}`;case"ec":{if(r.weakMap.has(h))return r.weakMap.get(h);let e=null==(a=h.asymmetricKeyDetails)?void 0:a.namedCurve;if(e||"private"!==h.type){if(!e){let t=h.export({format:"der",type:"spki"}),r=t[1]<128?14:15,a=t[r],n=t.slice(r+1,r+1+a);if(n.equals(l))e="prime256v1";else if(n.equals(u))e="secp384r1";else if(n.equals(p))e="secp521r1";else if(n.equals(f))e="secp256k1";else throw new i.JOSENotSupported("Unsupported key curve for this operation")}}else e=y((0,n.createPublicKey)(h),!0);if(t)return e;let o=(e=>{switch(e){case"prime256v1":return"P-256";case"secp384r1":return"P-384";case"secp521r1":return"P-521";case"secp256k1":return"secp256k1";default:throw new i.JOSENotSupported("Unsupported key curve for this operation")}})(e);return r.weakMap.set(h,o),o}default:throw TypeError("Invalid asymmetric key type for this operation")}};r.setCurve=function(e,t){r.weakMap.set(e,t)},r.default=y},89026,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ecdhAllowed=r.generateEpk=r.deriveKey=void 0;let a=e.r(54799),n=e.r(24361),i=e.r(7586),o=e.r(979),s=e.r(86325),c=e.r(9412),d=e.r(77109),l=e.r(55548),u=e.r(26859),p=e.r(65893),f=(0,n.promisify)(a.generateKeyPair);r.deriveKey=async function(e,t,r,n,i=new Uint8Array(0),s=new Uint8Array(0)){let f,y;if((0,c.isCryptoKey)(e))(0,d.checkEncCryptoKey)(e,"ECDH"),f=a.KeyObject.from(e);else if((0,l.default)(e))f=e;else throw TypeError((0,u.default)(e,...p.types));if((0,c.isCryptoKey)(t))(0,d.checkEncCryptoKey)(t,"ECDH","deriveBits"),y=a.KeyObject.from(t);else if((0,l.default)(t))y=t;else throw TypeError((0,u.default)(t,...p.types));let h=(0,o.concat)((0,o.lengthAndInput)(o.encoder.encode(r)),(0,o.lengthAndInput)(i),(0,o.lengthAndInput)(s),(0,o.uint32be)(n)),m=(0,a.diffieHellman)({privateKey:y,publicKey:f});return(0,o.concatKdf)(m,n,h)},r.generateEpk=async function(e){let t;if((0,c.isCryptoKey)(e))t=a.KeyObject.from(e);else if((0,l.default)(e))t=e;else throw TypeError((0,u.default)(e,...p.types));switch(t.asymmetricKeyType){case"x25519":return f("x25519");case"x448":return f("x448");case"ec":return f("ec",{namedCurve:(0,i.default)(t)});default:throw new s.JOSENotSupported("Invalid or unsupported EPK")}},r.ecdhAllowed=e=>["P-256","P-384","P-521","X25519","X448"].includes((0,i.default)(e))},98393,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=e.r(86325);r.default=function(e){if(!(e instanceof Uint8Array)||e.length<8)throw new a.JWEInvalid("PBES2 Salt Input must be 8 or more octets")}},89925,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decrypt=r.encrypt=void 0;let a=e.r(24361),n=e.r(54799),i=e.r(69874),o=e.r(979),s=e.r(14882),c=e.r(66389),d=e.r(98393),l=e.r(9412),u=e.r(77109),p=e.r(55548),f=e.r(26859),y=e.r(65893),h=(0,a.promisify)(n.pbkdf2);function m(e,t){if((0,p.default)(e))return e.export();if(e instanceof Uint8Array)return e;if((0,l.isCryptoKey)(e))return(0,u.checkEncCryptoKey)(e,t,"deriveBits","deriveKey"),n.KeyObject.from(e).export();throw TypeError((0,f.default)(e,...y.types,"Uint8Array"))}r.encrypt=async(e,t,r,a=2048,n=(0,i.default)(new Uint8Array(16)))=>{(0,d.default)(n);let l=(0,o.p2s)(e,n),u=parseInt(e.slice(13,16),10)>>3,p=m(t,e),f=await h(p,l,a,u,`sha${e.slice(8,11)}`);return{encryptedKey:await (0,c.wrap)(e.slice(-6),f,r),p2c:a,p2s:(0,s.encode)(n)}},r.decrypt=async(e,t,r,a,n)=>{(0,d.default)(n);let i=(0,o.p2s)(e,n),s=parseInt(e.slice(13,16),10)>>3,l=m(t,e),u=await h(l,i,a,s,`sha${e.slice(8,11)}`);return(0,c.unwrap)(e.slice(-6),u,r)}},64870,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.setModulusLength=r.weakMap=void 0,r.weakMap=new WeakMap;let a=(e,t)=>{let r=e.readUInt8(1);if((128&r)==0)return 0===t?r:a(e.subarray(2+r),t-1);let n=127&r;r=0;for(let t=0;t<n;t++)r<<=8,r|=e.readUInt8(2+t);return 0===t?r:a(e.subarray(2+r),t-1)};r.setModulusLength=(e,t)=>{r.weakMap.set(e,t)},r.default=(e,t)=>{if(2048>(e=>{var t,n,i,o;let s;if(r.weakMap.has(e))return r.weakMap.get(e);let c=null!=(n=null==(t=e.asymmetricKeyDetails)?void 0:t.modulusLength)?n:(i=e.export({format:"der",type:"pkcs1"}),o=+("private"===e.type),((128&(s=i.readUInt8(1)))==0?a(i.subarray(2),o):a(i.subarray(2+(127&s)),o))-1<<3);return r.weakMap.set(e,c),c})(e))throw TypeError(`${t} requires key modulusLength to be 2048 bits or larger`)}},3077,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decrypt=r.encrypt=void 0;let a=e.r(54799),n=e.r(64870),i=e.r(9412),o=e.r(77109),s=e.r(55548),c=e.r(26859),d=e.r(65893),l=(e,t)=>{if("rsa"!==e.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");(0,n.default)(e,t)},u=e=>{switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return a.constants.RSA_PKCS1_OAEP_PADDING;case"RSA1_5":return a.constants.RSA_PKCS1_PADDING;default:return}},p=e=>{switch(e){case"RSA-OAEP":return"sha1";case"RSA-OAEP-256":return"sha256";case"RSA-OAEP-384":return"sha384";case"RSA-OAEP-512":return"sha512";default:return}};function f(e,t,...r){if((0,s.default)(e))return e;if((0,i.isCryptoKey)(e))return(0,o.checkEncCryptoKey)(e,t,...r),a.KeyObject.from(e);throw TypeError((0,c.default)(e,...d.types))}r.encrypt=(e,t,r)=>{let n=u(e),i=p(e),o=f(t,e,"wrapKey","encrypt");return l(o,e),(0,a.publicEncrypt)({key:o,oaepHash:i,padding:n},r)},r.decrypt=(e,t,r)=>{let n=u(e),i=p(e),o=f(t,e,"unwrapKey","decrypt");return l(o,e),(0,a.privateDecrypt)({key:o,oaepHash:i,padding:n},r)}},30630,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.bitLength=void 0;let a=e.r(86325),n=e.r(69874);function i(e){switch(e){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new a.JOSENotSupported(`Unsupported JWE Algorithm: ${e}`)}}r.bitLength=i,r.default=e=>(0,n.default)(new Uint8Array(i(e)>>3))},14133,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fromX509=r.fromSPKI=r.fromPKCS8=r.toPKCS8=r.toSPKI=void 0;let a=e.r(54799),n=e.r(874),i=e.r(9412),o=e.r(55548),s=e.r(26859),c=e.r(65893),d=(e,t,r)=>{let n;if((0,i.isCryptoKey)(r)){if(!r.extractable)throw TypeError("CryptoKey is not extractable");n=a.KeyObject.from(r)}else if((0,o.default)(r))n=r;else throw TypeError((0,s.default)(r,...c.types));if(n.type!==e)throw TypeError(`key is not a ${e} key`);return n.export({format:"pem",type:t})};r.toSPKI=e=>d("public","spki",e),r.toPKCS8=e=>d("private","pkcs8",e),r.fromPKCS8=e=>(0,a.createPrivateKey)({key:n.Buffer.from(e.replace(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,""),"base64"),type:"pkcs8",format:"der"}),r.fromSPKI=e=>(0,a.createPublicKey)({key:n.Buffer.from(e.replace(/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g,""),"base64"),type:"spki",format:"der"}),r.fromX509=e=>(0,a.createPublicKey)({key:e,type:"spki",format:"pem"})},81879,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=e.r(874),n=e.r(86325),i=a.Buffer.from([0]),o=a.Buffer.from([2]),s=a.Buffer.from([3]),c=a.Buffer.from([48]),d=a.Buffer.from([4]),l=e=>{if(e<128)return a.Buffer.from([e]);let t=a.Buffer.alloc(5);t.writeUInt32BE(e,1);let r=1;for(;0===t[r];)r++;return t[r-1]=128|5-r,t.slice(r-1)},u=new Map([["P-256",a.Buffer.from("06 08 2A 86 48 CE 3D 03 01 07".replace(/ /g,""),"hex")],["secp256k1",a.Buffer.from("06 05 2B 81 04 00 0A".replace(/ /g,""),"hex")],["P-384",a.Buffer.from("06 05 2B 81 04 00 22".replace(/ /g,""),"hex")],["P-521",a.Buffer.from("06 05 2B 81 04 00 23".replace(/ /g,""),"hex")],["ecPublicKey",a.Buffer.from("06 07 2A 86 48 CE 3D 02 01".replace(/ /g,""),"hex")],["X25519",a.Buffer.from("06 03 2B 65 6E".replace(/ /g,""),"hex")],["X448",a.Buffer.from("06 03 2B 65 6F".replace(/ /g,""),"hex")],["Ed25519",a.Buffer.from("06 03 2B 65 70".replace(/ /g,""),"hex")],["Ed448",a.Buffer.from("06 03 2B 65 71".replace(/ /g,""),"hex")]]);r.default=class{constructor(){this.length=0,this.elements=[]}oidFor(e){let t=u.get(e);if(!t)throw new n.JOSENotSupported("Invalid or unsupported OID");this.elements.push(t),this.length+=t.length}zero(){this.elements.push(o,a.Buffer.from([1]),i),this.length+=3}one(){this.elements.push(o,a.Buffer.from([1]),a.Buffer.from([1])),this.length+=3}unsignedInteger(e){if(128&e[0]){let t=l(e.length+1);this.elements.push(o,t,i,e),this.length+=2+t.length+e.length}else{let t=0;for(;0===e[t]&&(128&e[t+1])==0;)t++;let r=l(e.length-t);this.elements.push(o,l(e.length-t),e.slice(t)),this.length+=1+r.length+e.length-t}}octStr(e){let t=l(e.length);this.elements.push(d,l(e.length),e),this.length+=1+t.length+e.length}bitStr(e){let t=l(e.length+1);this.elements.push(s,l(e.length+1),i,e),this.length+=1+t.length+e.length+1}add(e){this.elements.push(e),this.length+=e.length}end(e=c){let t=l(this.length);return a.Buffer.concat([e,t,...this.elements],1+t.length+this.length)}}},37584,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.jwkImport=r.jwkExport=r.rsaPssParams=r.oneShotCallback=void 0;let[a,n]=process.versions.node.split(".").map(e=>parseInt(e,10));r.oneShotCallback=a>=16||15===a&&n>=13,r.rsaPssParams=!("electron"in process.versions)&&(a>=17||16===a&&n>=9),r.jwkExport=a>=16||15===a&&n>=9,r.jwkImport=a>=16||15===a&&n>=12},75420,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=e.r(874),n=e.r(54799),i=e.r(14882),o=e.r(86325),s=e.r(7586),c=e.r(64870),d=e.r(81879),l=e.r(37584);r.default=e=>{if(l.jwkImport&&"oct"!==e.kty)return e.d?(0,n.createPrivateKey)({format:"jwk",key:e}):(0,n.createPublicKey)({format:"jwk",key:e});switch(e.kty){case"oct":return(0,n.createSecretKey)((0,i.decode)(e.k));case"RSA":{let t=new d.default,r=void 0!==e.d,i=a.Buffer.from(e.n,"base64"),o=a.Buffer.from(e.e,"base64");r?(t.zero(),t.unsignedInteger(i),t.unsignedInteger(o),t.unsignedInteger(a.Buffer.from(e.d,"base64")),t.unsignedInteger(a.Buffer.from(e.p,"base64")),t.unsignedInteger(a.Buffer.from(e.q,"base64")),t.unsignedInteger(a.Buffer.from(e.dp,"base64")),t.unsignedInteger(a.Buffer.from(e.dq,"base64")),t.unsignedInteger(a.Buffer.from(e.qi,"base64"))):(t.unsignedInteger(i),t.unsignedInteger(o));let s={key:t.end(),format:"der",type:"pkcs1"},l=r?(0,n.createPrivateKey)(s):(0,n.createPublicKey)(s);return(0,c.setModulusLength)(l,i.length<<3),l}case"EC":{let t=new d.default,r=void 0!==e.d,i=a.Buffer.concat([a.Buffer.alloc(1,4),a.Buffer.from(e.x,"base64"),a.Buffer.from(e.y,"base64")]);if(r){t.zero();let r=new d.default;r.oidFor("ecPublicKey"),r.oidFor(e.crv),t.add(r.end());let o=new d.default;o.one(),o.octStr(a.Buffer.from(e.d,"base64"));let c=new d.default;c.bitStr(i);let l=c.end(a.Buffer.from([161]));o.add(l);let u=o.end(),p=new d.default;p.add(u);let f=p.end(a.Buffer.from([4]));t.add(f);let y=t.end(),h=(0,n.createPrivateKey)({key:y,format:"der",type:"pkcs8"});return(0,s.setCurve)(h,e.crv),h}let o=new d.default;o.oidFor("ecPublicKey"),o.oidFor(e.crv),t.add(o.end()),t.bitStr(i);let c=t.end(),l=(0,n.createPublicKey)({key:c,format:"der",type:"spki"});return(0,s.setCurve)(l,e.crv),l}case"OKP":{let t=new d.default;if(void 0!==e.d){t.zero();let r=new d.default;r.oidFor(e.crv),t.add(r.end());let i=new d.default;i.octStr(a.Buffer.from(e.d,"base64"));let o=i.end(a.Buffer.from([4]));t.add(o);let s=t.end();return(0,n.createPrivateKey)({key:s,format:"der",type:"pkcs8"})}let r=new d.default;r.oidFor(e.crv),t.add(r.end()),t.bitStr(a.Buffer.from(e.x,"base64"));let i=t.end();return(0,n.createPublicKey)({key:i,format:"der",type:"spki"})}default:throw new o.JOSENotSupported('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}}},9132,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.importJWK=r.importPKCS8=r.importX509=r.importSPKI=void 0;let a=e.r(14882),n=e.r(14133),i=e.r(75420),o=e.r(86325),s=e.r(80275);r.importSPKI=async function(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN PUBLIC KEY-----"))throw TypeError('"spki" must be SPKI formatted string');return(0,n.fromSPKI)(e,t,r)},r.importX509=async function(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN CERTIFICATE-----"))throw TypeError('"x509" must be X.509 formatted string');return(0,n.fromX509)(e,t,r)},r.importPKCS8=async function(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN PRIVATE KEY-----"))throw TypeError('"pkcs8" must be PKCS#8 formatted string');return(0,n.fromPKCS8)(e,t,r)},r.importJWK=async function(e,t,r){var n;if(!(0,s.default)(e))throw TypeError("JWK must be an object");switch(t||(t=e.alg),e.kty){case"oct":if("string"!=typeof e.k||!e.k)throw TypeError('missing "k" (Key Value) Parameter value');if(null!=r||(r=!0!==e.ext),r)return(0,i.default)({...e,alg:t,ext:null!=(n=e.ext)&&n});return(0,a.decode)(e.k);case"RSA":if(void 0!==e.oth)throw new o.JOSENotSupported('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return(0,i.default)({...e,alg:t});default:throw new o.JOSENotSupported('Unsupported "kty" (Key Type) Parameter value')}}},89875,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=e.r(26859),n=e.r(65893);r.default=(e,t,r)=>{if(e.startsWith("HS")||"dir"===e||e.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(e)){if(!(t instanceof Uint8Array)){if(!(0,n.default)(t))throw TypeError((0,a.withAlg)(e,t,...n.types,"Uint8Array"));if("secret"!==t.type)throw TypeError(`${n.types.join(" or ")} instances for symmetric algorithms must be of type "secret"`)}}else{if(!(0,n.default)(t))throw TypeError((0,a.withAlg)(e,t,...n.types));if("secret"===t.type)throw TypeError(`${n.types.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===r&&"public"===t.type)throw TypeError(`${n.types.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===r&&"public"===t.type)throw TypeError(`${n.types.join(" or ")} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&"verify"===r&&"private"===t.type)throw TypeError(`${n.types.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&"encrypt"===r&&"private"===t.type)throw TypeError(`${n.types.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)}}},72161,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=e.r(54799),n=e.r(96442),i=e.r(60120),o=e.r(979),s=e.r(86369),c=e.r(9412),d=e.r(77109),l=e.r(55548),u=e.r(26859),p=e.r(86325),f=e.r(4111),y=e.r(65893);r.default=(e,t,r,h,m)=>{let w;if((0,c.isCryptoKey)(r))(0,d.checkEncCryptoKey)(r,e,"encrypt"),w=a.KeyObject.from(r);else if(r instanceof Uint8Array||(0,l.default)(r))w=r;else throw TypeError((0,u.default)(r,...y.types,"Uint8Array"));switch((0,i.default)(e,w),(0,n.default)(e,h),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return function(e,t,r,n,i){let c=parseInt(e.slice(1,4),10);(0,l.default)(r)&&(r=r.export());let d=r.subarray(c>>3),u=r.subarray(0,c>>3),y=`aes-${c}-cbc`;if(!(0,f.default)(y))throw new p.JOSENotSupported(`alg ${e} is not supported by your javascript runtime`);let h=(0,a.createCipheriv)(y,d,n),m=(0,o.concat)(h.update(t),h.final()),w=parseInt(e.slice(-3),10),g=(0,s.default)(i,n,m,w,u,c);return{ciphertext:m,tag:g}}(e,t,w,h,m);case"A128GCM":case"A192GCM":case"A256GCM":var g=w;let v=parseInt(e.slice(1,4),10),E=`aes-${v}-gcm`;if(!(0,f.default)(E))throw new p.JOSENotSupported(`alg ${e} is not supported by your javascript runtime`);let S=(0,a.createCipheriv)(E,g,h,{authTagLength:16});m.byteLength&&S.setAAD(m,{plaintextLength:t.length});let b=S.update(t);return S.final(),{ciphertext:b,tag:S.getAuthTag()};default:throw new p.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}}},37623,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.unwrap=r.wrap=void 0;let a=e.r(72161),n=e.r(97899),i=e.r(3049),o=e.r(14882);r.wrap=async function(e,t,r,n){let s=e.slice(0,7);n||(n=(0,i.default)(s));let{ciphertext:c,tag:d}=await (0,a.default)(s,r,t,n,new Uint8Array(0));return{encryptedKey:c,iv:(0,o.encode)(n),tag:(0,o.encode)(d)}},r.unwrap=async function(e,t,r,a,i){let o=e.slice(0,7);return(0,n.default)(o,t,r,a,i,new Uint8Array(0))}},36228,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=e.r(66389),n=e.r(89026),i=e.r(89925),o=e.r(3077),s=e.r(14882),c=e.r(86325),d=e.r(30630),l=e.r(9132),u=e.r(89875),p=e.r(80275),f=e.r(37623);r.default=async function(e,t,r,y,h){switch((0,u.default)(e,t,"decrypt"),e){case"dir":if(void 0!==r)throw new c.JWEInvalid("Encountered unexpected JWE Encrypted Key");return t;case"ECDH-ES":if(void 0!==r)throw new c.JWEInvalid("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let i,o;if(!(0,p.default)(y.epk))throw new c.JWEInvalid('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!n.ecdhAllowed(t))throw new c.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let u=await (0,l.importJWK)(y.epk,e);if(void 0!==y.apu){if("string"!=typeof y.apu)throw new c.JWEInvalid('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{i=(0,s.decode)(y.apu)}catch{throw new c.JWEInvalid("Failed to base64url decode the apu")}}if(void 0!==y.apv){if("string"!=typeof y.apv)throw new c.JWEInvalid('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{o=(0,s.decode)(y.apv)}catch{throw new c.JWEInvalid("Failed to base64url decode the apv")}}let f=await n.deriveKey(u,t,"ECDH-ES"===e?y.enc:e,"ECDH-ES"===e?(0,d.bitLength)(y.enc):parseInt(e.slice(-5,-2),10),i,o);if("ECDH-ES"===e)return f;if(void 0===r)throw new c.JWEInvalid("JWE Encrypted Key missing");return(0,a.unwrap)(e.slice(-6),f,r)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(void 0===r)throw new c.JWEInvalid("JWE Encrypted Key missing");return(0,o.decrypt)(e,t,r);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{let a;if(void 0===r)throw new c.JWEInvalid("JWE Encrypted Key missing");if("number"!=typeof y.p2c)throw new c.JWEInvalid('JOSE Header "p2c" (PBES2 Count) missing or invalid');let n=(null==h?void 0:h.maxPBES2Count)||1e4;if(y.p2c>n)throw new c.JWEInvalid('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof y.p2s)throw new c.JWEInvalid('JOSE Header "p2s" (PBES2 Salt) missing or invalid');try{a=(0,s.decode)(y.p2s)}catch{throw new c.JWEInvalid("Failed to base64url decode the p2s")}return(0,i.decrypt)(e,t,r,y.p2c,a)}case"A128KW":case"A192KW":case"A256KW":if(void 0===r)throw new c.JWEInvalid("JWE Encrypted Key missing");return(0,a.unwrap)(e,t,r);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{let a,n;if(void 0===r)throw new c.JWEInvalid("JWE Encrypted Key missing");if("string"!=typeof y.iv)throw new c.JWEInvalid('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof y.tag)throw new c.JWEInvalid('JOSE Header "tag" (Authentication Tag) missing or invalid');try{a=(0,s.decode)(y.iv)}catch{throw new c.JWEInvalid("Failed to base64url decode the iv")}try{n=(0,s.decode)(y.tag)}catch{throw new c.JWEInvalid("Failed to base64url decode the tag")}return(0,f.unwrap)(e,t,r,a,n)}default:throw new c.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}}},71322,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=e.r(86325);r.default=function(e,t,r,n,i){let o;if(void 0!==i.crit&&void 0===n.crit)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||void 0===n.crit)return new Set;if(!Array.isArray(n.crit)||0===n.crit.length||n.crit.some(e=>"string"!=typeof e||0===e.length))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let s of(o=void 0!==r?new Map([...Object.entries(r),...t.entries()]):t,n.crit)){if(!o.has(s))throw new a.JOSENotSupported(`Extension Header Parameter "${s}" is not recognized`);if(void 0===i[s])throw new e(`Extension Header Parameter "${s}" is missing`);if(o.get(s)&&void 0===n[s])throw new e(`Extension Header Parameter "${s}" MUST be integrity protected`)}return new Set(n.crit)}},1243,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=(e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some(e=>"string"!=typeof e)))throw TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)}},21084,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.flattenedDecrypt=void 0;let a=e.r(14882),n=e.r(97899),i=e.r(96825),o=e.r(86325),s=e.r(78410),c=e.r(80275),d=e.r(36228),l=e.r(979),u=e.r(30630),p=e.r(71322),f=e.r(1243);r.flattenedDecrypt=async function(e,t,r){var y;let h,m,w,g,v,E,S;if(!(0,c.default)(e))throw new o.JWEInvalid("Flattened JWE must be an object");if(void 0===e.protected&&void 0===e.header&&void 0===e.unprotected)throw new o.JWEInvalid("JOSE Header missing");if("string"!=typeof e.iv)throw new o.JWEInvalid("JWE Initialization Vector missing or incorrect type");if("string"!=typeof e.ciphertext)throw new o.JWEInvalid("JWE Ciphertext missing or incorrect type");if("string"!=typeof e.tag)throw new o.JWEInvalid("JWE Authentication Tag missing or incorrect type");if(void 0!==e.protected&&"string"!=typeof e.protected)throw new o.JWEInvalid("JWE Protected Header incorrect type");if(void 0!==e.encrypted_key&&"string"!=typeof e.encrypted_key)throw new o.JWEInvalid("JWE Encrypted Key incorrect type");if(void 0!==e.aad&&"string"!=typeof e.aad)throw new o.JWEInvalid("JWE AAD incorrect type");if(void 0!==e.header&&!(0,c.default)(e.header))throw new o.JWEInvalid("JWE Shared Unprotected Header incorrect type");if(void 0!==e.unprotected&&!(0,c.default)(e.unprotected))throw new o.JWEInvalid("JWE Per-Recipient Unprotected Header incorrect type");if(e.protected)try{let t=(0,a.decode)(e.protected);h=JSON.parse(l.decoder.decode(t))}catch{throw new o.JWEInvalid("JWE Protected Header is invalid")}if(!(0,s.default)(h,e.header,e.unprotected))throw new o.JWEInvalid("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let b={...h,...e.header,...e.unprotected};if((0,p.default)(o.JWEInvalid,new Map,null==r?void 0:r.crit,h,b),void 0!==b.zip){if(!h||!h.zip)throw new o.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==b.zip)throw new o.JOSENotSupported('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:_,enc:J}=b;if("string"!=typeof _||!_)throw new o.JWEInvalid("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof J||!J)throw new o.JWEInvalid("missing JWE Encryption Algorithm (enc) in JWE Header");let P=r&&(0,f.default)("keyManagementAlgorithms",r.keyManagementAlgorithms),W=r&&(0,f.default)("contentEncryptionAlgorithms",r.contentEncryptionAlgorithms);if(P&&!P.has(_))throw new o.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(W&&!W.has(J))throw new o.JOSEAlgNotAllowed('"enc" (Encryption Algorithm) Header Parameter not allowed');if(void 0!==e.encrypted_key)try{m=(0,a.decode)(e.encrypted_key)}catch{throw new o.JWEInvalid("Failed to base64url decode the encrypted_key")}let A=!1;"function"==typeof t&&(t=await t(h,e),A=!0);try{w=await (0,d.default)(_,t,m,b,r)}catch(e){if(e instanceof TypeError||e instanceof o.JWEInvalid||e instanceof o.JOSENotSupported)throw e;w=(0,u.default)(J)}try{g=(0,a.decode)(e.iv)}catch{throw new o.JWEInvalid("Failed to base64url decode the iv")}try{v=(0,a.decode)(e.tag)}catch{throw new o.JWEInvalid("Failed to base64url decode the tag")}let K=l.encoder.encode(null!=(y=e.protected)?y:"");E=void 0!==e.aad?(0,l.concat)(K,l.encoder.encode("."),l.encoder.encode(e.aad)):K;try{S=(0,a.decode)(e.ciphertext)}catch{throw new o.JWEInvalid("Failed to base64url decode the ciphertext")}let I=await (0,n.default)(J,w,S,g,v,E);"DEF"===b.zip&&(I=await ((null==r?void 0:r.inflateRaw)||i.inflate)(I));let k={plaintext:I};if(void 0!==e.protected&&(k.protectedHeader=h),void 0!==e.aad)try{k.additionalAuthenticatedData=(0,a.decode)(e.aad)}catch{throw new o.JWEInvalid("Failed to base64url decode the aad")}return(void 0!==e.unprotected&&(k.sharedUnprotectedHeader=e.unprotected),void 0!==e.header&&(k.unprotectedHeader=e.header),A)?{...k,key:t}:k}},37958,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.compactDecrypt=void 0;let a=e.r(21084),n=e.r(86325),i=e.r(979);r.compactDecrypt=async function(e,t,r){if(e instanceof Uint8Array&&(e=i.decoder.decode(e)),"string"!=typeof e)throw new n.JWEInvalid("Compact JWE must be a string or Uint8Array");let{0:o,1:s,2:c,3:d,4:l,length:u}=e.split(".");if(5!==u)throw new n.JWEInvalid("Invalid Compact JWE");let p=await (0,a.flattenedDecrypt)({ciphertext:d,iv:c||void 0,protected:o||void 0,tag:l||void 0,encrypted_key:s||void 0},t,r),f={plaintext:p.plaintext,protectedHeader:p.protectedHeader};return"function"==typeof t?{...f,key:p.key}:f}},2067,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.generalDecrypt=void 0;let a=e.r(21084),n=e.r(86325),i=e.r(80275);r.generalDecrypt=async function(e,t,r){if(!(0,i.default)(e))throw new n.JWEInvalid("General JWE must be an object");if(!Array.isArray(e.recipients)||!e.recipients.every(i.default))throw new n.JWEInvalid("JWE Recipients missing or incorrect type");if(!e.recipients.length)throw new n.JWEInvalid("JWE Recipients has no members");for(let n of e.recipients)try{return await (0,a.flattenedDecrypt)({aad:e.aad,ciphertext:e.ciphertext,encrypted_key:n.encrypted_key,header:n.header,iv:e.iv,protected:e.protected,tag:e.tag,unprotected:e.unprotected},t,r)}catch{}throw new n.JWEDecryptionFailed}},61225,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=class{constructor(e){if(48!==e[0]||(this.buffer=e,this.offset=1,this.decodeLength()!==e.length-this.offset))throw TypeError()}decodeLength(){let e=this.buffer[this.offset++];if(128&e){let t=-129&e;e=0;for(let r=0;r<t;r++)e=e<<8|this.buffer[this.offset+r];this.offset+=t}return e}unsignedInteger(){if(2!==this.buffer[this.offset++])throw TypeError();let e=this.decodeLength();0===this.buffer[this.offset]&&(this.offset++,e--);let t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}end(){if(this.offset!==this.buffer.length)throw TypeError()}}},13155,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=e.r(54799),n=e.r(14882),i=e.r(61225),o=e.r(86325),s=e.r(7586),c=e.r(9412),d=e.r(55548),l=e.r(26859),u=e.r(65893),p=e.r(37584),f=e=>{let t;if((0,c.isCryptoKey)(e)){if(!e.extractable)throw TypeError("CryptoKey is not extractable");t=a.KeyObject.from(e)}else if((0,d.default)(e))t=e;else if(e instanceof Uint8Array)return{kty:"oct",k:(0,n.encode)(e)};else throw TypeError((0,l.default)(e,...u.types,"Uint8Array"));if(p.jwkExport){if("secret"!==t.type&&!["rsa","ec","ed25519","x25519","ed448","x448"].includes(t.asymmetricKeyType))throw new o.JOSENotSupported("Unsupported key asymmetricKeyType");return t.export({format:"jwk"})}switch(t.type){case"secret":return{kty:"oct",k:(0,n.encode)(t.export())};case"private":case"public":switch(t.asymmetricKeyType){case"rsa":{let e,r=t.export({format:"der",type:"pkcs1"}),a=new i.default(r);"private"===t.type&&a.unsignedInteger();let o=(0,n.encode)(a.unsignedInteger()),s=(0,n.encode)(a.unsignedInteger());return"private"===t.type&&(e={d:(0,n.encode)(a.unsignedInteger()),p:(0,n.encode)(a.unsignedInteger()),q:(0,n.encode)(a.unsignedInteger()),dp:(0,n.encode)(a.unsignedInteger()),dq:(0,n.encode)(a.unsignedInteger()),qi:(0,n.encode)(a.unsignedInteger())}),a.end(),{kty:"RSA",n:o,e:s,...e}}case"ec":{let e,r,i,c=(0,s.default)(t);switch(c){case"secp256k1":e=64,r=33,i=-1;break;case"P-256":e=64,r=36,i=-1;break;case"P-384":e=96,r=35,i=-3;break;case"P-521":e=132,r=35,i=-3;break;default:throw new o.JOSENotSupported("Unsupported curve")}if("public"===t.type){let r=t.export({type:"spki",format:"der"});return{kty:"EC",crv:c,x:(0,n.encode)(r.subarray(-e,-e/2)),y:(0,n.encode)(r.subarray(-e/2))}}let d=t.export({type:"pkcs8",format:"der"});return d.length<100&&(r+=i),{...f((0,a.createPublicKey)(t)),d:(0,n.encode)(d.subarray(r,r+e/2))}}case"ed25519":case"x25519":{let e=(0,s.default)(t);if("public"===t.type){let r=t.export({type:"spki",format:"der"});return{kty:"OKP",crv:e,x:(0,n.encode)(r.subarray(-32))}}let r=t.export({type:"pkcs8",format:"der"});return{...f((0,a.createPublicKey)(t)),d:(0,n.encode)(r.subarray(-32))}}case"ed448":case"x448":{let e=(0,s.default)(t);if("public"===t.type){let r=t.export({type:"spki",format:"der"});return{kty:"OKP",crv:e,x:(0,n.encode)(r.subarray("Ed448"===e?-57:-56))}}let r=t.export({type:"pkcs8",format:"der"});return{...f((0,a.createPublicKey)(t)),d:(0,n.encode)(r.subarray("Ed448"===e?-57:-56))}}default:throw new o.JOSENotSupported("Unsupported key asymmetricKeyType")}default:throw new o.JOSENotSupported("Unsupported key type")}};r.default=f},93514,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.exportJWK=r.exportPKCS8=r.exportSPKI=void 0;let a=e.r(14133),n=e.r(14133),i=e.r(13155);r.exportSPKI=async function(e){return(0,a.toSPKI)(e)},r.exportPKCS8=async function(e){return(0,n.toPKCS8)(e)},r.exportJWK=async function(e){return(0,i.default)(e)}},75358,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=e.r(66389),n=e.r(89026),i=e.r(89925),o=e.r(3077),s=e.r(14882),c=e.r(30630),d=e.r(86325),l=e.r(93514),u=e.r(89875),p=e.r(37623);r.default=async function(e,t,r,f,y={}){let h,m,w;switch((0,u.default)(e,r,"encrypt"),e){case"dir":w=r;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!n.ecdhAllowed(r))throw new d.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:i,apv:o}=y,{epk:u}=y;u||(u=(await n.generateEpk(r)).privateKey);let{x:p,y:g,crv:v,kty:E}=await (0,l.exportJWK)(u),S=await n.deriveKey(r,u,"ECDH-ES"===e?t:e,"ECDH-ES"===e?(0,c.bitLength)(t):parseInt(e.slice(-5,-2),10),i,o);if(m={epk:{x:p,crv:v,kty:E}},"EC"===E&&(m.epk.y=g),i&&(m.apu=(0,s.encode)(i)),o&&(m.apv=(0,s.encode)(o)),"ECDH-ES"===e){w=S;break}w=f||(0,c.default)(t);let b=e.slice(-6);h=await (0,a.wrap)(b,S,w);break}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":w=f||(0,c.default)(t),h=await (0,o.encrypt)(e,r,w);break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{w=f||(0,c.default)(t);let{p2c:a,p2s:n}=y;({encryptedKey:h,...m}=await (0,i.encrypt)(e,r,w,a,n));break}case"A128KW":case"A192KW":case"A256KW":w=f||(0,c.default)(t),h=await (0,a.wrap)(e,r,w);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{w=f||(0,c.default)(t);let{iv:a}=y;({encryptedKey:h,...m}=await (0,p.wrap)(e,r,w,a));break}default:throw new d.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:w,encryptedKey:h,parameters:m}}},18168,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FlattenedEncrypt=r.unprotected=void 0;let a=e.r(14882),n=e.r(72161),i=e.r(96825),o=e.r(3049),s=e.r(75358),c=e.r(86325),d=e.r(78410),l=e.r(979),u=e.r(71322);r.unprotected=Symbol(),r.FlattenedEncrypt=class{constructor(e){if(!(e instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this._plaintext=e}setKeyManagementParameters(e){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setSharedUnprotectedHeader(e){if(this._sharedUnprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._sharedUnprotectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}setAdditionalAuthenticatedData(e){return this._aad=e,this}setContentEncryptionKey(e){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}setInitializationVector(e){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=e,this}async encrypt(e,t){let p,f,y,h,m,w,g;if(!this._protectedHeader&&!this._unprotectedHeader&&!this._sharedUnprotectedHeader)throw new c.JWEInvalid("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!(0,d.default)(this._protectedHeader,this._unprotectedHeader,this._sharedUnprotectedHeader))throw new c.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let v={...this._protectedHeader,...this._unprotectedHeader,...this._sharedUnprotectedHeader};if((0,u.default)(c.JWEInvalid,new Map,null==t?void 0:t.crit,this._protectedHeader,v),void 0!==v.zip){if(!this._protectedHeader||!this._protectedHeader.zip)throw new c.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==v.zip)throw new c.JOSENotSupported('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:E,enc:S}=v;if("string"!=typeof E||!E)throw new c.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("string"!=typeof S||!S)throw new c.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if("dir"===E){if(this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Encryption")}else if("ECDH-ES"===E&&this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Key Agreement");{let a;({cek:f,encryptedKey:p,parameters:a}=await (0,s.default)(E,S,e,this._cek,this._keyManagementParameters)),a&&(t&&r.unprotected in t?this._unprotectedHeader?this._unprotectedHeader={...this._unprotectedHeader,...a}:this.setUnprotectedHeader(a):this._protectedHeader?this._protectedHeader={...this._protectedHeader,...a}:this.setProtectedHeader(a))}if(this._iv||(this._iv=(0,o.default)(S)),h=this._protectedHeader?l.encoder.encode((0,a.encode)(JSON.stringify(this._protectedHeader))):l.encoder.encode(""),this._aad?(m=(0,a.encode)(this._aad),y=(0,l.concat)(h,l.encoder.encode("."),l.encoder.encode(m))):y=h,"DEF"===v.zip){let e=await ((null==t?void 0:t.deflateRaw)||i.deflate)(this._plaintext);({ciphertext:w,tag:g}=await (0,n.default)(S,e,f,this._iv,y))}else({ciphertext:w,tag:g}=await (0,n.default)(S,this._plaintext,f,this._iv,y));let b={ciphertext:(0,a.encode)(w),iv:(0,a.encode)(this._iv),tag:(0,a.encode)(g)};return p&&(b.encrypted_key=(0,a.encode)(p)),m&&(b.aad=m),this._protectedHeader&&(b.protected=l.decoder.decode(h)),this._sharedUnprotectedHeader&&(b.unprotected=this._sharedUnprotectedHeader),this._unprotectedHeader&&(b.header=this._unprotectedHeader),b}}},776,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.GeneralEncrypt=void 0;let a=e.r(18168),n=e.r(86325),i=e.r(30630),o=e.r(78410),s=e.r(75358),c=e.r(14882),d=e.r(71322);class l{constructor(e,t,r){this.parent=e,this.key=t,this.options=r}setUnprotectedHeader(e){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=e,this}addRecipient(...e){return this.parent.addRecipient(...e)}encrypt(...e){return this.parent.encrypt(...e)}done(){return this.parent}}r.GeneralEncrypt=class{constructor(e){this._recipients=[],this._plaintext=e}addRecipient(e,t){let r=new l(this,e,{crit:null==t?void 0:t.crit});return this._recipients.push(r),r}setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setSharedUnprotectedHeader(e){if(this._unprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}setAdditionalAuthenticatedData(e){return this._aad=e,this}async encrypt(e){var t,r,l;let u;if(!this._recipients.length)throw new n.JWEInvalid("at least one recipient must be added");if(e={deflateRaw:null==e?void 0:e.deflateRaw},1===this._recipients.length){let[t]=this._recipients,r=await new a.FlattenedEncrypt(this._plaintext).setAdditionalAuthenticatedData(this._aad).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(t.unprotectedHeader).encrypt(t.key,{...t.options,...e}),n={ciphertext:r.ciphertext,iv:r.iv,recipients:[{}],tag:r.tag};return r.aad&&(n.aad=r.aad),r.protected&&(n.protected=r.protected),r.unprotected&&(n.unprotected=r.unprotected),r.encrypted_key&&(n.recipients[0].encrypted_key=r.encrypted_key),r.header&&(n.recipients[0].header=r.header),n}for(let e=0;e<this._recipients.length;e++){let t=this._recipients[e];if(!(0,o.default)(this._protectedHeader,this._unprotectedHeader,t.unprotectedHeader))throw new n.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let r={...this._protectedHeader,...this._unprotectedHeader,...t.unprotectedHeader},{alg:a}=r;if("string"!=typeof a||!a)throw new n.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("dir"===a||"ECDH-ES"===a)throw new n.JWEInvalid('"dir" and "ECDH-ES" alg may only be used with a single recipient');if("string"!=typeof r.enc||!r.enc)throw new n.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(u){if(u!==r.enc)throw new n.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter must be the same for all recipients')}else u=r.enc;if((0,d.default)(n.JWEInvalid,new Map,t.options.crit,this._protectedHeader,r),void 0!==r.zip&&(!this._protectedHeader||!this._protectedHeader.zip))throw new n.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected')}let p=(0,i.default)(u),f={ciphertext:"",iv:"",recipients:[],tag:""};for(let n=0;n<this._recipients.length;n++){let i=this._recipients[n],o={};f.recipients.push(o);let d=({...this._protectedHeader,...this._unprotectedHeader,...i.unprotectedHeader}).alg.startsWith("PBES2")?2048+n:void 0;if(0===n){let t=await new a.FlattenedEncrypt(this._plaintext).setAdditionalAuthenticatedData(this._aad).setContentEncryptionKey(p).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(i.unprotectedHeader).setKeyManagementParameters({p2c:d}).encrypt(i.key,{...i.options,...e,[a.unprotected]:!0});f.ciphertext=t.ciphertext,f.iv=t.iv,f.tag=t.tag,t.aad&&(f.aad=t.aad),t.protected&&(f.protected=t.protected),t.unprotected&&(f.unprotected=t.unprotected),o.encrypted_key=t.encrypted_key,t.header&&(o.header=t.header);continue}let{encryptedKey:y,parameters:h}=await (0,s.default)((null==(t=i.unprotectedHeader)?void 0:t.alg)||(null==(r=this._protectedHeader)?void 0:r.alg)||(null==(l=this._unprotectedHeader)?void 0:l.alg),u,i.key,p,{p2c:d});o.encrypted_key=(0,c.encode)(y),(i.unprotectedHeader||h)&&(o.header={...i.unprotectedHeader,...h})}return f}}},45499,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=e.r(86325);r.default=function(e){switch(e){case"PS256":case"RS256":case"ES256":case"ES256K":return"sha256";case"PS384":case"RS384":case"ES384":return"sha384";case"PS512":case"RS512":case"ES512":return"sha512";case"EdDSA":return;default:throw new a.JOSENotSupported(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}},20535,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=e.r(54799),n=e.r(7586),i=e.r(86325),o=e.r(64870),s=e.r(37584),c={padding:a.constants.RSA_PKCS1_PSS_PADDING,saltLength:a.constants.RSA_PSS_SALTLEN_DIGEST},d=new Map([["ES256","P-256"],["ES256K","secp256k1"],["ES384","P-384"],["ES512","P-521"]]);r.default=function(e,t){switch(e){case"EdDSA":if(!["ed25519","ed448"].includes(t.asymmetricKeyType))throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ed25519 or ed448");return t;case"RS256":case"RS384":case"RS512":if("rsa"!==t.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");return(0,o.default)(t,e),t;case s.rsaPssParams&&"PS256":case s.rsaPssParams&&"PS384":case s.rsaPssParams&&"PS512":if("rsa-pss"===t.asymmetricKeyType){let{hashAlgorithm:r,mgf1HashAlgorithm:a,saltLength:n}=t.asymmetricKeyDetails,i=parseInt(e.slice(-3),10);if(void 0!==r&&(r!==`sha${i}`||a!==r))throw TypeError(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${e}`);if(void 0!==n&&n>i>>3)throw TypeError(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${e}`)}else if("rsa"!==t.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa or rsa-pss");return(0,o.default)(t,e),{key:t,...c};case!s.rsaPssParams&&"PS256":case!s.rsaPssParams&&"PS384":case!s.rsaPssParams&&"PS512":if("rsa"!==t.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");return(0,o.default)(t,e),{key:t,...c};case"ES256":case"ES256K":case"ES384":case"ES512":{if("ec"!==t.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ec");let r=(0,n.default)(t),a=d.get(e);if(r!==a)throw TypeError(`Invalid key curve for the algorithm, its curve must be ${a}, got ${r}`);return{dsaEncoding:"ieee-p1363",key:t}}default:throw new i.JOSENotSupported(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}},71899,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=e.r(86325);r.default=function(e){switch(e){case"HS256":return"sha256";case"HS384":return"sha384";case"HS512":return"sha512";default:throw new a.JOSENotSupported(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}},12073,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=e.r(54799),n=e.r(9412),i=e.r(77109),o=e.r(26859),s=e.r(65893);r.default=function(e,t,r){if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw TypeError((0,o.default)(t,...s.types));return(0,a.createSecretKey)(t)}if(t instanceof a.KeyObject)return t;if((0,n.isCryptoKey)(t))return(0,i.checkSigCryptoKey)(t,e,r),a.KeyObject.from(t);throw TypeError((0,o.default)(t,...s.types,"Uint8Array"))}},13282,(e,t,r)=>{"use strict";let a;Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(54799),i=e.r(24361),o=e.r(45499),s=e.r(71899),c=e.r(20535),d=e.r(12073);a=n.sign.length>3?(0,i.promisify)(n.sign):n.sign,r.default=async(e,t,r)=>{let i=(0,d.default)(e,t,"sign");if(e.startsWith("HS")){let t=n.createHmac((0,s.default)(e),i);return t.update(r),t.digest()}return a((0,o.default)(e),r,(0,c.default)(e,i))}},61292,(e,t,r)=>{"use strict";let a;Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(54799),i=e.r(24361),o=e.r(45499),s=e.r(20535),c=e.r(13282),d=e.r(12073),l=e.r(37584);a=n.verify.length>4&&l.oneShotCallback?(0,i.promisify)(n.verify):n.verify,r.default=async(e,t,r,i)=>{let l=(0,d.default)(e,t,"verify");if(e.startsWith("HS")){let t=await (0,c.default)(e,l,i);try{return n.timingSafeEqual(r,t)}catch{return!1}}let u=(0,o.default)(e),p=(0,s.default)(e,l);try{return await a(u,i,p,r)}catch{return!1}}},25693,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.flattenedVerify=void 0;let a=e.r(14882),n=e.r(61292),i=e.r(86325),o=e.r(979),s=e.r(78410),c=e.r(80275),d=e.r(89875),l=e.r(71322),u=e.r(1243);r.flattenedVerify=async function(e,t,r){var p;let f,y;if(!(0,c.default)(e))throw new i.JWSInvalid("Flattened JWS must be an object");if(void 0===e.protected&&void 0===e.header)throw new i.JWSInvalid('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==e.protected&&"string"!=typeof e.protected)throw new i.JWSInvalid("JWS Protected Header incorrect type");if(void 0===e.payload)throw new i.JWSInvalid("JWS Payload missing");if("string"!=typeof e.signature)throw new i.JWSInvalid("JWS Signature missing or incorrect type");if(void 0!==e.header&&!(0,c.default)(e.header))throw new i.JWSInvalid("JWS Unprotected Header incorrect type");let h={};if(e.protected)try{let t=(0,a.decode)(e.protected);h=JSON.parse(o.decoder.decode(t))}catch{throw new i.JWSInvalid("JWS Protected Header is invalid")}if(!(0,s.default)(h,e.header))throw new i.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let m={...h,...e.header},w=(0,l.default)(i.JWSInvalid,new Map([["b64",!0]]),null==r?void 0:r.crit,h,m),g=!0;if(w.has("b64")&&"boolean"!=typeof(g=h.b64))throw new i.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:v}=m;if("string"!=typeof v||!v)throw new i.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');let E=r&&(0,u.default)("algorithms",r.algorithms);if(E&&!E.has(v))throw new i.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(g){if("string"!=typeof e.payload)throw new i.JWSInvalid("JWS Payload must be a string")}else if("string"!=typeof e.payload&&!(e.payload instanceof Uint8Array))throw new i.JWSInvalid("JWS Payload must be a string or an Uint8Array instance");let S=!1;"function"==typeof t&&(t=await t(h,e),S=!0),(0,d.default)(v,t,"verify");let b=(0,o.concat)(o.encoder.encode(null!=(p=e.protected)?p:""),o.encoder.encode("."),"string"==typeof e.payload?o.encoder.encode(e.payload):e.payload);try{f=(0,a.decode)(e.signature)}catch{throw new i.JWSInvalid("Failed to base64url decode the signature")}if(!await (0,n.default)(v,t,f,b))throw new i.JWSSignatureVerificationFailed;if(g)try{y=(0,a.decode)(e.payload)}catch{throw new i.JWSInvalid("Failed to base64url decode the payload")}else y="string"==typeof e.payload?o.encoder.encode(e.payload):e.payload;let _={payload:y};return(void 0!==e.protected&&(_.protectedHeader=h),void 0!==e.header&&(_.unprotectedHeader=e.header),S)?{..._,key:t}:_}},99418,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.compactVerify=void 0;let a=e.r(25693),n=e.r(86325),i=e.r(979);r.compactVerify=async function(e,t,r){if(e instanceof Uint8Array&&(e=i.decoder.decode(e)),"string"!=typeof e)throw new n.JWSInvalid("Compact JWS must be a string or Uint8Array");let{0:o,1:s,2:c,length:d}=e.split(".");if(3!==d)throw new n.JWSInvalid("Invalid Compact JWS");let l=await (0,a.flattenedVerify)({payload:s,protected:o,signature:c},t,r),u={payload:l.payload,protectedHeader:l.protectedHeader};return"function"==typeof t?{...u,key:l.key}:u}},71621,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.generalVerify=void 0;let a=e.r(25693),n=e.r(86325),i=e.r(80275);r.generalVerify=async function(e,t,r){if(!(0,i.default)(e))throw new n.JWSInvalid("General JWS must be an object");if(!Array.isArray(e.signatures)||!e.signatures.every(i.default))throw new n.JWSInvalid("JWS Signatures missing or incorrect type");for(let n of e.signatures)try{return await (0,a.flattenedVerify)({header:n.header,payload:e.payload,protected:n.protected,signature:n.signature},t,r)}catch{}throw new n.JWSSignatureVerificationFailed}},25417,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=e=>Math.floor(e.getTime()/1e3)},114,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i;r.default=e=>{let t=a.exec(e);if(!t)throw TypeError("Invalid time period format");let r=parseFloat(t[1]);switch(t[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(r);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(60*r);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(3600*r);case"day":case"days":case"d":return Math.round(86400*r);case"week":case"weeks":case"w":return Math.round(604800*r);default:return Math.round(0x1e187e0*r)}}},74953,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=e.r(86325),n=e.r(979),i=e.r(25417),o=e.r(114),s=e.r(80275),c=e=>e.toLowerCase().replace(/^application\//,"");r.default=(e,t,r={})=>{var d,l;let u,p,{typ:f}=r;if(f&&("string"!=typeof e.typ||c(e.typ)!==c(f)))throw new a.JWTClaimValidationFailed('unexpected "typ" JWT header value',"typ","check_failed");try{u=JSON.parse(n.decoder.decode(t))}catch{}if(!(0,s.default)(u))throw new a.JWTInvalid("JWT Claims Set must be a top-level JSON object");let{requiredClaims:y=[],issuer:h,subject:m,audience:w,maxTokenAge:g}=r;for(let e of(void 0!==g&&y.push("iat"),void 0!==w&&y.push("aud"),void 0!==m&&y.push("sub"),void 0!==h&&y.push("iss"),new Set(y.reverse())))if(!(e in u))throw new a.JWTClaimValidationFailed(`missing required "${e}" claim`,e,"missing");if(h&&!(Array.isArray(h)?h:[h]).includes(u.iss))throw new a.JWTClaimValidationFailed('unexpected "iss" claim value',"iss","check_failed");if(m&&u.sub!==m)throw new a.JWTClaimValidationFailed('unexpected "sub" claim value',"sub","check_failed");if(w&&(d=u.aud,l="string"==typeof w?[w]:w,"string"==typeof d?!l.includes(d):!(Array.isArray(d)&&l.some(Set.prototype.has.bind(new Set(d))))))throw new a.JWTClaimValidationFailed('unexpected "aud" claim value',"aud","check_failed");switch(typeof r.clockTolerance){case"string":p=(0,o.default)(r.clockTolerance);break;case"number":p=r.clockTolerance;break;case"undefined":p=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:v}=r,E=(0,i.default)(v||new Date);if((void 0!==u.iat||g)&&"number"!=typeof u.iat)throw new a.JWTClaimValidationFailed('"iat" claim must be a number',"iat","invalid");if(void 0!==u.nbf){if("number"!=typeof u.nbf)throw new a.JWTClaimValidationFailed('"nbf" claim must be a number',"nbf","invalid");if(u.nbf>E+p)throw new a.JWTClaimValidationFailed('"nbf" claim timestamp check failed',"nbf","check_failed")}if(void 0!==u.exp){if("number"!=typeof u.exp)throw new a.JWTClaimValidationFailed('"exp" claim must be a number',"exp","invalid");if(u.exp<=E-p)throw new a.JWTExpired('"exp" claim timestamp check failed',"exp","check_failed")}if(g){let e=E-u.iat;if(e-p>("number"==typeof g?g:(0,o.default)(g)))throw new a.JWTExpired('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(e<0-p)throw new a.JWTClaimValidationFailed('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}return u}},99697,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.jwtVerify=void 0;let a=e.r(99418),n=e.r(74953),i=e.r(86325);r.jwtVerify=async function(e,t,r){var o;let s=await (0,a.compactVerify)(e,t,r);if((null==(o=s.protectedHeader.crit)?void 0:o.includes("b64"))&&!1===s.protectedHeader.b64)throw new i.JWTInvalid("JWTs MUST NOT use unencoded payload");let c={payload:(0,n.default)(s.protectedHeader,s.payload,r),protectedHeader:s.protectedHeader};return"function"==typeof t?{...c,key:s.key}:c}},7082,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.jwtDecrypt=void 0;let a=e.r(37958),n=e.r(74953),i=e.r(86325);r.jwtDecrypt=async function(e,t,r){let o=await (0,a.compactDecrypt)(e,t,r),s=(0,n.default)(o.protectedHeader,o.plaintext,r),{protectedHeader:c}=o;if(void 0!==c.iss&&c.iss!==s.iss)throw new i.JWTClaimValidationFailed('replicated "iss" claim header parameter mismatch',"iss","mismatch");if(void 0!==c.sub&&c.sub!==s.sub)throw new i.JWTClaimValidationFailed('replicated "sub" claim header parameter mismatch',"sub","mismatch");if(void 0!==c.aud&&JSON.stringify(c.aud)!==JSON.stringify(s.aud))throw new i.JWTClaimValidationFailed('replicated "aud" claim header parameter mismatch',"aud","mismatch");let d={payload:s,protectedHeader:c};return"function"==typeof t?{...d,key:o.key}:d}},39139,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CompactEncrypt=void 0;let a=e.r(18168);r.CompactEncrypt=class{constructor(e){this._flattened=new a.FlattenedEncrypt(e)}setContentEncryptionKey(e){return this._flattened.setContentEncryptionKey(e),this}setInitializationVector(e){return this._flattened.setInitializationVector(e),this}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}setKeyManagementParameters(e){return this._flattened.setKeyManagementParameters(e),this}async encrypt(e,t){let r=await this._flattened.encrypt(e,t);return[r.protected,r.encrypted_key,r.iv,r.ciphertext,r.tag].join(".")}}},50833,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FlattenedSign=void 0;let a=e.r(14882),n=e.r(13282),i=e.r(78410),o=e.r(86325),s=e.r(979),c=e.r(89875),d=e.r(71322);r.FlattenedSign=class{constructor(e){if(!(e instanceof Uint8Array))throw TypeError("payload must be an instance of Uint8Array");this._payload=e}setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}async sign(e,t){let r;if(!this._protectedHeader&&!this._unprotectedHeader)throw new o.JWSInvalid("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!(0,i.default)(this._protectedHeader,this._unprotectedHeader))throw new o.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let l={...this._protectedHeader,...this._unprotectedHeader},u=(0,d.default)(o.JWSInvalid,new Map([["b64",!0]]),null==t?void 0:t.crit,this._protectedHeader,l),p=!0;if(u.has("b64")&&"boolean"!=typeof(p=this._protectedHeader.b64))throw new o.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:f}=l;if("string"!=typeof f||!f)throw new o.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');(0,c.default)(f,e,"sign");let y=this._payload;p&&(y=s.encoder.encode((0,a.encode)(y))),r=this._protectedHeader?s.encoder.encode((0,a.encode)(JSON.stringify(this._protectedHeader))):s.encoder.encode("");let h=(0,s.concat)(r,s.encoder.encode("."),y),m=await (0,n.default)(f,e,h),w={signature:(0,a.encode)(m),payload:""};return p&&(w.payload=s.decoder.decode(y)),this._unprotectedHeader&&(w.header=this._unprotectedHeader),this._protectedHeader&&(w.protected=s.decoder.decode(r)),w}}},42430,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CompactSign=void 0;let a=e.r(50833);r.CompactSign=class{constructor(e){this._flattened=new a.FlattenedSign(e)}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}async sign(e,t){let r=await this._flattened.sign(e,t);if(void 0===r.payload)throw TypeError("use the flattened module for creating JWS with b64: false");return`${r.protected}.${r.payload}.${r.signature}`}}},21760,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.GeneralSign=void 0;let a=e.r(50833),n=e.r(86325);class i{constructor(e,t,r){this.parent=e,this.key=t,this.options=r}setProtectedHeader(e){if(this.protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this.protectedHeader=e,this}setUnprotectedHeader(e){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=e,this}addSignature(...e){return this.parent.addSignature(...e)}sign(...e){return this.parent.sign(...e)}done(){return this.parent}}r.GeneralSign=class{constructor(e){this._signatures=[],this._payload=e}addSignature(e,t){let r=new i(this,e,t);return this._signatures.push(r),r}async sign(){if(!this._signatures.length)throw new n.JWSInvalid("at least one signature must be added");let e={signatures:[],payload:""};for(let t=0;t<this._signatures.length;t++){let r=this._signatures[t],i=new a.FlattenedSign(this._payload);i.setProtectedHeader(r.protectedHeader),i.setUnprotectedHeader(r.unprotectedHeader);let{payload:o,...s}=await i.sign(r.key,r.options);if(0===t)e.payload=o;else if(e.payload!==o)throw new n.JWSInvalid("inconsistent use of JWS Unencoded Payload (RFC7797)");e.signatures.push(s)}return e}}},97764,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ProduceJWT=void 0;let a=e.r(25417),n=e.r(80275),i=e.r(114);r.ProduceJWT=class{constructor(e){if(!(0,n.default)(e))throw TypeError("JWT Claims Set MUST be an object");this._payload=e}setIssuer(e){return this._payload={...this._payload,iss:e},this}setSubject(e){return this._payload={...this._payload,sub:e},this}setAudience(e){return this._payload={...this._payload,aud:e},this}setJti(e){return this._payload={...this._payload,jti:e},this}setNotBefore(e){return"number"==typeof e?this._payload={...this._payload,nbf:e}:this._payload={...this._payload,nbf:(0,a.default)(new Date)+(0,i.default)(e)},this}setExpirationTime(e){return"number"==typeof e?this._payload={...this._payload,exp:e}:this._payload={...this._payload,exp:(0,a.default)(new Date)+(0,i.default)(e)},this}setIssuedAt(e){return void 0===e?this._payload={...this._payload,iat:(0,a.default)(new Date)}:this._payload={...this._payload,iat:e},this}}},25021,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SignJWT=void 0;let a=e.r(42430),n=e.r(86325),i=e.r(979),o=e.r(97764);class s extends o.ProduceJWT{setProtectedHeader(e){return this._protectedHeader=e,this}async sign(e,t){var r;let o=new a.CompactSign(i.encoder.encode(JSON.stringify(this._payload)));if(o.setProtectedHeader(this._protectedHeader),Array.isArray(null==(r=this._protectedHeader)?void 0:r.crit)&&this._protectedHeader.crit.includes("b64")&&!1===this._protectedHeader.b64)throw new n.JWTInvalid("JWTs MUST NOT use unencoded payload");return o.sign(e,t)}}r.SignJWT=s},71181,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.EncryptJWT=void 0;let a=e.r(39139),n=e.r(979),i=e.r(97764);class o extends i.ProduceJWT{setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setKeyManagementParameters(e){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}setContentEncryptionKey(e){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}setInitializationVector(e){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=e,this}replicateIssuerAsHeader(){return this._replicateIssuerAsHeader=!0,this}replicateSubjectAsHeader(){return this._replicateSubjectAsHeader=!0,this}replicateAudienceAsHeader(){return this._replicateAudienceAsHeader=!0,this}async encrypt(e,t){let r=new a.CompactEncrypt(n.encoder.encode(JSON.stringify(this._payload)));return this._replicateIssuerAsHeader&&(this._protectedHeader={...this._protectedHeader,iss:this._payload.iss}),this._replicateSubjectAsHeader&&(this._protectedHeader={...this._protectedHeader,sub:this._payload.sub}),this._replicateAudienceAsHeader&&(this._protectedHeader={...this._protectedHeader,aud:this._payload.aud}),r.setProtectedHeader(this._protectedHeader),this._iv&&r.setInitializationVector(this._iv),this._cek&&r.setContentEncryptionKey(this._cek),this._keyManagementParameters&&r.setKeyManagementParameters(this._keyManagementParameters),r.encrypt(e,t)}}r.EncryptJWT=o},21518,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.calculateJwkThumbprintUri=r.calculateJwkThumbprint=void 0;let a=e.r(39684),n=e.r(14882),i=e.r(86325),o=e.r(979),s=e.r(80275),c=(e,t)=>{if("string"!=typeof e||!e)throw new i.JWKInvalid(`${t} missing or invalid`)};async function d(e,t){let r;if(!(0,s.default)(e))throw TypeError("JWK must be an object");if(null!=t||(t="sha256"),"sha256"!==t&&"sha384"!==t&&"sha512"!==t)throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(e.kty){case"EC":c(e.crv,'"crv" (Curve) Parameter'),c(e.x,'"x" (X Coordinate) Parameter'),c(e.y,'"y" (Y Coordinate) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x,y:e.y};break;case"OKP":c(e.crv,'"crv" (Subtype of Key Pair) Parameter'),c(e.x,'"x" (Public Key) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x};break;case"RSA":c(e.e,'"e" (Exponent) Parameter'),c(e.n,'"n" (Modulus) Parameter'),r={e:e.e,kty:e.kty,n:e.n};break;case"oct":c(e.k,'"k" (Key Value) Parameter'),r={k:e.k,kty:e.kty};break;default:throw new i.JOSENotSupported('"kty" (Key Type) Parameter missing or unsupported')}let d=o.encoder.encode(JSON.stringify(r));return(0,n.encode)(await (0,a.default)(t,d))}r.calculateJwkThumbprint=d,r.calculateJwkThumbprintUri=async function(e,t){null!=t||(t="sha256");let r=await d(e,t);return`urn:ietf:params:oauth:jwk-thumbprint:sha-${t.slice(-3)}:${r}`}},1853,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.EmbeddedJWK=void 0;let a=e.r(9132),n=e.r(80275),i=e.r(86325);r.EmbeddedJWK=async function(e,t){let r={...e,...null==t?void 0:t.header};if(!(0,n.default)(r.jwk))throw new i.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a JSON object');let o=await (0,a.importJWK)({...r.jwk,ext:!0},r.alg,!0);if(o instanceof Uint8Array||"public"!==o.type)throw new i.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a public key');return o}},13911,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createLocalJWKSet=r.LocalJWKSet=r.isJWKSLike=void 0;let a=e.r(9132),n=e.r(86325),i=e.r(80275);function o(e){return e&&"object"==typeof e&&Array.isArray(e.keys)&&e.keys.every(s)}function s(e){return(0,i.default)(e)}r.isJWKSLike=o;class c{constructor(e){if(this._cached=new WeakMap,!o(e))throw new n.JWKSInvalid("JSON Web Key Set malformed");this._jwks=function(e){return"function"==typeof structuredClone?structuredClone(e):JSON.parse(JSON.stringify(e))}(e)}async getKey(e,t){let{alg:r,kid:a}={...e,...null==t?void 0:t.header},i=function(e){switch("string"==typeof e&&e.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new n.JOSENotSupported('Unsupported "alg" value for a JSON Web Key Set')}}(r),o=this._jwks.keys.filter(e=>{let t=i===e.kty;if(t&&"string"==typeof a&&(t=a===e.kid),t&&"string"==typeof e.alg&&(t=r===e.alg),t&&"string"==typeof e.use&&(t="sig"===e.use),t&&Array.isArray(e.key_ops)&&(t=e.key_ops.includes("verify")),t&&"EdDSA"===r&&(t="Ed25519"===e.crv||"Ed448"===e.crv),t)switch(r){case"ES256":t="P-256"===e.crv;break;case"ES256K":t="secp256k1"===e.crv;break;case"ES384":t="P-384"===e.crv;break;case"ES512":t="P-521"===e.crv}return t}),{0:s,length:c}=o;if(0===c)throw new n.JWKSNoMatchingKey;if(1!==c){let e=new n.JWKSMultipleMatchingKeys,{_cached:t}=this;throw e[Symbol.asyncIterator]=async function*(){for(let e of o)try{yield await d(t,e,r)}catch{continue}},e}return d(this._cached,s,r)}}async function d(e,t,r){let i=e.get(t)||e.set(t,{}).get(t);if(void 0===i[r]){let e=await (0,a.importJWK)({...t,ext:!0},r);if(e instanceof Uint8Array||"public"!==e.type)throw new n.JWKSInvalid("JSON Web Key Set members must be public keys");i[r]=e}return i[r]}r.LocalJWKSet=c,r.createLocalJWKSet=function(e){let t=new c(e);return async function(e,r){return t.getKey(e,r)}}},27699,(e,t,r)=>{t.exports=e.x("events",()=>require("events"))},29863,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=e.r(21517),n=e.r(24836),i=e.r(27699),o=e.r(86325),s=e.r(979);r.default=async(e,t,r)=>{let c;switch(e.protocol){case"https:":c=n.get;break;case"http:":c=a.get;break;default:throw TypeError("Unsupported URL protocol.")}let{agent:d,headers:l}=r,u=c(e.href,{agent:d,timeout:t,headers:l}),[p]=await Promise.race([(0,i.once)(u,"response"),(0,i.once)(u,"timeout")]);if(!p)throw u.destroy(),new o.JWKSTimeout;if(200!==p.statusCode)throw new o.JOSEError("Expected 200 OK from the JSON Web Key Set HTTP response");let f=[];for await(let e of p)f.push(e);try{return JSON.parse(s.decoder.decode((0,s.concat)(...f)))}catch{throw new o.JOSEError("Failed to parse the JSON Web Key Set HTTP response as JSON")}}},76943,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createRemoteJWKSet=void 0;let a=e.r(29863),n=e.r(86325),i=e.r(13911);class o extends i.LocalJWKSet{constructor(e,t){if(super({keys:[]}),this._jwks=void 0,!(e instanceof URL))throw TypeError("url must be an instance of URL");this._url=new URL(e.href),this._options={agent:null==t?void 0:t.agent,headers:null==t?void 0:t.headers},this._timeoutDuration="number"==typeof(null==t?void 0:t.timeoutDuration)?null==t?void 0:t.timeoutDuration:5e3,this._cooldownDuration="number"==typeof(null==t?void 0:t.cooldownDuration)?null==t?void 0:t.cooldownDuration:3e4,this._cacheMaxAge="number"==typeof(null==t?void 0:t.cacheMaxAge)?null==t?void 0:t.cacheMaxAge:6e5}coolingDown(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cooldownDuration}fresh(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cacheMaxAge}async getKey(e,t){this._jwks&&this.fresh()||await this.reload();try{return await super.getKey(e,t)}catch(r){if(r instanceof n.JWKSNoMatchingKey&&!1===this.coolingDown())return await this.reload(),super.getKey(e,t);throw r}}async reload(){this._pendingFetch&&("undefined"!=typeof WebSocketPair||"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||"undefined"!=typeof EdgeRuntime&&"vercel"===EdgeRuntime)&&(this._pendingFetch=void 0),this._pendingFetch||(this._pendingFetch=(0,a.default)(this._url,this._timeoutDuration,this._options).then(e=>{if(!(0,i.isJWKSLike)(e))throw new n.JWKSInvalid("JSON Web Key Set malformed");this._jwks={keys:e.keys},this._jwksTimestamp=Date.now(),this._pendingFetch=void 0}).catch(e=>{throw this._pendingFetch=void 0,e})),await this._pendingFetch}}r.createRemoteJWKSet=function(e,t){let r=new o(e,t);return async function(e,t){return r.getKey(e,t)}}},71754,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.UnsecuredJWT=void 0;let a=e.r(14882),n=e.r(979),i=e.r(86325),o=e.r(74953),s=e.r(97764);class c extends s.ProduceJWT{encode(){let e=a.encode(JSON.stringify({alg:"none"})),t=a.encode(JSON.stringify(this._payload));return`${e}.${t}.`}static decode(e,t){let r;if("string"!=typeof e)throw new i.JWTInvalid("Unsecured JWT must be a string");let{0:s,1:c,2:d,length:l}=e.split(".");if(3!==l||""!==d)throw new i.JWTInvalid("Invalid Unsecured JWT");try{if(r=JSON.parse(n.decoder.decode(a.decode(s))),"none"!==r.alg)throw Error()}catch{throw new i.JWTInvalid("Invalid Unsecured JWT")}return{payload:(0,o.default)(r,a.decode(c),t),header:r}}}r.UnsecuredJWT=c},48891,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decode=r.encode=void 0;let a=e.r(14882);r.encode=a.encode,r.decode=a.decode},80096,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decodeProtectedHeader=void 0;let a=e.r(48891),n=e.r(979),i=e.r(80275);r.decodeProtectedHeader=function(e){let t;if("string"==typeof e){let r=e.split(".");(3===r.length||5===r.length)&&([t]=r)}else if("object"==typeof e&&e)if("protected"in e)t=e.protected;else throw TypeError("Token does not contain a Protected Header");try{if("string"!=typeof t||!t)throw Error();let e=JSON.parse(n.decoder.decode((0,a.decode)(t)));if(!(0,i.default)(e))throw Error();return e}catch{throw TypeError("Invalid Token or Protected Header formatting")}}},21953,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decodeJwt=void 0;let a=e.r(48891),n=e.r(979),i=e.r(80275),o=e.r(86325);r.decodeJwt=function(e){let t,r;if("string"!=typeof e)throw new o.JWTInvalid("JWTs must use Compact JWS serialization, JWT must be a string");let{1:s,length:c}=e.split(".");if(5===c)throw new o.JWTInvalid("Only JWTs using Compact JWS serialization can be decoded");if(3!==c)throw new o.JWTInvalid("Invalid JWT");if(!s)throw new o.JWTInvalid("JWTs must contain a payload");try{t=(0,a.decode)(s)}catch{throw new o.JWTInvalid("Failed to base64url decode the payload")}try{r=JSON.parse(n.decoder.decode(t))}catch{throw new o.JWTInvalid("Failed to parse the decoded payload as JSON")}if(!(0,i.default)(r))throw new o.JWTInvalid("Invalid JWT Claims Set");return r}},58905,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.generateKeyPair=r.generateSecret=void 0;let a=e.r(54799),n=e.r(24361),i=e.r(69874),o=e.r(64870),s=e.r(86325),c=(0,n.promisify)(a.generateKeyPair);r.generateSecret=async function(e,t){let r;switch(e){case"HS256":case"HS384":case"HS512":case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":r=parseInt(e.slice(-3),10);break;case"A128KW":case"A192KW":case"A256KW":case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":case"A128GCM":case"A192GCM":case"A256GCM":r=parseInt(e.slice(1,4),10);break;default:throw new s.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return(0,a.createSecretKey)((0,i.default)(new Uint8Array(r>>3)))},r.generateKeyPair=async function(e,t){var r,a;switch(e){case"RS256":case"RS384":case"RS512":case"PS256":case"PS384":case"PS512":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":case"RSA1_5":{let e=null!=(r=null==t?void 0:t.modulusLength)?r:2048;if("number"!=typeof e||e<2048)throw new s.JOSENotSupported("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");let a=await c("rsa",{modulusLength:e,publicExponent:65537});return(0,o.setModulusLength)(a.privateKey,e),(0,o.setModulusLength)(a.publicKey,e),a}case"ES256":return c("ec",{namedCurve:"P-256"});case"ES256K":return c("ec",{namedCurve:"secp256k1"});case"ES384":return c("ec",{namedCurve:"P-384"});case"ES512":return c("ec",{namedCurve:"P-521"});case"EdDSA":switch(null==t?void 0:t.crv){case void 0:case"Ed25519":return c("ed25519");case"Ed448":return c("ed448");default:throw new s.JOSENotSupported("Invalid or unsupported crv option provided, supported values are Ed25519 and Ed448")}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":let n=null!=(a=null==t?void 0:t.crv)?a:"P-256";switch(n){case void 0:case"P-256":case"P-384":case"P-521":return c("ec",{namedCurve:n});case"X25519":return c("x25519");case"X448":return c("x448");default:throw new s.JOSENotSupported("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448")}default:throw new s.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}}},17667,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.generateKeyPair=void 0;let a=e.r(58905);r.generateKeyPair=async function(e,t){return(0,a.generateKeyPair)(e,t)}},11404,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.generateSecret=void 0;let a=e.r(58905);r.generateSecret=async function(e,t){return(0,a.generateSecret)(e,t)}},62948,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default="node:crypto"},84757,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=e.r(62948).default},43272,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.cryptoRuntime=r.base64url=r.generateSecret=r.generateKeyPair=r.errors=r.decodeJwt=r.decodeProtectedHeader=r.importJWK=r.importX509=r.importPKCS8=r.importSPKI=r.exportJWK=r.exportSPKI=r.exportPKCS8=r.UnsecuredJWT=r.createRemoteJWKSet=r.createLocalJWKSet=r.EmbeddedJWK=r.calculateJwkThumbprintUri=r.calculateJwkThumbprint=r.EncryptJWT=r.SignJWT=r.GeneralSign=r.FlattenedSign=r.CompactSign=r.FlattenedEncrypt=r.CompactEncrypt=r.jwtDecrypt=r.jwtVerify=r.generalVerify=r.flattenedVerify=r.compactVerify=r.GeneralEncrypt=r.generalDecrypt=r.flattenedDecrypt=r.compactDecrypt=void 0;var a=e.r(37958);Object.defineProperty(r,"compactDecrypt",{enumerable:!0,get:function(){return a.compactDecrypt}});var n=e.r(21084);Object.defineProperty(r,"flattenedDecrypt",{enumerable:!0,get:function(){return n.flattenedDecrypt}});var i=e.r(2067);Object.defineProperty(r,"generalDecrypt",{enumerable:!0,get:function(){return i.generalDecrypt}});var o=e.r(776);Object.defineProperty(r,"GeneralEncrypt",{enumerable:!0,get:function(){return o.GeneralEncrypt}});var s=e.r(99418);Object.defineProperty(r,"compactVerify",{enumerable:!0,get:function(){return s.compactVerify}});var c=e.r(25693);Object.defineProperty(r,"flattenedVerify",{enumerable:!0,get:function(){return c.flattenedVerify}});var d=e.r(71621);Object.defineProperty(r,"generalVerify",{enumerable:!0,get:function(){return d.generalVerify}});var l=e.r(99697);Object.defineProperty(r,"jwtVerify",{enumerable:!0,get:function(){return l.jwtVerify}});var u=e.r(7082);Object.defineProperty(r,"jwtDecrypt",{enumerable:!0,get:function(){return u.jwtDecrypt}});var p=e.r(39139);Object.defineProperty(r,"CompactEncrypt",{enumerable:!0,get:function(){return p.CompactEncrypt}});var f=e.r(18168);Object.defineProperty(r,"FlattenedEncrypt",{enumerable:!0,get:function(){return f.FlattenedEncrypt}});var y=e.r(42430);Object.defineProperty(r,"CompactSign",{enumerable:!0,get:function(){return y.CompactSign}});var h=e.r(50833);Object.defineProperty(r,"FlattenedSign",{enumerable:!0,get:function(){return h.FlattenedSign}});var m=e.r(21760);Object.defineProperty(r,"GeneralSign",{enumerable:!0,get:function(){return m.GeneralSign}});var w=e.r(25021);Object.defineProperty(r,"SignJWT",{enumerable:!0,get:function(){return w.SignJWT}});var g=e.r(71181);Object.defineProperty(r,"EncryptJWT",{enumerable:!0,get:function(){return g.EncryptJWT}});var v=e.r(21518);Object.defineProperty(r,"calculateJwkThumbprint",{enumerable:!0,get:function(){return v.calculateJwkThumbprint}}),Object.defineProperty(r,"calculateJwkThumbprintUri",{enumerable:!0,get:function(){return v.calculateJwkThumbprintUri}});var E=e.r(1853);Object.defineProperty(r,"EmbeddedJWK",{enumerable:!0,get:function(){return E.EmbeddedJWK}});var S=e.r(13911);Object.defineProperty(r,"createLocalJWKSet",{enumerable:!0,get:function(){return S.createLocalJWKSet}});var b=e.r(76943);Object.defineProperty(r,"createRemoteJWKSet",{enumerable:!0,get:function(){return b.createRemoteJWKSet}});var _=e.r(71754);Object.defineProperty(r,"UnsecuredJWT",{enumerable:!0,get:function(){return _.UnsecuredJWT}});var J=e.r(93514);Object.defineProperty(r,"exportPKCS8",{enumerable:!0,get:function(){return J.exportPKCS8}}),Object.defineProperty(r,"exportSPKI",{enumerable:!0,get:function(){return J.exportSPKI}}),Object.defineProperty(r,"exportJWK",{enumerable:!0,get:function(){return J.exportJWK}});var P=e.r(9132);Object.defineProperty(r,"importSPKI",{enumerable:!0,get:function(){return P.importSPKI}}),Object.defineProperty(r,"importPKCS8",{enumerable:!0,get:function(){return P.importPKCS8}}),Object.defineProperty(r,"importX509",{enumerable:!0,get:function(){return P.importX509}}),Object.defineProperty(r,"importJWK",{enumerable:!0,get:function(){return P.importJWK}});var W=e.r(80096);Object.defineProperty(r,"decodeProtectedHeader",{enumerable:!0,get:function(){return W.decodeProtectedHeader}});var A=e.r(21953);Object.defineProperty(r,"decodeJwt",{enumerable:!0,get:function(){return A.decodeJwt}}),r.errors=e.r(86325);var K=e.r(17667);Object.defineProperty(r,"generateKeyPair",{enumerable:!0,get:function(){return K.generateKeyPair}});var I=e.r(11404);Object.defineProperty(r,"generateSecret",{enumerable:!0,get:function(){return I.generateSecret}}),r.base64url=e.r(48891);var k=e.r(84757);Object.defineProperty(r,"cryptoRuntime",{enumerable:!0,get:function(){return k.default}})},97741,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let a=e.r(54799);r.default=(e,t,r,n,i)=>{let o=parseInt(e.substr(3),10)>>3||20,s=(0,a.createHmac)(e,r.byteLength?r:new Uint8Array(o)).update(t).digest(),c=Math.ceil(i/o),d=new Uint8Array(o*c+n.byteLength+1),l=0,u=0;for(let t=1;t<=c;t++)d.set(n,u),d[u+n.byteLength]=t,d.set((0,a.createHmac)(e,s).update(d.subarray(l,u+n.byteLength+1)).digest(),u),l=u,u+=o;return d.slice(0,i)}},44752,(e,t,r)=>{"use strict";let a;Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(54799),i=e.r(97741);"function"!=typeof n.hkdf||process.versions.electron||(a=async(...e)=>new Promise((t,r)=>{n.hkdf(...e,(e,a)=>{e?r(e):t(new Uint8Array(a))})})),r.default=async(e,t,r,n,o)=>(a||i.default)(e,t,r,n,o)},43581,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.hkdf=void 0;let a=e.r(44752);function n(e,t){if("string"==typeof e)return new TextEncoder().encode(e);if(!(e instanceof Uint8Array))throw TypeError(`"${t}"" must be an instance of Uint8Array or a string`);return e}async function i(e,t,r,i,o){return(0,a.default)(function(e){switch(e){case"sha256":case"sha384":case"sha512":case"sha1":return e;default:throw TypeError('unsupported "digest" value')}}(e),function(e){let t=n(e,"ikm");if(!t.byteLength)throw TypeError('"ikm" must be at least one byte in length');return t}(t),n(r,"salt"),function(e){let t=n(e,"info");if(t.byteLength>1024)throw TypeError('"info" must not contain more than 1024 bytes');return t}(i),function(e,t){if("number"!=typeof e||!Number.isInteger(e)||e<1)throw TypeError('"keylen" must be a positive integer');if(e>255*(parseInt(t.substr(3),10)>>3||20))throw TypeError('"keylen" too large');return e}(o,e))}r.hkdf=i,r.default=i},79403,e=>{"use strict";let t,r;e.s([],55276),e.i(55276);var a=e.i(54799);let n=new Uint8Array(256),i=n.length;function o(){return i>n.length-16&&(a.default.randomFillSync(n),i=0),n.slice(i,i+=16)}let s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,c=function(e){return"string"==typeof e&&s.test(e)},d=[];for(let e=0;e<256;++e)d.push((e+256).toString(16).substr(1));let l=function(e,t=0){let r=(d[e[t+0]]+d[e[t+1]]+d[e[t+2]]+d[e[t+3]]+"-"+d[e[t+4]]+d[e[t+5]]+"-"+d[e[t+6]]+d[e[t+7]]+"-"+d[e[t+8]]+d[e[t+9]]+"-"+d[e[t+10]]+d[e[t+11]]+d[e[t+12]]+d[e[t+13]]+d[e[t+14]]+d[e[t+15]]).toLowerCase();if(!c(r))throw TypeError("Stringified UUID is invalid");return r},u=0,p=0,f=function(e){let t;if(!c(e))throw TypeError("Invalid UUID");let r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/0x10000000000&255,r[11]=t/0x100000000&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};function y(e,t,r){function a(e,a,n,i){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof a&&(a=f(a)),16!==a.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let o=new Uint8Array(16+e.length);if(o.set(a),o.set(e,a.length),(o=r(o))[6]=15&o[6]|t,o[8]=63&o[8]|128,n){i=i||0;for(let e=0;e<16;++e)n[i+e]=o[e];return n}return l(o)}try{a.name=e}catch(e){}return a.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",a.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",a}let h=y("v3",48,function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),a.default.createHash("md5").update(e).digest()}),m=y("v5",80,function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),a.default.createHash("sha1").update(e).digest()});e.s(["NIL",0,"00000000-0000-0000-0000-000000000000","parse",0,f,"stringify",0,l,"v1",0,function(e,a,n){let i=a&&n||0,s=a||Array(16),c=(e=e||{}).node||t,d=void 0!==e.clockseq?e.clockseq:r;if(null==c||null==d){let a=e.random||(e.rng||o)();null==c&&(c=t=[1|a[0],a[1],a[2],a[3],a[4],a[5]]),null==d&&(d=r=(a[6]<<8|a[7])&16383)}let f=void 0!==e.msecs?e.msecs:Date.now(),y=void 0!==e.nsecs?e.nsecs:p+1,h=f-u+(y-p)/1e4;if(h<0&&void 0===e.clockseq&&(d=d+1&16383),(h<0||f>u)&&void 0===e.nsecs&&(y=0),y>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");u=f,p=y,r=d;let m=((0xfffffff&(f+=122192928e5))*1e4+y)%0x100000000;s[i++]=m>>>24&255,s[i++]=m>>>16&255,s[i++]=m>>>8&255,s[i++]=255&m;let w=f/0x100000000*1e4&0xfffffff;s[i++]=w>>>8&255,s[i++]=255&w,s[i++]=w>>>24&15|16,s[i++]=w>>>16&255,s[i++]=d>>>8|128,s[i++]=255&d;for(let e=0;e<6;++e)s[i+e]=c[e];return a||l(s)},"v3",0,h,"v4",0,function(e,t,r){let a=(e=e||{}).random||(e.rng||o)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=a[e];return t}return l(a)},"v5",0,m,"validate",0,c,"version",0,function(e){if(!c(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}],79403)},47674,(e,t,r)=>{"use strict";function a(e,t,r){n(e,t),t.set(e,r)}function n(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function i(e,t){return e.get(s(e,t))}function o(e,t,r){return e.set(s(e,t),r),r}function s(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw TypeError("Private element is not present on this object")}Object.defineProperty(r,"__esModule",{value:!0}),r.SessionStore=void 0,r.defaultCookies=function(e){let t=e?"__Secure-":"";return{sessionToken:{name:`${t}next-auth.session-token`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},callbackUrl:{name:`${t}next-auth.callback-url`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},csrfToken:{name:`${e?"__Host-":""}next-auth.csrf-token`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},pkceCodeVerifier:{name:`${t}next-auth.pkce.code_verifier`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e,maxAge:900}},state:{name:`${t}next-auth.state`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e,maxAge:900}},nonce:{name:`${t}next-auth.nonce`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}}}};var c=new WeakMap,d=new WeakMap,l=new WeakMap,u=new WeakSet;function p(e){let t=Math.ceil(e.value.length/3933);if(1===t)return i(c,this)[e.name]=e.value,[e];let r=[];for(let a=0;a<t;a++){let t=`${e.name}.${a}`,n=e.value.substr(3933*a,3933);r.push({...e,name:t,value:n}),i(c,this)[t]=n}return i(l,this).debug("CHUNKING_SESSION_COOKIE",{message:"Session cookie exceeds allowed 4096 bytes.",emptyCookieSize:163,valueSize:e.value.length,chunks:r.map(e=>e.value.length+163)}),r}function f(){let e={};for(let r in i(c,this)){var t;null==(t=i(c,this))||delete t[r],e[r]={name:r,value:"",options:{...i(d,this).options,maxAge:0}}}return e}r.SessionStore=class{constructor(e,t,r){!function(e,t){n(e,t),t.add(e)}(this,u),a(this,c,{}),a(this,d,void 0),a(this,l,void 0),o(l,this,r),o(d,this,e);const{cookies:s}=t,{name:p}=e;if("function"==typeof(null==s?void 0:s.getAll))for(const{name:e,value:t}of s.getAll())e.startsWith(p)&&(i(c,this)[e]=t);else if(s instanceof Map)for(const e of s.keys())e.startsWith(p)&&(i(c,this)[e]=s.get(e));else for(const e in s)e.startsWith(p)&&(i(c,this)[e]=s[e])}get value(){return Object.keys(i(c,this)).sort((e,t)=>{var r,a;return parseInt(null!=(r=e.split(".").pop())?r:"0")-parseInt(null!=(a=t.split(".").pop())?a:"0")}).map(e=>i(c,this)[e]).join("")}chunk(e,t){let r=s(u,this,f).call(this);for(let a of s(u,this,p).call(this,{name:i(d,this).name,value:e,options:{...i(d,this).options,...t}}))r[a.name]=a;return Object.values(r)}clean(){return Object.values(s(u,this,f).call(this))}}},92594,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0})},63466,(e,t,r)=>{"use strict";var a=e.r(64348);Object.defineProperty(r,"__esModule",{value:!0});var n={encode:!0,decode:!0,getToken:!0};r.decode=u,r.encode=l,r.getToken=p;var i=e.r(43272),o=a(e.r(43581)),s=e.r(79403),c=e.r(47674),d=e.r(92594);async function l(e){let{token:t={},secret:r,maxAge:a=2592e3,salt:n=""}=e,o=await f(r,n);return await new i.EncryptJWT(t).setProtectedHeader({alg:"dir",enc:"A256GCM"}).setIssuedAt().setExpirationTime((Date.now()/1e3|0)+a).setJti((0,s.v4)()).encrypt(o)}async function u(e){let{token:t,secret:r,salt:a=""}=e;if(!t)return null;let n=await f(r,a),{payload:o}=await (0,i.jwtDecrypt)(t,n,{clockTolerance:15});return o}async function p(e){var t,r,a,n;let{req:i,secureCookie:o=null!=(t=null==(r=process.env.NEXTAUTH_URL)?void 0:r.startsWith("https://"))?t:!!process.env.VERCEL,cookieName:s=o?"__Secure-next-auth.session-token":"next-auth.session-token",raw:d,decode:l=u,logger:p=console,secret:f=null!=(a=process.env.NEXTAUTH_SECRET)?a:process.env.AUTH_SECRET}=e;if(!i)throw Error("Must pass `req` to JWT getToken()");let y=new c.SessionStore({name:s,options:{secure:o}},{cookies:i.cookies,headers:i.headers},p).value,h=i.headers instanceof Headers?i.headers.get("authorization"):null==(n=i.headers)?void 0:n.authorization;if(y||(null==h?void 0:h.split(" ")[0])!=="Bearer"||(y=decodeURIComponent(h.split(" ")[1])),!y)return null;if(d)return y;try{return await l({token:y,secret:f})}catch(e){return null}}async function f(e,t){return await (0,o.default)("sha256",e,t,`NextAuth.js Generated Encryption Key${t?` (${t})`:""}`,32)}Object.keys(d).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(n,e)||e in r&&r[e]===d[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return d[e]}})})}];

//# sourceMappingURL=%5Broot-of-the-server%5D__982b0fde._.js.map