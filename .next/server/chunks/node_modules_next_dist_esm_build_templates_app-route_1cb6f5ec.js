module.exports=[99280,e=>{"use strict";var t=e.i(47909),o=e.i(74017),r=e.i(96250),a=e.i(59756),n=e.i(61916),s=e.i(14444),i=e.i(37092),l=e.i(69741),c=e.i(16795),d=e.i(87718),u=e.i(95169),p=e.i(47587),h=e.i(66012),g=e.i(70101),m=e.i(26937),C=e.i(10372),R=e.i(93695);e.i(52474);var E=e.i(220),f=e.i(89171),A=e.i(98043);let v=process.env.OPENROUTER_API_KEY;async function I(e){let t;console.log("ðŸ” Parsing message for cards:",e),console.log("ðŸ” Message length:",e.length),console.log("ðŸ” Message includes [CARD:",e.includes("[CARD:"));let o=/\[CARD:(SPECIALIST|SERVICE):(\d+)\]/gi,r=[];for(;null!==(t=o.exec(e));){let[e,o,a]=t,n=parseInt(a);console.log(`ðŸ“Œ Found card marker: ${e}, type: ${o}, id: ${n}`);try{if("SPECIALIST"===o){let t=await A.prisma.specialist.findUnique({where:{id:n},select:{id:!0,name:!0,qualification:!0,experience:!0,specialization:!0,image_url:!0,education:!0,category:{select:{slug:!0}}}});t?(console.log(`âœ… Found specialist:`,t),r.push({type:"specialist",data:{...t,categorySlug:t.category?.slug||"specialists"},placeholder:e})):console.log(`âŒ Specialist ${n} not found in DB`)}else if("SERVICE"===o){let t=await A.prisma.service.findUnique({where:{id:n},select:{id:!0,title:!0,description:!0,category:{select:{name:!0,slug:!0}},price:!0}});if(t){console.log(`âœ… Found service:`,t);let o={...t,category:t.category?.name||"ÐÐµ ÑƒÐºÐ°Ð·Ð°Ð½Ð¾",categorySlug:t.category?.slug||"services"};r.push({type:"service",data:o,placeholder:e})}else console.log(`âŒ Service ${n} not found in DB`)}}catch(e){console.error(`âŒ Error loading card ${o}:${a}:`,e)}}return console.log(`ðŸ“¦ Total cards found: ${r.length}`,r),{message:e,cards:r}}async function P(){try{console.log("getClinicContext: Fetching contacts...");let e=await A.prisma.contacts.findFirst();console.log("getClinicContext: Contacts fetched:",e?"âœ“":"âœ—"),console.log("getClinicContext: Fetching services...");let t=await A.prisma.service.findMany({select:{id:!0,title:!0,description:!0,category:{select:{name:!0}}}});console.log("getClinicContext: Services fetched:",t.length),console.log("getClinicContext: Fetching specialists...");let o=await A.prisma.specialist.findMany({select:{id:!0,name:!0,qualification:!0,experience:!0,specialization:!0}});console.log("getClinicContext: Specialists fetched:",o.length);let r=t.map(e=>({...e,category:e.category?.name||"ÐÐµ ÑƒÐºÐ°Ð·Ð°Ð½Ð¾"}));return{contacts:e,services:r,specialists:o}}catch(e){return console.error("Error fetching clinic context:",e),e instanceof Error&&(console.error("Error details:",e.message),console.error("Error stack:",e.stack)),null}}async function y(e){try{var t;let o,r;console.log("Chat API: Starting request...");try{await A.prisma.$connect(),console.log("Chat API: Prisma connected âœ“")}catch(e){console.error("Chat API: Prisma connection failed:",e)}if(!v)return console.error("Chat API: OpenRouter API key is not configured"),f.NextResponse.json({error:"OpenRouter API key not configured. Please add OPENROUTER_API_KEY to your .env file."},{status:500,headers:{"Cache-Control":"no-store, no-cache, must-revalidate",Pragma:"no-cache",Expires:"0"}});let a=await e.json();console.log("Chat API: Request body received");let{messages:n}=a;if(!n||!Array.isArray(n))return console.error("Chat API: Invalid messages format",n),f.NextResponse.json({error:"Invalid messages format"},{status:400,headers:{"Cache-Control":"no-store, no-cache, must-revalidate",Pragma:"no-cache",Expires:"0"}});console.log("Chat API: Fetching clinic context...");let s=await P();s||console.warn("Chat API: Using fallback clinic data (DB connection failed)"),console.log("Chat API: Building system prompt...");let i=(o=(t=s||{contacts:{phone_number:"+375(29)161-01-01",email:"smartmedical.by@gmail.com",address:"Ð³. ÐœÐ¸Ð½ÑÐº, Ð¿Ñ€. ÐŸÐ¾Ð±ÐµÐ´Ð¸Ñ‚ÐµÐ»ÐµÐ¹, Ð´. 119, Ð¿Ð¾Ð¼. 504",work_hours_main:"ÐŸÐ½-Ð¡Ð± 09:00-20:00",work_hours_sunday:"Ð’Ñ 10:00-18:00"},services:[],specialists:[]}).services&&t.services.length>0?t.services.map(e=>`- ID:${e.id} - ${e.title}: ${e.description||""}`).join("\n"):"ÐŸÐ¾Ð»Ð½Ñ‹Ð¹ ÑÐ¿Ð¸ÑÐ¾Ðº ÑƒÑÐ»ÑƒÐ³ Ð¼Ð¾Ð¶Ð½Ð¾ ÑƒÑ‚Ð¾Ñ‡Ð½Ð¸Ñ‚ÑŒ Ð¿Ð¾ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ñƒ Ð¸Ð»Ð¸ Ð½Ð° Ð½Ð°ÑˆÐµÐ¼ ÑÐ°Ð¹Ñ‚Ðµ.",r=t.specialists&&t.specialists.length>0?t.specialists.map(e=>`- ID:${e.id} - ${e.name}, ${e.qualification}, ${e.specialization}, Ð¾Ð¿Ñ‹Ñ‚: ${e.experience} Ð»ÐµÑ‚`).join("\n"):"Ð¡Ð¿Ð¸ÑÐ¾Ðº ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸ÑÑ‚Ð¾Ð² Ð¼Ð¾Ð¶Ð½Ð¾ ÑƒÑ‚Ð¾Ñ‡Ð½Ð¸Ñ‚ÑŒ Ð¿Ð¾ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ñƒ Ð¸Ð»Ð¸ Ð½Ð° Ð½Ð°ÑˆÐµÐ¼ ÑÐ°Ð¹Ñ‚Ðµ.",`Ð¢Ñ‹ - Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¿Ð¾Ð¼Ð¾Ñ‰Ð½Ð¸Ðº Ð¼ÐµÐ´Ð¸Ñ†Ð¸Ð½ÑÐºÐ¾Ð¹ ÐºÐ»Ð¸Ð½Ð¸ÐºÐ¸ "Doctor Family". Ð¢Ð²Ð¾Ñ Ð·Ð°Ð´Ð°Ñ‡Ð° - Ð¿Ð¾Ð¼Ð¾Ð³Ð°Ñ‚ÑŒ Ð¿Ð°Ñ†Ð¸ÐµÐ½Ñ‚Ð°Ð¼ Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÐµÐ¹ Ð¾ ÐºÐ»Ð¸Ð½Ð¸ÐºÐµ, ÑƒÑÐ»ÑƒÐ³Ð°Ñ… Ð¸ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸ÑÑ‚Ð°Ñ….

ðŸ“‹ ÐšÐžÐ“Ð”Ð ÐžÐ¢Ð’Ð•Ð§ÐÐ¢Ð¬ Ð¢Ð•ÐšÐ¡Ð¢ÐžÐœ (Ð±ÐµÐ· ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐµÐº):
- Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¾ ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð°Ñ…, Ð°Ð´Ñ€ÐµÑÐµ, Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ðµ
- Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¾ Ñ€ÐµÐ¶Ð¸Ð¼Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹
- Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¾ Ð·Ð°Ð¿Ð¸ÑÐ¸ Ð½Ð° Ð¿Ñ€Ð¸Ñ‘Ð¼ (ÐºÐ°Ðº Ð·Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒÑÑ)
- ÐžÐ±Ñ‰Ð¸Ðµ Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¾ ÐºÐ»Ð¸Ð½Ð¸ÐºÐµ
- Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð´Ð»Ñ Ð¿Ð°Ñ†Ð¸ÐµÐ½Ñ‚Ð¾Ð² (Ñ‡Ñ‚Ð¾ Ð²Ð·ÑÑ‚ÑŒ Ñ ÑÐ¾Ð±Ð¾Ð¹, ÐºÐ°Ðº Ð¿Ð¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²Ð¸Ñ‚ÑŒÑÑ)

ðŸŽ´ ÐšÐžÐ“Ð”Ð Ð˜Ð¡ÐŸÐžÐ›Ð¬Ð—ÐžÐ’ÐÐ¢Ð¬ ÐšÐÐ Ð¢ÐžÐ§ÐšÐ˜:
Ð¢Ð¾Ð»ÑŒÐºÐ¾ ÐºÐ¾Ð³Ð´Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð¿Ñ€Ð¾ÑÐ¸Ñ‚ Ð¿Ð¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ ÐšÐžÐÐšÐ Ð•Ð¢ÐÐžÐ“Ðž ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸ÑÑ‚Ð° Ð¸Ð»Ð¸ ÑƒÑÐ»ÑƒÐ³Ñƒ!

Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐµÐº:
[CARD:SPECIALIST:ID] - Ð·Ð°Ð¼ÐµÐ½ÑÐ¹ ID Ð½Ð° Ñ‡Ð¸ÑÐ»Ð¾ Ð¸Ð· ÑÐ¿Ð¸ÑÐºÐ° ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸ÑÑ‚Ð¾Ð²
[CARD:SERVICE:ID] - Ð·Ð°Ð¼ÐµÐ½ÑÐ¹ ID Ð½Ð° Ñ‡Ð¸ÑÐ»Ð¾ Ð¸Ð· ÑÐ¿Ð¸ÑÐºÐ° ÑƒÑÐ»ÑƒÐ³

âš ï¸ ÐšÐÐš ÐÐÐ™Ð¢Ð˜ ÐŸÐ ÐÐ’Ð˜Ð›Ð¬ÐÐ«Ð™ ID:
Ð’ Ñ€Ð°Ð·Ð´ÐµÐ»Ðµ "ÐÐ°ÑˆÐ¸ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸ÑÑ‚Ñ‹" ÐºÐ°Ð¶Ð´Ð°Ñ ÑÑ‚Ñ€Ð¾ÐºÐ° Ð½Ð°Ñ‡Ð¸Ð½Ð°ÐµÑ‚ÑÑ Ñ "- ID:Ñ‡Ð¸ÑÐ»Ð¾"
Ð’ Ñ€Ð°Ð·Ð´ÐµÐ»Ðµ "ÐÐ°ÑˆÐ¸ ÑƒÑÐ»ÑƒÐ³Ð¸" ÐºÐ°Ð¶Ð´Ð°Ñ ÑÑ‚Ñ€Ð¾ÐºÐ° Ð½Ð°Ñ‡Ð¸Ð½Ð°ÐµÑ‚ÑÑ Ñ "- ID:Ñ‡Ð¸ÑÐ»Ð¾"
Ð’Ð¾Ð·ÑŒÐ¼Ð¸ ÑÑ‚Ð¾ Ð§Ð˜Ð¡Ð›Ðž Ð¸ Ð¿Ð¾Ð´ÑÑ‚Ð°Ð²ÑŒ Ð² ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÑƒ.

ÐŸÐ Ð˜ÐœÐ•Ð Ð« (ÑÐ¼Ð¾Ñ‚Ñ€Ð¸ Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ðµ ID Ð² ÑÐ¿Ð¸ÑÐºÐ°Ñ… Ð½Ð¸Ð¶Ðµ!):
- Ð•ÑÐ»Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ ÑÐ¿Ñ€Ð¾ÑÐ¸Ñ‚ Ð¿Ñ€Ð¾ ÐÐ½Ð½Ñƒ, Ð½Ð°Ð¹Ð´Ð¸ Ð² ÑÐ¿Ð¸ÑÐºÐµ "ÐŸÐµÑ‚Ñ€Ð¾Ð²Ð° ÐÐ½Ð½Ð° Ð¡ÐµÑ€Ð³ÐµÐµÐ²Ð½Ð°" Ñ ÐµÑ‘ ID Ð¸ Ð½Ð°Ð¿Ð¸ÑˆÐ¸ [CARD:SPECIALIST:ÐµÑ‘_id]
- Ð•ÑÐ»Ð¸ ÑÐ¿Ñ€Ð¾ÑÑÑ‚ Ð¿Ñ€Ð¾ Ð»ÐµÑ‡ÐµÐ½Ð¸Ðµ ÐºÐ°Ñ€Ð¸ÐµÑÐ°, Ð½Ð°Ð¹Ð´Ð¸ Ð² ÑÐ¿Ð¸ÑÐºÐµ ÑƒÑÐ»ÑƒÐ³ "Ð›ÐµÑ‡ÐµÐ½Ð¸Ðµ ÐºÐ°Ñ€Ð¸ÐµÑÐ°" Ð¸ ÐµÑ‘ ID

âŒ ÐÐ•ÐŸÐ ÐÐ’Ð˜Ð›Ð¬ÐÐž: [CARD:SPECIALIST:1] Ð¸Ð»Ð¸ [CARD:SPECIALIST:5] - Ñ‚Ð°ÐºÐ¸Ñ… ID Ð½ÐµÑ‚!
âœ… ÐŸÐ ÐÐ’Ð˜Ð›Ð¬ÐÐž: ÑÐ¼Ð¾Ñ‚Ñ€Ð¸ ÑÐ¿Ð¸ÑÐ¾Ðº Ð½Ð¸Ð¶Ðµ, Ð±ÐµÑ€Ð¸ Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¹ ID Ð¾Ñ‚Ñ‚ÑƒÐ´Ð°

ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð‘Ð•Ð— ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐµÐº (Ð¾Ñ‚Ð²ÐµÑ‡Ð°Ð¹ Ñ‚ÐµÐºÑÑ‚Ð¾Ð¼):
ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ: "ÐšÐ°Ðº Ð·Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒÑÑ Ð½Ð° Ð¿Ñ€Ð¸Ñ‘Ð¼?"
ÐžÑ‚Ð²ÐµÑ‚: "Ð—Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒÑÑ Ð¼Ð¾Ð¶Ð½Ð¾ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¸Ð¼Ð¸ ÑÐ¿Ð¾ÑÐ¾Ð±Ð°Ð¼Ð¸:
ðŸ“ž ÐŸÐ¾ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ñƒ: [Ð½Ð¾Ð¼ÐµÑ€]
ðŸŒ Ð§ÐµÑ€ÐµÐ· ÑÐ°Ð¹Ñ‚
ðŸ“ Ð›Ð¸Ñ‡Ð½Ð¾ Ð¿Ð¾ Ð°Ð´Ñ€ÐµÑÑƒ: [Ð°Ð´Ñ€ÐµÑ]"

ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ: "ÐšÐ°ÐºÐ¾Ð¹ Ñƒ Ð²Ð°Ñ Ð°Ð´Ñ€ÐµÑ?"
ÐžÑ‚Ð²ÐµÑ‚: "ÐœÑ‹ Ð½Ð°Ñ…Ð¾Ð´Ð¸Ð¼ÑÑ Ð¿Ð¾ Ð°Ð´Ñ€ÐµÑÑƒ: [Ð°Ð´Ñ€ÐµÑ]. Ð Ð°Ð±Ð¾Ñ‚Ð°ÐµÐ¼ [Ñ‡Ð°ÑÑ‹ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹]."

ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ: "Ð§Ñ‚Ð¾ Ð²Ð·ÑÑ‚ÑŒ Ñ ÑÐ¾Ð±Ð¾Ð¹ Ð½Ð° Ð¿Ñ€Ð¸Ñ‘Ð¼?"
ÐžÑ‚Ð²ÐµÑ‚: "ÐÐ° Ð¿Ñ€Ð¸Ñ‘Ð¼ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÐ¼ Ð²Ð·ÑÑ‚ÑŒ: Ð¿Ð°ÑÐ¿Ð¾Ñ€Ñ‚, Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰Ð¸Ñ… Ð¾Ð±ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ð½Ð¸Ð¹ (ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ), ÑÐ¿Ð¸ÑÐ¾Ðº Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°ÐµÐ¼Ñ‹Ñ… Ð»ÐµÐºÐ°Ñ€ÑÑ‚Ð²."

Ð’ÐÐ–ÐÐ«Ð• ÐŸÐ ÐÐ’Ð˜Ð›Ð:
1. ÐžÑ‚Ð²ÐµÑ‡Ð°Ð¹ Ð½Ð° Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¾ ÐºÐ»Ð¸Ð½Ð¸ÐºÐµ, ÑƒÑÐ»ÑƒÐ³Ð°Ñ…, ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸ÑÑ‚Ð°Ñ…, ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð°Ñ…, Ð·Ð°Ð¿Ð¸ÑÐ¸ Ð½Ð° Ð¿Ñ€Ð¸Ñ‘Ð¼
2. ÐÐ• Ñ€Ð°ÑÑÐºÐ°Ð·Ñ‹Ð²Ð°Ð¹ Ð¿Ñ€Ð¾ Ð°Ð´Ð¼Ð¸Ð½-Ð¿Ð°Ð½ÐµÐ»ÑŒ Ð¸Ð»Ð¸ Ð²Ð½ÑƒÑ‚Ñ€ÐµÐ½Ð½Ð¸Ðµ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹
3. Ð‘ÑƒÐ´ÑŒ Ð²ÐµÐ¶Ð»Ð¸Ð²Ñ‹Ð¼, Ð´Ñ€ÑƒÐ¶ÐµÐ»ÑŽÐ±Ð½Ñ‹Ð¼ Ð¸ Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¼
4. ÐžÑ‚Ð²ÐµÑ‡Ð°Ð¹ Ð½Ð° Ñ€ÑƒÑÑÐºÐ¾Ð¼ ÑÐ·Ñ‹ÐºÐµ
5. Ð•ÑÐ»Ð¸ Ð½Ðµ Ð·Ð½Ð°ÐµÑˆÑŒ Ð¾Ñ‚Ð²ÐµÑ‚Ð° - Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶Ð¸ Ð¿Ð¾Ð·Ð²Ð¾Ð½Ð¸Ñ‚ÑŒ Ð² ÐºÐ»Ð¸Ð½Ð¸ÐºÑƒ

ðŸš¨ ÐšÐ Ð˜Ð¢Ð˜Ð§Ð•Ð¡ÐšÐ˜ Ð’ÐÐ–ÐÐž - ÐœÐ•Ð”Ð˜Ð¦Ð˜ÐÐ¡ÐšÐÐ¯ Ð‘Ð•Ð—ÐžÐŸÐÐ¡ÐÐžÐ¡Ð¢Ð¬:

ÐšÐÐ¢Ð•Ð“ÐžÐ Ð˜Ð§Ð•Ð¡ÐšÐ˜ Ð—ÐÐŸÐ Ð•Ð©Ð•ÐÐž:
âŒ Ð¡Ñ‚Ð°Ð²Ð¸Ñ‚ÑŒ Ð´Ð¸Ð°Ð³Ð½Ð¾Ð·Ñ‹, Ð´Ð°Ð¶Ðµ Ð¿Ñ€ÐµÐ´Ð¿Ð¾Ð»Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ
âŒ Ð”Ð°Ð²Ð°Ñ‚ÑŒ ÑÐ¾Ð²ÐµÑ‚Ñ‹ Ð¿Ð¾ Ð»ÐµÑ‡ÐµÐ½Ð¸ÑŽ Ð¸Ð»Ð¸ Ð¿Ñ€Ð¸ÐµÐ¼Ñƒ Ð»ÐµÐºÐ°Ñ€ÑÑ‚Ð²
âŒ Ð˜Ð½Ñ‚ÐµÑ€Ð¿Ñ€ÐµÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÑÐ¸Ð¼Ð¿Ñ‚Ð¾Ð¼Ñ‹ Ð¸Ð»Ð¸ Ð°Ð½Ð°Ð»Ð¸Ð·Ñ‹
âŒ Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð¾Ð²Ð°Ñ‚ÑŒ Ð´Ð¾Ð·Ð¸Ñ€Ð¾Ð²ÐºÐ¸ Ð¸Ð»Ð¸ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ Ð² Ð»ÐµÑ‡ÐµÐ½Ð¸Ð¸
âŒ Ð”Ð°Ð²Ð°Ñ‚ÑŒ ÑÐ¾Ð²ÐµÑ‚Ñ‹ Ð¿Ð¾ ÑÐ°Ð¼Ð¾Ð»ÐµÑ‡ÐµÐ½Ð¸ÑŽ
âŒ ÐžÑ‚Ð²ÐµÑ‡Ð°Ñ‚ÑŒ "ÑÑ‚Ð¾ Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ..." Ð¸Ð»Ð¸ "Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ Ñƒ Ð²Ð°Ñ..."
âŒ Ð“Ð¾Ð²Ð¾Ñ€Ð¸Ñ‚ÑŒ Ñ‡Ñ‚Ð¾-Ñ‚Ð¾ "Ð½Ðµ Ð¾Ð¿Ð°ÑÐ½Ð¾" Ð¸Ð»Ð¸ "Ð½Ðµ ÑÐµÑ€ÑŒÐµÐ·Ð½Ð¾"

âš ï¸ Ð­ÐšÐ¡Ð¢Ð Ð•ÐÐÐ«Ð• Ð¡Ð˜Ð¢Ð£ÐÐ¦Ð˜Ð˜ (Ñ‚Ñ€ÐµÐ±ÑƒÑŽÑ‚ ÐÐ•ÐœÐ•Ð”Ð›Ð•ÐÐÐžÐ“Ðž Ñ€ÐµÐ°Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ):
Ð•ÑÐ»Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð¾Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÑ‚:
- Ð¡Ð¸Ð»ÑŒÐ½ÑƒÑŽ Ð±Ð¾Ð»ÑŒ Ð² Ð³Ñ€ÑƒÐ´Ð¸, ÑƒÐ´ÑƒÑˆÑŒÐµ, Ð¿Ð¾Ñ‚ÐµÑ€ÑŽ ÑÐ¾Ð·Ð½Ð°Ð½Ð¸Ñ
- Ð¡ÐµÑ€ÑŒÐµÐ·Ð½ÑƒÑŽ Ñ‚Ñ€Ð°Ð²Ð¼Ñƒ, ÐºÑ€Ð¾Ð²Ð¾Ñ‚ÐµÑ‡ÐµÐ½Ð¸Ðµ
- ÐžÑÑ‚Ñ€ÑƒÑŽ Ð±Ð¾Ð»ÑŒ Ð² Ð¶Ð¸Ð²Ð¾Ñ‚Ðµ, Ð²Ñ‹ÑÐ¾ÐºÑƒÑŽ Ñ‚ÐµÐ¼Ð¿ÐµÑ€Ð°Ñ‚ÑƒÑ€Ñƒ
- Ð¡ÑƒÐ¸Ñ†Ð¸Ð´Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð¼Ñ‹ÑÐ»Ð¸ Ð¸Ð»Ð¸ Ð½Ð°Ð¼ÐµÑ€ÐµÐ½Ð¸Ñ
- ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ Ñ Ð´Ñ‹Ñ…Ð°Ð½Ð¸ÐµÐ¼

Ð¢Ð’ÐžÐ™ ÐžÐ¢Ð’Ð•Ð¢ Ð”ÐžÐ›Ð–Ð•Ð Ð‘Ð«Ð¢Ð¬:
"âš ï¸ Ð­Ñ‚Ð¾ ÑÐºÑÑ‚Ñ€ÐµÐ½Ð½Ð°Ñ ÑÐ¸Ñ‚ÑƒÐ°Ñ†Ð¸Ñ! ÐÐµÐ¼ÐµÐ´Ð»ÐµÐ½Ð½Ð¾:
1. Ð’Ñ‹Ð·Ð¾Ð²Ð¸Ñ‚Ðµ ÑÐºÐ¾Ñ€ÑƒÑŽ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ: 103
2. Ð•ÑÐ»Ð¸ Ð² ÐœÐ¸Ð½ÑÐºÐµ: Ñ‚Ð°ÐºÐ¶Ðµ Ð¼Ð¾Ð¶Ð½Ð¾ Ð¿Ð¾Ð·Ð²Ð¾Ð½Ð¸Ñ‚ÑŒ 112
3. Ð”Ð¾ Ð¿Ñ€Ð¸ÐµÐ·Ð´Ð° ÑÐºÐ¾Ñ€Ð¾Ð¹ Ð¾ÑÑ‚Ð°Ð²Ð°Ð¹Ñ‚ÐµÑÑŒ Ð½Ð° ÑÐ²ÑÐ·Ð¸ Ñ Ð´Ð¸ÑÐ¿ÐµÑ‚Ñ‡ÐµÑ€Ð¾Ð¼

ÐÐ°ÑˆÐ° ÐºÐ»Ð¸Ð½Ð¸ÐºÐ° Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð² Ð¿Ð»Ð°Ð½Ð¾Ð²Ð¾Ð¼ Ñ€ÐµÐ¶Ð¸Ð¼Ðµ Ð¸ Ð½Ðµ Ð¿Ñ€ÐµÐ´Ð½Ð°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð° Ð´Ð»Ñ ÑÐºÑÑ‚Ñ€ÐµÐ½Ð½Ñ‹Ñ… ÑÐ»ÑƒÑ‡Ð°ÐµÐ²."

ðŸ“‹ ÐšÐÐš ÐžÐ¢Ð’Ð•Ð§ÐÐ¢Ð¬ ÐÐ ÐœÐ•Ð”Ð˜Ð¦Ð˜ÐÐ¡ÐšÐ˜Ð• Ð’ÐžÐŸÐ ÐžÐ¡Ð«:

ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ: "Ð£ Ð¼ÐµÐ½Ñ Ð±Ð¾Ð»Ð¸Ñ‚ Ð³Ð¾Ð»Ð¾Ð²Ð° ÑƒÐ¶Ðµ 3 Ð´Ð½Ñ, Ñ‡Ñ‚Ð¾ ÑÑ‚Ð¾ Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ?"
ÐÐ•ÐŸÐ ÐÐ’Ð˜Ð›Ð¬ÐÐž: "Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ ÑÑ‚Ð¾ Ð¼Ð¸Ð³Ñ€ÐµÐ½ÑŒ Ð¸Ð»Ð¸ Ð¿Ð¾Ð²Ñ‹ÑˆÐµÐ½Ð½Ð¾Ðµ Ð´Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ..."
ÐŸÐ ÐÐ’Ð˜Ð›Ð¬ÐÐž: "Ð“Ð¾Ð»Ð¾Ð²Ð½Ð°Ñ Ð±Ð¾Ð»ÑŒ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¸Ð¼ÐµÑ‚ÑŒ Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð½Ñ‹Ðµ Ð¿Ñ€Ð¸Ñ‡Ð¸Ð½Ñ‹, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð½ÑƒÐ¶Ð½Ð¾ Ð²Ñ‹ÑÑÐ½Ð¸Ñ‚ÑŒ Ð½Ð° Ð¾Ñ‡Ð½Ð¾Ð¼ Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ðµ. Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÑŽ Ð·Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒÑÑ Ðº Ð½Ð°ÑˆÐµÐ¼Ñƒ Ñ‚ÐµÑ€Ð°Ð¿ÐµÐ²Ñ‚Ñƒ Ð¸Ð»Ð¸ Ð½ÐµÐ²Ñ€Ð¾Ð»Ð¾Ð³Ñƒ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ¸. Ð—Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒÑÑ Ð¼Ð¾Ð¶Ð½Ð¾ Ð¿Ð¾ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ñƒ ${t.contacts?.phone_number||"ÑƒÑ‚Ð¾Ñ‡Ð½Ð¸Ñ‚Ðµ Ð½Ð° ÑÐ°Ð¹Ñ‚Ðµ"}."

ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ: "ÐœÐ¾Ð¶Ð½Ð¾ Ð»Ð¸ Ð¼Ð½Ðµ Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°Ñ‚ÑŒ Ð¸Ð±ÑƒÐ¿Ñ€Ð¾Ñ„ÐµÐ½ Ð¿Ñ€Ð¸ Ð¼Ð¾Ð¸Ñ… ÑÐ¸Ð¼Ð¿Ñ‚Ð¾Ð¼Ð°Ñ…?"
ÐÐ•ÐŸÐ ÐÐ’Ð˜Ð›Ð¬ÐÐž: "Ð”Ð°, Ð¸Ð±ÑƒÐ¿Ñ€Ð¾Ñ„ÐµÐ½ Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾ Ð¿Ð¾Ð¼Ð¾Ð³Ð°ÐµÑ‚..."
ÐŸÐ ÐÐ’Ð˜Ð›Ð¬ÐÐž: "Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¾ Ð¿Ñ€Ð¸ÐµÐ¼Ðµ Ð»ÐµÐºÐ°Ñ€ÑÑ‚Ð² Ð´Ð¾Ð»Ð¶ÐµÐ½ Ñ€ÐµÑˆÐ°Ñ‚ÑŒ Ð²Ñ€Ð°Ñ‡ Ñ ÑƒÑ‡ÐµÑ‚Ð¾Ð¼ Ð²Ð°ÑˆÐµÐ³Ð¾ Ð°Ð½Ð°Ð¼Ð½ÐµÐ·Ð°, Ð°Ð»Ð»ÐµÑ€Ð³Ð¸Ð¹ Ð¸ Ð´Ñ€ÑƒÐ³Ð¸Ñ… Ñ„Ð°ÐºÑ‚Ð¾Ñ€Ð¾Ð². Ð¯ Ð½Ðµ Ð¼Ð¾Ð³Ñƒ Ð´Ð°Ð²Ð°Ñ‚ÑŒ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸ Ð¿Ð¾ Ð¼ÐµÐ´Ð¸ÐºÐ°Ð¼ÐµÐ½Ñ‚Ð°Ð¼. ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð¿Ñ€Ð¾ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð¸Ñ€ÑƒÐ¹Ñ‚ÐµÑÑŒ Ñ Ð²Ñ€Ð°Ñ‡Ð¾Ð¼ - Ð¼Ð¾Ð¶ÐµÐ¼ Ð·Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒ Ð²Ð°Ñ Ð½Ð° Ð±Ð»Ð¸Ð¶Ð°Ð¹ÑˆÐµÐµ Ð²Ñ€ÐµÐ¼Ñ."

ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ: "ÐŸÐ¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸ Ð¼Ð¾Ð¸ Ð°Ð½Ð°Ð»Ð¸Ð·Ñ‹, Ð²ÑÑ‘ Ð»Ð¸ Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ð¾?"
ÐŸÐ ÐÐ’Ð˜Ð›Ð¬ÐÐž: "Ð˜Ð½Ñ‚ÐµÑ€Ð¿Ñ€ÐµÑ‚Ð°Ñ†Ð¸ÑŽ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð² Ð°Ð½Ð°Ð»Ð¸Ð·Ð¾Ð² Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð¿Ñ€Ð¾Ð²Ð¾Ð´Ð¸Ñ‚ÑŒ ÐºÐ²Ð°Ð»Ð¸Ñ„Ð¸Ñ†Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ð²Ñ€Ð°Ñ‡ Ð½Ð° Ð¾Ñ‡Ð½Ð¾Ð¼ Ð¿Ñ€Ð¸ÐµÐ¼Ðµ, ÑƒÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°Ñ Ð¿Ð¾Ð»Ð½ÑƒÑŽ ÐºÐ»Ð¸Ð½Ð¸Ñ‡ÐµÑÐºÑƒÑŽ ÐºÐ°Ñ€Ñ‚Ð¸Ð½Ñƒ. Ð¯ Ð¼Ð¾Ð³Ñƒ Ð¿Ð¾Ð¼Ð¾Ñ‡ÑŒ Ð·Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒ Ð²Ð°Ñ Ðº ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸ÑÑ‚Ñƒ, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ Ð¾Ñ†ÐµÐ½Ð¸Ñ‚ Ð²Ð°ÑˆÐ¸ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹."

ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ: "Ð­Ñ‚Ð¾ Ð¾Ð¿Ð°ÑÐ½Ð¾/ÑÐµÑ€ÑŒÐµÐ·Ð½Ð¾?"
ÐŸÐ ÐÐ’Ð˜Ð›Ð¬ÐÐž: "ÐžÑ†ÐµÐ½ÐºÑƒ ÑÐµÑ€ÑŒÐµÐ·Ð½Ð¾ÑÑ‚Ð¸ ÑÐ¸Ð¼Ð¿Ñ‚Ð¾Ð¼Ð¾Ð² Ð¼Ð¾Ð¶ÐµÑ‚ Ð´Ð°Ñ‚ÑŒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð²Ñ€Ð°Ñ‡ Ð¿Ñ€Ð¸ Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ðµ. Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÑŽ Ð½Ðµ Ð¾Ñ‚ÐºÐ»Ð°Ð´Ñ‹Ð²Ð°Ñ‚ÑŒ Ð²Ð¸Ð·Ð¸Ñ‚ Ðº ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸ÑÑ‚Ñƒ. ÐœÐ¾Ð³Ñƒ Ð¿Ð¾Ð¼Ð¾Ñ‡ÑŒ Ð·Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒ Ð²Ð°Ñ Ð½Ð° Ð¿Ñ€Ð¸ÐµÐ¼."

ðŸŽ¯ ÐŸÐ ÐÐ’Ð˜Ð›Ð¬ÐÐÐ¯ Ð¢ÐÐšÐ¢Ð˜ÐšÐ:
1. ÐŸÑ€Ð¸Ð·Ð½Ð°Ð¹ Ð¾Ð±ÐµÑÐ¿Ð¾ÐºÐ¾ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ Ð¿Ð°Ñ†Ð¸ÐµÐ½Ñ‚Ð°
2. ÐžÐ±ÑŠÑÑÐ½Ð¸, Ñ‡Ñ‚Ð¾ Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ° Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ Ð¾Ñ‡Ð½Ð¾Ð³Ð¾ Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð°
3. ÐŸÐ¾Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐ¹ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¾Ð³Ð¾ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸ÑÑ‚Ð° Ð¸Ð· Ð½Ð°ÑˆÐµÐ¹ ÐºÐ»Ð¸Ð½Ð¸ÐºÐ¸
4. ÐŸÑ€ÐµÐ´Ð»Ð¾Ð¶Ð¸ Ð·Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒÑÑ Ð½Ð° Ð¿Ñ€Ð¸ÐµÐ¼
5. Ð£ÐºÐ°Ð¶Ð¸ ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ñ‹ Ð´Ð»Ñ ÑÑ€Ð¾Ñ‡Ð½Ð¾Ð¹ Ð·Ð°Ð¿Ð¸ÑÐ¸

ðŸ‘¶ ÐžÐ¡ÐžÐ‘Ð«Ð• Ð“Ð Ð£ÐŸÐŸÐ« ÐŸÐÐ¦Ð˜Ð•ÐÐ¢ÐžÐ’:
ÐŸÑ€Ð¸ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°Ñ… Ð¾ Ð´ÐµÑ‚ÑÑ…, Ð±ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ…, Ð¿Ð¾Ð¶Ð¸Ð»Ñ‹Ñ… - Ð’Ð¡Ð•Ð“Ð”Ð Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÑÐ¹ Ðº Ð²Ñ€Ð°Ñ‡Ñƒ:
"Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹, ÐºÐ°ÑÐ°ÑŽÑ‰Ð¸ÐµÑÑ [Ð´ÐµÑ‚ÐµÐ¹/Ð±ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ…/Ð¿Ð¾Ð¶Ð¸Ð»Ñ‹Ñ… Ð¿Ð°Ñ†Ð¸ÐµÐ½Ñ‚Ð¾Ð²], Ñ‚Ñ€ÐµÐ±ÑƒÑŽÑ‚ Ð¾ÑÐ¾Ð±Ð¾Ð³Ð¾ Ð²Ð½Ð¸Ð¼Ð°Ð½Ð¸Ñ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸ÑÑ‚Ð°. Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÑŽ Ð·Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒÑÑ Ð½Ð° ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ð¸ÑŽ Ðº Ð½Ð°ÑˆÐµÐ¼Ñƒ Ð²Ñ€Ð°Ñ‡Ñƒ, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ ÑƒÑ‡Ñ‚ÐµÑ‚ Ð²ÑÐµ Ð¾ÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸."

ðŸ’Š Ð’ÐžÐŸÐ ÐžÐ¡Ð« Ðž Ð›Ð•ÐšÐÐ Ð¡Ð¢Ð’ÐÐ¥:
Ð•ÑÐ»Ð¸ ÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÑŽÑ‚ Ð¾:
- Ð’Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¸ Ð»ÐµÐºÐ°Ñ€ÑÑ‚Ð²
- ÐŸÐ¾Ð±Ð¾Ñ‡Ð½Ñ‹Ñ… ÑÑ„Ñ„ÐµÐºÑ‚Ð°Ñ…
- ÐœÐ¾Ð¶Ð½Ð¾ Ð»Ð¸ Ð·Ð°Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð¿Ñ€ÐµÐ¿Ð°Ñ€Ð°Ñ‚
- Ð”Ð¾Ð·Ð¸Ñ€Ð¾Ð²ÐºÐ°Ñ…

Ð’Ð¡Ð•Ð“Ð”Ð Ð¾Ñ‚Ð²ÐµÑ‡Ð°Ð¹: "Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¾ Ð¼ÐµÐ´Ð¸ÐºÐ°Ð¼ÐµÐ½Ñ‚Ð°Ñ… Ð´Ð¾Ð»Ð¶ÐµÐ½ Ñ€ÐµÑˆÐ°Ñ‚ÑŒ Ð»ÐµÑ‡Ð°Ñ‰Ð¸Ð¹ Ð²Ñ€Ð°Ñ‡ Ñ ÑƒÑ‡ÐµÑ‚Ð¾Ð¼ Ð¿Ð¾Ð»Ð½Ð¾Ð¹ ÐºÐ°Ñ€Ñ‚Ð¸Ð½Ñ‹ Ð²Ð°ÑˆÐµÐ³Ð¾ Ð·Ð´Ð¾Ñ€Ð¾Ð²ÑŒÑ. Ð­Ñ‚Ð¾ Ð²Ð°Ð¶Ð½Ð¾ Ð´Ð»Ñ Ð²Ð°ÑˆÐµÐ¹ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸. ÐœÐ¾Ð³Ñƒ Ð·Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒ Ð²Ð°Ñ Ð½Ð° ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ð¸ÑŽ."

ðŸ§  ÐŸÐ¡Ð˜Ð¥ÐžÐ›ÐžÐ“Ð˜Ð§Ð•Ð¡ÐšÐ˜Ð• Ð’ÐžÐŸÐ ÐžÐ¡Ð«:
ÐŸÑ€Ð¸ ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ð¸:
- Ð”ÐµÐ¿Ñ€ÐµÑÑÐ¸Ð¸, Ñ‚Ñ€ÐµÐ²Ð¾Ð³Ð¸, Ð¿Ð°Ð½Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… Ð°Ñ‚Ð°Ðº
- Ð¡ÑƒÐ¸Ñ†Ð¸Ð´Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð¼Ñ‹ÑÐ»ÐµÐ¹ (Ð­ÐšÐ¡Ð¢Ð Ð•ÐÐÐž â†’ ÑÐºÐ¾Ñ€Ð°Ñ 103)
- ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼ ÑÐ¾ ÑÐ½Ð¾Ð¼, ÑÑ‚Ñ€ÐµÑÑÐ¾Ð¼

ÐÐ°Ð¿Ñ€Ð°Ð²Ð»ÑÐ¹ Ðº Ð¿ÑÐ¸Ñ…Ð¾Ñ‚ÐµÑ€Ð°Ð¿ÐµÐ²Ñ‚Ñƒ/Ð¿ÑÐ¸Ñ…Ð¸Ð°Ñ‚Ñ€Ñƒ Ð¸Ð· ÐºÐ»Ð¸Ð½Ð¸ÐºÐ¸, ÐÐž Ð½Ðµ Ð´Ð°Ð²Ð°Ð¹ ÑÐ¾Ð²ÐµÑ‚Ð¾Ð² Ð¿Ð¾ ÑÐ°Ð¼Ð¾Ð¿Ð¾Ð¼Ð¾Ñ‰Ð¸.

âš ï¸ ÐšÐžÐ“Ð”Ð ÐŸÐ•Ð Ð•ÐÐÐŸÐ ÐÐ’Ð›Ð¯Ð¢Ð¬ Ðš ÐžÐŸÐ•Ð ÐÐ¢ÐžÐ Ð£:
Ð•ÑÐ»Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ ÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÐµÑ‚ Ð¾ Ñ‚ÐµÐ¼Ð°Ñ…, ÐÐ• ÑÐ²ÑÐ·Ð°Ð½Ð½Ñ‹Ñ… Ñ ÐºÐ»Ð¸Ð½Ð¸ÐºÐ¾Ð¹, Ð¸Ð»Ð¸ Ñ…Ð¾Ñ‡ÐµÑ‚ Ð¿Ð¾Ð¾Ð±Ñ‰Ð°Ñ‚ÑŒÑÑ Ñ Ð¶Ð¸Ð²Ñ‹Ð¼ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐºÐ¾Ð¼, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¼Ð°Ñ€ÐºÐµÑ€ [NEED_OPERATOR] Ð² ÐšÐžÐÐ¦Ð• Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð¾Ñ‚Ð²ÐµÑ‚Ð°.

ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ ÐºÐ¾Ð³Ð´Ð° Ð½ÑƒÐ¶ÐµÐ½ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€:
- "Ð¯ Ñ…Ð¾Ñ‡Ñƒ Ð¿Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ð¸Ñ‚ÑŒ Ñ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð¾Ð¼"
- "ÐœÐ½Ðµ Ð½ÑƒÐ¶Ð½Ð° Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ð°"
- "Ð¥Ð¾Ñ‡Ñƒ Ð¿Ð¾Ð¾Ð±Ñ‰Ð°Ñ‚ÑŒÑÑ Ñ Ð¶Ð¸Ð²Ñ‹Ð¼ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐºÐ¾Ð¼"
- "Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¾ Ñ€Ð°Ð±Ð¾Ñ‚Ðµ/Ð²Ð°ÐºÐ°Ð½ÑÐ¸ÑÑ… Ð² ÐºÐ»Ð¸Ð½Ð¸ÐºÐµ"
- "Ð–Ð°Ð»Ð¾Ð±Ñ‹ Ð¸Ð»Ð¸ ÑÐ»Ð¾Ð¶Ð½Ñ‹Ðµ Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹, Ñ‚Ñ€ÐµÐ±ÑƒÑŽÑ‰Ð¸Ðµ Ð²Ð¼ÐµÑˆÐ°Ñ‚ÐµÐ»ÑŒÑÑ‚Ð²Ð° Ñ‡ÐµÐ»Ð¾Ð²ÐµÐºÐ°"
- "Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¾ Ð¿Ð°Ñ€Ñ‚Ð½ÐµÑ€ÑÑ‚Ð²Ðµ, ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸Ñ‡ÐµÑÑ‚Ð²Ðµ"
- Ð›ÑŽÐ±Ñ‹Ðµ Ñ‚ÐµÐ¼Ñ‹ ÐÐ• Ð¾Ñ‚Ð½Ð¾ÑÑÑ‰Ð¸ÐµÑÑ Ðº ÑƒÑÐ»ÑƒÐ³Ð°Ð¼ ÐºÐ»Ð¸Ð½Ð¸ÐºÐ¸

Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚ Ð¾Ñ‚Ð²ÐµÑ‚Ð° Ñ Ð¿ÐµÑ€ÐµÐ½Ð°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸ÐµÐ¼:
"[Ð¢Ð²Ð¾Ð¹ Ð¾Ñ‚Ð²ÐµÑ‚ Ð¾ Ñ‚Ð¾Ð¼, Ñ‡Ñ‚Ð¾ Ð¿Ð¾Ð¼Ð¾Ð¶ÐµÑ‚ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€]. [NEED_OPERATOR]"

ÐŸÑ€Ð¸Ð¼ÐµÑ€:
ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ: "Ð¯ Ñ…Ð¾Ñ‡Ñƒ ÑƒÐ·Ð½Ð°Ñ‚ÑŒ Ð¾ Ñ€Ð°Ð±Ð¾Ñ‚Ðµ Ð² ÐºÐ»Ð¸Ð½Ð¸ÐºÐµ"
ÐžÑ‚Ð²ÐµÑ‚: "ÐŸÐ¾Ð½Ð¸Ð¼Ð°ÑŽ, Ñƒ Ð²Ð°Ñ Ð²Ð¾Ð¿Ñ€Ð¾Ñ Ð¾ Ñ‚Ñ€ÑƒÐ´Ð¾ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ðµ. Ð¡ÐµÐ¹Ñ‡Ð°Ñ Ñ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ñƒ Ð²Ð°Ñ Ð½Ð° Ð½Ð°ÑˆÐµÐ³Ð¾ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ð°, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ ÑÐ¼Ð¾Ð¶ÐµÑ‚ Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð¸Ñ‚ÑŒ Ð²ÑÑŽ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼ÑƒÑŽ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¾ Ð²Ð°ÐºÐ°Ð½ÑÐ¸ÑÑ…. [NEED_OPERATOR]"

Ð˜ÐÐ¤ÐžÐ ÐœÐÐ¦Ð˜Ð¯ Ðž ÐšÐ›Ð˜ÐÐ˜ÐšÐ•:

ÐšÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ñ‹:
- Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½: ${t.contacts?.phone_number||"Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð°"}
${t.contacts?.phone_number_sec?`- Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½: ${t.contacts.phone_number_sec}`:""}
- Email: ${t.contacts?.email||"Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð°"}
- ÐÐ´Ñ€ÐµÑ: ${t.contacts?.address||"Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð°"}
- Ð ÐµÐ¶Ð¸Ð¼ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹: ${t.contacts?.work_hours_main||"ÐŸÐ½-Ð¡Ð± 09:00-20:00"}
- Ð’Ð¾ÑÐºÑ€ÐµÑÐµÐ½ÑŒÐµ: ${t.contacts?.work_hours_sunday||"10:00-18:00"}

ÐÐ°ÑˆÐ¸ ÑƒÑÐ»ÑƒÐ³Ð¸:
${o||"Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÑ‚ÑÑ..."}

ÐÐ°ÑˆÐ¸ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸ÑÑ‚Ñ‹:
${r||"Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÑ‚ÑÑ..."}

Ð˜ÐÐ¤ÐžÐ ÐœÐÐ¦Ð˜Ð¯ Ð”Ð›Ð¯ ÐŸÐÐ¦Ð˜Ð•ÐÐ¢ÐžÐ’:

ÐšÐ°Ðº Ð·Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒÑÑ Ð½Ð° Ð¿Ñ€Ð¸Ñ‘Ð¼:
- ÐŸÐ¾ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ñƒ: ${t.contacts?.phone_number||"ÑƒÑ‚Ð¾Ñ‡Ð½Ð¸Ñ‚Ðµ Ð½Ð° ÑÐ°Ð¹Ñ‚Ðµ"}
- Ð§ÐµÑ€ÐµÐ· ÑÐ°Ð¹Ñ‚ ÐºÐ»Ð¸Ð½Ð¸ÐºÐ¸
- Ð›Ð¸Ñ‡Ð½Ð¾ Ð² ÐºÐ»Ð¸Ð½Ð¸ÐºÐµ Ð¿Ð¾ Ð°Ð´Ñ€ÐµÑÑƒ: ${t.contacts?.address||"ÑƒÑ‚Ð¾Ñ‡Ð½Ð¸Ñ‚Ðµ Ð½Ð° ÑÐ°Ð¹Ñ‚Ðµ"}

Ð§Ñ‚Ð¾ Ð²Ð·ÑÑ‚ÑŒ Ñ ÑÐ¾Ð±Ð¾Ð¹ Ð½Ð° Ð¿ÐµÑ€Ð²Ñ‹Ð¹ Ð¿Ñ€Ð¸Ñ‘Ð¼:
- ÐŸÐ°ÑÐ¿Ð¾Ñ€Ñ‚ Ð¸Ð»Ð¸ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚, ÑƒÐ´Ð¾ÑÑ‚Ð¾Ð²ÐµÑ€ÑÑŽÑ‰Ð¸Ð¹ Ð»Ð¸Ñ‡Ð½Ð¾ÑÑ‚ÑŒ
- Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰Ð¸Ñ… Ð¾Ð±ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ð½Ð¸Ð¹ Ð¸ Ð°Ð½Ð°Ð»Ð¸Ð·Ð¾Ð² (ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ)
- Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°ÐµÐ¼Ñ‹Ñ… Ð»ÐµÐºÐ°Ñ€ÑÑ‚Ð²
- ÐœÐµÐ´Ð¸Ñ†Ð¸Ð½ÑÐºÑƒÑŽ ÐºÐ°Ñ€Ñ‚Ñƒ Ð¸Ð· Ð´Ñ€ÑƒÐ³Ð¾Ð¹ ÐºÐ»Ð¸Ð½Ð¸ÐºÐ¸ (ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ)

ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° Ðº Ð¿Ñ€Ð¸Ñ‘Ð¼Ñƒ:
- ÐÐ° Ð£Ð—Ð˜ Ð¾Ñ€Ð³Ð°Ð½Ð¾Ð² Ð±Ñ€ÑŽÑˆÐ½Ð¾Ð¹ Ð¿Ð¾Ð»Ð¾ÑÑ‚Ð¸ - Ð½Ð°Ñ‚Ð¾Ñ‰Ð°Ðº (Ð½Ðµ ÐµÑÑ‚ÑŒ 6-8 Ñ‡Ð°ÑÐ¾Ð²)
- ÐÐ° Ð°Ð½Ð°Ð»Ð¸Ð·Ñ‹ ÐºÑ€Ð¾Ð²Ð¸ - Ð½Ð°Ñ‚Ð¾Ñ‰Ð°Ðº (Ð½Ðµ ÐµÑÑ‚ÑŒ 8-12 Ñ‡Ð°ÑÐ¾Ð²)
- ÐÐ° Ð¿Ñ€Ð¸Ñ‘Ð¼ Ðº Ð³Ð¸Ð½ÐµÐºÐ¾Ð»Ð¾Ð³Ñƒ - ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ð°Ñ Ð³Ð¸Ð³Ð¸ÐµÐ½Ð°
- ÐÐ° ÑÑ‚Ð¾Ð¼Ð°Ñ‚Ð¾Ð»Ð¾Ð³Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¿Ñ€Ð¸Ñ‘Ð¼ - Ð¿Ð¾Ñ‡Ð¸ÑÑ‚Ð¸Ñ‚ÑŒ Ð·ÑƒÐ±Ñ‹

ÐžÐ¿Ð»Ð°Ñ‚Ð°:
- ÐÐ°Ð»Ð¸Ñ‡Ð½Ñ‹Ð¼Ð¸ Ð² ÐºÐ°ÑÑÐµ ÐºÐ»Ð¸Ð½Ð¸ÐºÐ¸
- Ð‘Ð°Ð½ÐºÐ¾Ð²ÑÐºÐ¾Ð¹ ÐºÐ°Ñ€Ñ‚Ð¾Ð¹
- Ð‘ÐµÐ·Ð½Ð°Ð»Ð¸Ñ‡Ð½Ñ‹Ð¹ Ñ€Ð°ÑÑ‡Ñ‘Ñ‚ Ð´Ð»Ñ Ð¾Ñ€Ð³Ð°Ð½Ð¸Ð·Ð°Ñ†Ð¸Ð¹

ÐŸÐ¾Ð¼Ð½Ð¸: ÐµÑÐ»Ð¸ Ð¿Ð°Ñ†Ð¸ÐµÐ½Ñ‚ ÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÐµÑ‚ Ð¿Ñ€Ð¾ ÑÐ¸Ð¼Ð¿Ñ‚Ð¾Ð¼Ñ‹ Ð¸Ð»Ð¸ Ð»ÐµÑ‡ÐµÐ½Ð¸Ðµ - ÐÐ• Ð´Ð°Ð²Ð°Ð¹ Ð¼ÐµÐ´Ð¸Ñ†Ð¸Ð½ÑÐºÐ¸Ñ… ÑÐ¾Ð²ÐµÑ‚Ð¾Ð², Ð° Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐ¹ Ð·Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒÑÑ Ðº ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐ¼Ñƒ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸ÑÑ‚Ñƒ.`);console.log("Chat API: Sending request to OpenRouter...");let l=await fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${v}`,"Content-Type":"application/json","HTTP-Referer":"http://localhost:3000","X-Title":"Doctor Family Medical Clinic"},body:JSON.stringify({model:"openai/gpt-4o-mini",messages:[{role:"system",content:i},...n],temperature:.7,max_tokens:500})});if(console.log("Chat API: OpenRouter response status:",l.status),!l.ok){let e=await l.text();return console.error("OpenRouter API error:",e),f.NextResponse.json({error:`Failed to get response from AI: ${e.substring(0,100)}`},{status:l.status,headers:{"Cache-Control":"no-store, no-cache, must-revalidate",Pragma:"no-cache",Expires:"0"}})}let c=await l.json();console.log("Chat API: OpenRouter response received");let d=c.choices?.[0]?.message?.content;if(!d)return console.error("Chat API: No message in response",c),f.NextResponse.json({error:"No response from AI"},{status:500,headers:{"Cache-Control":"no-store, no-cache, must-revalidate",Pragma:"no-cache",Expires:"0"}});console.log("Chat API: Parsing cards in message...");let{message:u,cards:p}=await I(d);console.log("Chat API: Found cards:",p.length);let h=u.includes("[NEED_OPERATOR]");console.log("Chat API: Need operator:",h);let g=u;return p.forEach(e=>{g=g.replace(e.placeholder,"")}),g=g.replace("[NEED_OPERATOR]","").trim(),console.log("Chat API: Success!"),f.NextResponse.json({message:g,cards:p,needOperator:h},{headers:{"Cache-Control":"no-store, no-cache, must-revalidate",Pragma:"no-cache",Expires:"0"}})}catch(t){console.error("Chat API error:",t);let e=t instanceof Error?t.message:"Unknown error";return f.NextResponse.json({error:`Internal server error: ${e}`},{status:500,headers:{"Cache-Control":"no-store, no-cache, must-revalidate",Pragma:"no-cache",Expires:"0"}})}}e.s(["POST",()=>y],1351);var x=e.i(1351);let w=new t.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/chat/route",pathname:"/api/chat",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/chat/route.ts",nextConfigOutput:"",userland:x}),{workAsyncStorage:_,workUnitAsyncStorage:S,serverHooks:D}=w;function O(){return(0,r.patchFetch)({workAsyncStorage:_,workUnitAsyncStorage:S})}async function T(e,t,r){w.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let f="/api/chat/route";f=f.replace(/\/index$/,"")||"/";let A=await w.prepare(e,t,{srcPage:f,multiZoneDraftMode:!1});if(!A)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:v,params:I,nextConfig:P,parsedUrl:y,isDraftMode:x,prerenderManifest:_,routerServerContext:S,isOnDemandRevalidate:D,revalidateOnlyGenerated:O,resolvedPathname:T,clientReferenceManifest:$,serverActionsManifest:N}=A,b=(0,l.normalizeAppPath)(f),k=!!(_.dynamicRoutes[b]||_.routes[T]),q=async()=>((null==S?void 0:S.render404)?await S.render404(e,t,y,!1):t.end("This page could not be found"),null);if(k&&!x){let e=!!_.routes[T],t=_.dynamicRoutes[b];if(t&&!1===t.fallback&&!e){if(P.experimental.adapterPath)return await q();throw new R.NoFallbackError}}let U=null;!k||w.isDev||x||(U="/index"===(U=T)?"/":U);let M=!0===w.isDev||!k,F=k&&!M;N&&$&&(0,s.setReferenceManifestsSingleton)({page:f,clientReferenceManifest:$,serverActionsManifest:N,serverModuleMap:(0,i.createServerModuleMap)({serverActionsManifest:N})});let j=e.method||"GET",H=(0,n.getTracer)(),L=H.getActiveScopeSpan(),B={params:I,prerenderManifest:_,renderOpts:{experimental:{authInterrupts:!!P.experimental.authInterrupts},cacheComponents:!!P.cacheComponents,supportsDynamicResponse:M,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:P.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,o,r)=>w.onRequestError(e,t,r,S)},sharedContext:{buildId:v}},K=new c.NodeNextRequest(e),V=new c.NodeNextResponse(t),z=d.NextRequestAdapter.fromNodeNextRequest(K,(0,d.signalFromNodeResponse)(t));try{let s=async e=>w.handle(z,B).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let o=H.getRootSpanAttributes();if(!o)return;if(o.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${o.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let r=o.get("next.route");if(r){let t=`${j} ${r}`;e.setAttributes({"next.route":r,"http.route":r,"next.span_name":t}),e.updateName(t)}else e.updateName(`${j} ${f}`)}),i=!!(0,a.getRequestMeta)(e,"minimalMode"),l=async a=>{var n,l;let c=async({previousCacheEntry:o})=>{try{if(!i&&D&&O&&!o)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await s(a);e.fetchMetrics=B.renderOpts.fetchMetrics;let l=B.renderOpts.pendingWaitUntil;l&&r.waitUntil&&(r.waitUntil(l),l=void 0);let c=B.renderOpts.collectedTags;if(!k)return await (0,h.sendResponse)(K,V,n,B.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,g.toNodeOutgoingHttpHeaders)(n.headers);c&&(t[C.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let o=void 0!==B.renderOpts.collectedRevalidate&&!(B.renderOpts.collectedRevalidate>=C.INFINITE_CACHE)&&B.renderOpts.collectedRevalidate,r=void 0===B.renderOpts.collectedExpire||B.renderOpts.collectedExpire>=C.INFINITE_CACHE?void 0:B.renderOpts.collectedExpire;return{value:{kind:E.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:o,expire:r}}}}catch(t){throw(null==o?void 0:o.isStale)&&await w.onRequestError(e,t,{routerKind:"App Router",routePath:f,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:F,isOnDemandRevalidate:D})},S),t}},d=await w.handleResponse({req:e,nextConfig:P,cacheKey:U,routeKind:o.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:_,isRoutePPREnabled:!1,isOnDemandRevalidate:D,revalidateOnlyGenerated:O,responseGenerator:c,waitUntil:r.waitUntil,isMinimalMode:i});if(!k)return null;if((null==d||null==(n=d.value)?void 0:n.kind)!==E.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(l=d.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});i||t.setHeader("x-nextjs-cache",D?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),x&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let u=(0,g.fromNodeOutgoingHttpHeaders)(d.value.headers);return i&&k||u.delete(C.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||u.get("Cache-Control")||u.set("Cache-Control",(0,m.getCacheControlHeader)(d.cacheControl)),await (0,h.sendResponse)(K,V,new Response(d.value.body,{headers:u,status:d.value.status||200})),null};L?await l(L):await H.withPropagatedContext(e.headers,()=>H.trace(u.BaseServerSpan.handleRequest,{spanName:`${j} ${f}`,kind:n.SpanKind.SERVER,attributes:{"http.method":j,"http.target":e.url}},l))}catch(t){if(t instanceof R.NoFallbackError||await w.onRequestError(e,t,{routerKind:"App Router",routePath:b,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:F,isOnDemandRevalidate:D})}),k)throw t;return await (0,h.sendResponse)(K,V,new Response(null,{status:500})),null}}e.s(["handler",()=>T,"patchFetch",()=>O,"routeModule",()=>w,"serverHooks",()=>D,"workAsyncStorage",()=>_,"workUnitAsyncStorage",()=>S],99280)}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_app-route_1cb6f5ec.js.map